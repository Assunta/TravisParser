travis_fold:start:worker_infoWorker information
hostname: i-09ca047-precise-production-2-worker-org-docker.travisci.net:cef89b70-bb62-443a-b975-b3bf9e660475
version: v2.5.0 https://github.com/travis-ci/worker/tree/da3a43228dffc0fcca5a46569ca786b22991979f
instance: 1a3c43a:travis:ruby
startup: 521.254143ms
travis_fold:end:worker_infotravis_fold:start:system_infoBuild system information
Build language: ruby
Build group: stable
Build dist: precise
Build id: 235867409
Job id: 235867414
travis-build version: 6b85b561c
Build image provisioning date and time
Thu Feb  5 15:09:33 UTC 2015
Operating System Details
Distributor ID:	Ubuntu
Description:	Ubuntu 12.04.5 LTS
Release:	12.04
Codename:	precise
Linux Version
3.13.0-29-generic
Cookbooks Version
a68419e https://github.com/travis-ci/travis-cookbooks/tree/a68419e
GCC version
gcc (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3
Copyright (C) 2011 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

LLVM version
clang version 3.4 (tags/RELEASE_34/final)
Target: x86_64-unknown-linux-gnu
Thread model: posix
Pre-installed Ruby versions
ruby-1.9.3-p551
Pre-installed Node.js versions
v0.10.36
Pre-installed Go versions
1.4.1
Redis version
redis-server 2.8.19
riak version
2.0.2
MongoDB version
MongoDB 2.4.12
CouchDB version
couchdb 1.6.1
Neo4j version
1.9.4
RabbitMQ Version
3.4.3
ElasticSearch version
1.4.0
Installed Sphinx versions
2.0.10
2.1.9
2.2.6
Default Sphinx version
2.2.6
Installed Firefox version
firefox 31.0esr
PhantomJS version
1.9.8
ant -version
Apache Ant(TM) version 1.8.2 compiled on December 3 2011
mvn -version
Apache Maven 3.2.5 (12a6b3acb947671f09b81f49094c53f426d8cea1; 2014-12-14T17:29:23+00:00)
Maven home: /usr/local/maven
Java version: 1.7.0_76, vendor: Oracle Corporation
Java home: /usr/lib/jvm/java-7-oracle/jre
Default locale: en_US, platform encoding: ANSI_X3.4-1968
OS name: "linux", version: "3.13.0-29-generic", arch: "amd64", family: "unix"
travis_fold:end:system_info
travis_fold:start:fix.CVE-2015-7547$ export DEBIAN_FRONTEND=noninteractive
Reading package lists...
Building dependency tree...
Reading state information...
The following extra packages will be installed:
  libc-bin libc-dev-bin libc6-dev
Suggested packages:
  glibc-doc
The following packages will be upgraded:
  libc-bin libc-dev-bin libc6 libc6-dev
4 upgraded, 0 newly installed, 0 to remove and 277 not upgraded.
Need to get 8,856 kB of archives.
After this operation, 13.3 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu/ precise-updates/main libc6-dev amd64 2.15-0ubuntu10.18 [2,948 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu/ precise-updates/main libc-dev-bin amd64 2.15-0ubuntu10.18 [84.5 kB]
Get:3 http://us.archive.ubuntu.com/ubuntu/ precise-updates/main libc-bin amd64 2.15-0ubuntu10.18 [1,178 kB]
Get:4 http://us.archive.ubuntu.com/ubuntu/ precise-updates/main libc6 amd64 2.15-0ubuntu10.18 [4,646 kB]
Fetched 8,856 kB in 0s (30.0 MB/s)
Preconfiguring packages ...
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 71420 files and directories currently installed.)
Preparing to replace libc6-dev 2.15-0ubuntu10.10 (using .../libc6-dev_2.15-0ubuntu10.18_amd64.deb) ...
Unpacking replacement libc6-dev ...
Preparing to replace libc-dev-bin 2.15-0ubuntu10.10 (using .../libc-dev-bin_2.15-0ubuntu10.18_amd64.deb) ...
Unpacking replacement libc-dev-bin ...
Preparing to replace libc-bin 2.15-0ubuntu10.10 (using .../libc-bin_2.15-0ubuntu10.18_amd64.deb) ...
Unpacking replacement libc-bin ...
Processing triggers for man-db ...
Setting up libc-bin (2.15-0ubuntu10.18) ...
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 71419 files and directories currently installed.)
Preparing to replace libc6 2.15-0ubuntu10.10 (using .../libc6_2.15-0ubuntu10.18_amd64.deb) ...
Unpacking replacement libc6 ...
Setting up libc6 (2.15-0ubuntu10.18) ...
Setting up libc-dev-bin (2.15-0ubuntu10.18) ...
Setting up libc6-dev (2.15-0ubuntu10.18) ...
Processing triggers for libc-bin ...
ldconfig deferred processing now taking place
travis_fold:end:fix.CVE-2015-7547travis_fold:start:update_libssl1.0.0$ sudo apt-get install libssl1.0.0
Reading package lists... 0%Reading package lists... 0%Reading package lists... 1%Reading package lists... 10%Reading package lists... 10%Reading package lists... 11%Reading package lists... 11%Reading package lists... 46%Reading package lists... 46%Reading package lists... 47%Reading package lists... 47%Reading package lists... 47%Reading package lists... 58%Reading package lists... 58%Reading package lists... 58%Reading package lists... 58%Reading package lists... 94%Reading package lists... 94%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 95%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 97%Reading package lists... 97%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree       
Reading state information... 0%Reading state information... 0%Reading state information... Done
The following extra packages will be installed:
  libssl-dev
The following packages will be upgraded:
  libssl-dev libssl1.0.0
2 upgraded, 0 newly installed, 0 to remove and 275 not upgraded.
Need to get 2,634 kB of archives.
After this operation, 29.7 kB of additional disk space will be used.
0% [Working]            Get:1 http://us.archive.ubuntu.com/ubuntu/ precise-updates/main libssl-dev amd64 1.0.1-4ubuntu5.39 [1,580 kB]
            1% [1 libssl-dev 14.1 kB/1,580 kB 1%]                                     60% [Waiting for headers]                         Get:2 http://us.archive.ubuntu.com/ubuntu/ precise-updates/main libssl1.0.0 amd64 1.0.1-4ubuntu5.39 [1,054 kB]
                         62% [2 libssl1.0.0 57.7 kB/1,054 kB 5%]                                       100% [Working]              Fetched 2,634 kB in 0s (16.7 MB/s)
Preconfiguring packages ...
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 71419 files and directories currently installed.)
Preparing to replace libssl-dev 1.0.1-4ubuntu5.21 (using .../libssl-dev_1.0.1-4ubuntu5.39_amd64.deb) ...
Unpacking replacement libssl-dev ...
Preparing to replace libssl1.0.0 1.0.1-4ubuntu5.21 (using .../libssl1.0.0_1.0.1-4ubuntu5.39_amd64.deb) ...
Unpacking replacement libssl1.0.0 ...
Setting up libssl1.0.0 (1.0.1-4ubuntu5.39) ...
Setting up libssl-dev (1.0.1-4ubuntu5.39) ...
Processing triggers for libc-bin ...
ldconfig deferred processing now taking place
travis_fold:end:update_libssl1.0.0travis_fold:start:git.checkouttravis_time:start:1d220794$ git clone --depth=50 https://github.com/diaspora/diaspora.git diaspora/diaspora
Cloning into 'diaspora/diaspora'...
remote: Counting objects: 8873, done.[K
remote: Compressing objects:   0% (1/5008)   [Kremote: Compressing objects:   1% (51/5008)   [Kremote: Compressing objects:   2% (101/5008)   [Kremote: Compressing objects:   3% (151/5008)   [Kremote: Compressing objects:   4% (201/5008)   [Kremote: Compressing objects:   5% (251/5008)   [Kremote: Compressing objects:   6% (301/5008)   [Kremote: Compressing objects:   7% (351/5008)   [Kremote: Compressing objects:   8% (401/5008)   [Kremote: Compressing objects:   9% (451/5008)   [Kremote: Compressing objects:  10% (501/5008)   [Kremote: Compressing objects:  11% (551/5008)   [Kremote: Compressing objects:  12% (601/5008)   [Kremote: Compressing objects:  13% (652/5008)   [Kremote: Compressing objects:  14% (702/5008)   [Kremote: Compressing objects:  15% (752/5008)   [Kremote: Compressing objects:  16% (802/5008)   [Kremote: Compressing objects:  17% (852/5008)   [Kremote: Compressing objects:  18% (902/5008)   [Kremote: Compressing objects:  19% (952/5008)   [Kremote: Compressing objects:  20% (1002/5008)   [Kremote: Compressing objects:  21% (1052/5008)   [Kremote: Compressing objects:  22% (1102/5008)   [Kremote: Compressing objects:  23% (1152/5008)   [Kremote: Compressing objects:  24% (1202/5008)   [Kremote: Compressing objects:  25% (1252/5008)   [Kremote: Compressing objects:  26% (1303/5008)   [Kremote: Compressing objects:  27% (1353/5008)   [Kremote: Compressing objects:  28% (1403/5008)   [Kremote: Compressing objects:  29% (1453/5008)   [Kremote: Compressing objects:  30% (1503/5008)   [Kremote: Compressing objects:  31% (1553/5008)   [Kremote: Compressing objects:  32% (1603/5008)   [Kremote: Compressing objects:  33% (1653/5008)   [Kremote: Compressing objects:  34% (1703/5008)   [Kremote: Compressing objects:  35% (1753/5008)   [Kremote: Compressing objects:  36% (1803/5008)   [Kremote: Compressing objects:  37% (1853/5008)   [Kremote: Compressing objects:  38% (1904/5008)   [Kremote: Compressing objects:  39% (1954/5008)   [Kremote: Compressing objects:  40% (2004/5008)   [Kremote: Compressing objects:  41% (2054/5008)   [Kremote: Compressing objects:  42% (2104/5008)   [Kremote: Compressing objects:  43% (2154/5008)   [Kremote: Compressing objects:  44% (2204/5008)   [Kremote: Compressing objects:  45% (2254/5008)   [Kremote: Compressing objects:  46% (2304/5008)   [Kremote: Compressing objects:  47% (2354/5008)   [Kremote: Compressing objects:  48% (2404/5008)   [Kremote: Compressing objects:  49% (2454/5008)   [Kremote: Compressing objects:  50% (2504/5008)   [Kremote: Compressing objects:  51% (2555/5008)   [Kremote: Compressing objects:  52% (2605/5008)   [Kremote: Compressing objects:  53% (2655/5008)   [Kremote: Compressing objects:  54% (2705/5008)   [Kremote: Compressing objects:  55% (2755/5008)   [Kremote: Compressing objects:  56% (2805/5008)   [Kremote: Compressing objects:  57% (2855/5008)   [Kremote: Compressing objects:  58% (2905/5008)   [Kremote: Compressing objects:  59% (2955/5008)   [Kremote: Compressing objects:  60% (3005/5008)   [Kremote: Compressing objects:  61% (3055/5008)   [Kremote: Compressing objects:  62% (3105/5008)   [Kremote: Compressing objects:  63% (3156/5008)   [Kremote: Compressing objects:  64% (3206/5008)   [Kremote: Compressing objects:  65% (3256/5008)   [Kremote: Compressing objects:  66% (3306/5008)   [Kremote: Compressing objects:  67% (3356/5008)   [Kremote: Compressing objects:  68% (3406/5008)   [Kremote: Compressing objects:  69% (3456/5008)   [Kremote: Compressing objects:  70% (3506/5008)   [Kremote: Compressing objects:  71% (3556/5008)   [Kremote: Compressing objects:  72% (3606/5008)   [Kremote: Compressing objects:  73% (3656/5008)   [Kremote: Compressing objects:  74% (3706/5008)   [Kremote: Compressing objects:  75% (3756/5008)   [Kremote: Compressing objects:  76% (3807/5008)   [Kremote: Compressing objects:  77% (3857/5008)   [Kremote: Compressing objects:  78% (3907/5008)   [Kremote: Compressing objects:  79% (3957/5008)   [Kremote: Compressing objects:  80% (4007/5008)   [Kremote: Compressing objects:  81% (4057/5008)   [Kremote: Compressing objects:  82% (4107/5008)   [Kremote: Compressing objects:  83% (4157/5008)   [Kremote: Compressing objects:  84% (4207/5008)   [Kremote: Compressing objects:  85% (4257/5008)   [Kremote: Compressing objects:  86% (4307/5008)   [Kremote: Compressing objects:  87% (4357/5008)   [Kremote: Compressing objects:  88% (4408/5008)   [Kremote: Compressing objects:  89% (4458/5008)   [Kremote: Compressing objects:  90% (4508/5008)   [Kremote: Compressing objects:  91% (4558/5008)   [Kremote: Compressing objects:  92% (4608/5008)   [Kremote: Compressing objects:  93% (4658/5008)   [Kremote: Compressing objects:  94% (4708/5008)   [Kremote: Compressing objects:  95% (4758/5008)   [Kremote: Compressing objects:  96% (4808/5008)   [Kremote: Compressing objects:  97% (4858/5008)   [Kremote: Compressing objects:  98% (4908/5008)   [Kremote: Compressing objects:  99% (4958/5008)   [Kremote: Compressing objects: 100% (5008/5008)   [Kremote: Compressing objects: 100% (5008/5008), done.[K
Receiving objects:   0% (1/8873)   Receiving objects:   1% (89/8873)   Receiving objects:   2% (178/8873)   Receiving objects:   3% (267/8873)   Receiving objects:   4% (355/8873)   Receiving objects:   5% (444/8873)   Receiving objects:   6% (533/8873)   Receiving objects:   7% (622/8873)   Receiving objects:   8% (710/8873)   Receiving objects:   9% (799/8873)   Receiving objects:  10% (888/8873)   Receiving objects:  11% (977/8873)   Receiving objects:  12% (1065/8873)   Receiving objects:  13% (1154/8873)   Receiving objects:  14% (1243/8873)   Receiving objects:  15% (1331/8873)   Receiving objects:  16% (1420/8873)   Receiving objects:  17% (1509/8873)   Receiving objects:  18% (1598/8873)   Receiving objects:  19% (1686/8873)   Receiving objects:  20% (1775/8873)   Receiving objects:  21% (1864/8873)   Receiving objects:  22% (1953/8873)   Receiving objects:  23% (2041/8873)   Receiving objects:  24% (2130/8873)   Receiving objects:  25% (2219/8873)   Receiving objects:  26% (2307/8873)   Receiving objects:  27% (2396/8873)   Receiving objects:  28% (2485/8873)   Receiving objects:  29% (2574/8873)   Receiving objects:  30% (2662/8873)   Receiving objects:  31% (2751/8873)   Receiving objects:  32% (2840/8873)   Receiving objects:  33% (2929/8873)   Receiving objects:  34% (3017/8873)   Receiving objects:  35% (3106/8873)   Receiving objects:  36% (3195/8873)   Receiving objects:  37% (3284/8873)   Receiving objects:  38% (3372/8873)   Receiving objects:  39% (3461/8873)   Receiving objects:  40% (3550/8873)   Receiving objects:  41% (3638/8873)   Receiving objects:  42% (3727/8873)   Receiving objects:  43% (3816/8873)   Receiving objects:  44% (3905/8873)   Receiving objects:  45% (3993/8873)   Receiving objects:  46% (4082/8873)   Receiving objects:  47% (4171/8873)   Receiving objects:  48% (4260/8873)   Receiving objects:  49% (4348/8873)   Receiving objects:  50% (4437/8873)   Receiving objects:  51% (4526/8873)   Receiving objects:  52% (4614/8873)   Receiving objects:  53% (4703/8873)   Receiving objects:  54% (4792/8873)   Receiving objects:  55% (4881/8873)   Receiving objects:  56% (4969/8873)   Receiving objects:  57% (5058/8873)   Receiving objects:  58% (5147/8873)   Receiving objects:  59% (5236/8873)   Receiving objects:  60% (5324/8873)   Receiving objects:  61% (5413/8873)   Receiving objects:  62% (5502/8873)   Receiving objects:  63% (5590/8873)   Receiving objects:  64% (5679/8873)   Receiving objects:  65% (5768/8873)   Receiving objects:  66% (5857/8873)   Receiving objects:  67% (5945/8873)   Receiving objects:  68% (6034/8873)   Receiving objects:  69% (6123/8873)   Receiving objects:  70% (6212/8873)   Receiving objects:  71% (6300/8873)   Receiving objects:  72% (6389/8873)   Receiving objects:  73% (6478/8873)   Receiving objects:  74% (6567/8873)   Receiving objects:  75% (6655/8873)   Receiving objects:  76% (6744/8873)   Receiving objects:  77% (6833/8873)   Receiving objects:  78% (6921/8873)   Receiving objects:  79% (7010/8873)   Receiving objects:  80% (7099/8873)   Receiving objects:  81% (7188/8873)   Receiving objects:  82% (7276/8873)   Receiving objects:  83% (7365/8873)   Receiving objects:  84% (7454/8873)   Receiving objects:  85% (7543/8873)   Receiving objects:  86% (7631/8873)   Receiving objects:  87% (7720/8873)   Receiving objects:  88% (7809/8873)   Receiving objects:  89% (7897/8873)   Receiving objects:  90% (7986/8873)   Receiving objects:  91% (8075/8873)   Receiving objects:  92% (8164/8873)   Receiving objects:  93% (8252/8873)   Receiving objects:  94% (8341/8873)   Receiving objects:  95% (8430/8873)   Receiving objects:  96% (8519/8873)   Receiving objects:  97% (8607/8873)   Receiving objects:  98% (8696/8873)   Receiving objects:  99% (8785/8873)   remote: Total 8873 (delta 5307), reused 6084 (delta 3745), pack-reused 0[K
Receiving objects: 100% (8873/8873)   Receiving objects: 100% (8873/8873), 5.37 MiB | 0 bytes/s, done.
Resolving deltas:   0% (0/5307)   Resolving deltas:   1% (96/5307)   Resolving deltas:   2% (109/5307)   Resolving deltas:   3% (163/5307)   Resolving deltas:   4% (219/5307)   Resolving deltas:   5% (266/5307)   Resolving deltas:   6% (319/5307)   Resolving deltas:   7% (380/5307)   Resolving deltas:   8% (425/5307)   Resolving deltas:   9% (482/5307)   Resolving deltas:  10% (533/5307)   Resolving deltas:  11% (595/5307)   Resolving deltas:  12% (646/5307)   Resolving deltas:  13% (690/5307)   Resolving deltas:  14% (749/5307)   Resolving deltas:  15% (797/5307)   Resolving deltas:  16% (869/5307)   Resolving deltas:  17% (929/5307)   Resolving deltas:  18% (962/5307)   Resolving deltas:  19% (1010/5307)   Resolving deltas:  21% (1139/5307)   Resolving deltas:  22% (1191/5307)   Resolving deltas:  23% (1231/5307)   Resolving deltas:  25% (1337/5307)   Resolving deltas:  26% (1386/5307)   Resolving deltas:  27% (1435/5307)   Resolving deltas:  28% (1486/5307)   Resolving deltas:  29% (1575/5307)   Resolving deltas:  30% (1593/5307)   Resolving deltas:  31% (1646/5307)   Resolving deltas:  32% (1705/5307)   Resolving deltas:  33% (1770/5307)   Resolving deltas:  34% (1824/5307)   Resolving deltas:  35% (1860/5307)   Resolving deltas:  36% (1912/5307)   Resolving deltas:  37% (1968/5307)   Resolving deltas:  38% (2017/5307)   Resolving deltas:  39% (2073/5307)   Resolving deltas:  40% (2125/5307)   Resolving deltas:  41% (2178/5307)   Resolving deltas:  42% (2233/5307)   Resolving deltas:  43% (2283/5307)   Resolving deltas:  44% (2337/5307)   Resolving deltas:  45% (2390/5307)   Resolving deltas:  46% (2443/5307)   Resolving deltas:  47% (2496/5307)   Resolving deltas:  48% (2551/5307)   Resolving deltas:  49% (2603/5307)   Resolving deltas:  50% (2654/5307)   Resolving deltas:  51% (2710/5307)   Resolving deltas:  52% (2760/5307)   Resolving deltas:  53% (2813/5307)   Resolving deltas:  54% (2866/5307)   Resolving deltas:  55% (2920/5307)   Resolving deltas:  56% (2973/5307)   Resolving deltas:  57% (3026/5307)   Resolving deltas:  58% (3080/5307)   Resolving deltas:  59% (3137/5307)   Resolving deltas:  60% (3186/5307)   Resolving deltas:  61% (3243/5307)   Resolving deltas:  62% (3292/5307)   Resolving deltas:  63% (3345/5307)   Resolving deltas:  64% (3404/5307)   Resolving deltas:  65% (3456/5307)   Resolving deltas:  66% (3508/5307)   Resolving deltas:  67% (3557/5307)   Resolving deltas:  68% (3609/5307)   Resolving deltas:  69% (3662/5307)   Resolving deltas:  70% (3724/5307)   Resolving deltas:  71% (3768/5307)   Resolving deltas:  72% (3832/5307)   Resolving deltas:  73% (3877/5307)   Resolving deltas:  74% (3928/5307)   Resolving deltas:  75% (3985/5307)   Resolving deltas:  76% (4036/5307)   Resolving deltas:  77% (4093/5307)   Resolving deltas:  78% (4152/5307)   Resolving deltas:  79% (4196/5307)   Resolving deltas:  80% (4246/5307)   Resolving deltas:  81% (4299/5307)   Resolving deltas:  82% (4352/5307)   Resolving deltas:  83% (4407/5307)   Resolving deltas:  84% (4460/5307)   Resolving deltas:  85% (4511/5307)   Resolving deltas:  86% (4565/5307)   Resolving deltas:  87% (4618/5307)   Resolving deltas:  88% (4674/5307)   Resolving deltas:  89% (4726/5307)   Resolving deltas:  90% (4777/5307)   Resolving deltas:  91% (4830/5307)   Resolving deltas:  92% (4883/5307)   Resolving deltas:  93% (4936/5307)   Resolving deltas:  94% (5012/5307)   Resolving deltas:  95% (5044/5307)   Resolving deltas:  96% (5096/5307)   Resolving deltas:  97% (5153/5307)   Resolving deltas:  98% (5201/5307)   Resolving deltas:  99% (5262/5307)   Resolving deltas: 100% (5307/5307)   Resolving deltas: 100% (5307/5307), done.
Checking connectivity... done.

travis_time:end:1d220794:start=1495674408668328238,finish=1495674410695746247,duration=2027418009$ cd diaspora/diaspora
travis_time:start:037aa93c$ git fetch origin +refs/pull/7466/merge:
remote: Counting objects: 3, done.[K
remote: Compressing objects:  50% (1/2)   [Kremote: Compressing objects: 100% (2/2)   [Kremote: Compressing objects: 100% (2/2), done.[K
remote: Total 3 (delta 1), reused 2 (delta 1), pack-reused 0[K
Unpacking objects:  33% (1/3)   Unpacking objects:  66% (2/3)   Unpacking objects: 100% (3/3)   Unpacking objects: 100% (3/3), done.
From https://github.com/diaspora/diaspora
 * branch            refs/pull/7466/merge -> FETCH_HEAD

travis_time:end:037aa93c:start=1495674410701542532,finish=1495674411098000221,duration=396457689$ git checkout -qf FETCH_HEAD
travis_fold:end:git.checkout
Setting environment variables from .travis.yml
$ export DB=postgresql
$ export BUILD_TYPE=cucumber

travis_fold:start:rvmtravis_time:start:0c8dbad8$ rvm use 2.1 --install --binary --fuzzy
Using /home/travis/.rvm/gems/ruby-2.1.5

travis_time:end:0c8dbad8:start=1495674416651732324,finish=1495674417002449056,duration=350716732travis_fold:end:rvm$ export BUNDLE_GEMFILE=$PWD/Gemfile
travis_fold:start:cache.1Setting up build cache
$ export CASHER_DIR=$HOME/.casher
travis_time:start:1b06c864$ Installing caching utilities

travis_time:end:1b06c864:start=1495674417239484165,finish=1495674417316935277,duration=77451112travis_time:start:123dba91
travis_time:end:123dba91:start=1495674417322871943,finish=1495674417327447397,duration=4575454travis_time:start:156e8137attempting to download cache archive
fetching PR.7466/cache-linux-precise-1c9d816423d91b4c3f2f5f6a243203d81593c02ddad271af70c62abc2b8a3ef2--rvm-2.1--gemfile-Gemfile.tgz
fetching PR.7466/cache--rvm-2.1--gemfile-Gemfile.tgz
fetching develop/cache-linux-precise-1c9d816423d91b4c3f2f5f6a243203d81593c02ddad271af70c62abc2b8a3ef2--rvm-2.1--gemfile-Gemfile.tgz
found cache

travis_time:end:156e8137:start=1495674417332496129,finish=1495674420497074883,duration=3164578754travis_time:start:1847733c
travis_time:end:1847733c:start=1495674420502596645,finish=1495674420507212387,duration=4615742travis_time:start:16c6c9adadding /home/travis/build/diaspora/diaspora/app/assets/images to cache

travis_time:end:16c6c9ad:start=1495674420513211501,finish=1495674424065253470,duration=3552041969travis_fold:end:cache.1
travis_fold:start:cache.bundlertravis_time:start:0dcc6b9c
travis_time:end:0dcc6b9c:start=1495674424071397849,finish=1495674424075935780,duration=4537931travis_time:start:041f026aadding /home/travis/build/diaspora/diaspora/vendor/bundle to cache
creating directory /home/travis/build/diaspora/diaspora/vendor/bundle

travis_time:end:041f026a:start=1495674424083593600,finish=1495674429047716168,duration=4964122568travis_fold:end:cache.bundler$ ruby --version
ruby 2.1.5p273 (2014-11-13 revision 48405) [x86_64-linux]
$ rvm --version
rvm 1.26.10 (latest-minor) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]
$ bundle --version
Bundler version 1.7.6
$ gem --version
2.4.5
travis_fold:start:before_install.1travis_time:start:0638d550$ gem install bundler
Fetching: bundler-1.15.0.gemFetching: bundler-1.15.0.gem (  1%)Fetching: bundler-1.15.0.gem (  2%)Fetching: bundler-1.15.0.gem (  3%)Fetching: bundler-1.15.0.gem (  4%)Fetching: bundler-1.15.0.gem (  5%)Fetching: bundler-1.15.0.gem (  6%)Fetching: bundler-1.15.0.gem (  7%)Fetching: bundler-1.15.0.gem (  8%)Fetching: bundler-1.15.0.gem (  9%)Fetching: bundler-1.15.0.gem ( 10%)Fetching: bundler-1.15.0.gem ( 15%)Fetching: bundler-1.15.0.gem ( 20%)Fetching: bundler-1.15.0.gem ( 24%)Fetching: bundler-1.15.0.gem ( 29%)Fetching: bundler-1.15.0.gem ( 34%)Fetching: bundler-1.15.0.gem ( 39%)Fetching: bundler-1.15.0.gem ( 44%)Fetching: bundler-1.15.0.gem ( 49%)Fetching: bundler-1.15.0.gem ( 53%)Fetching: bundler-1.15.0.gem ( 58%)Fetching: bundler-1.15.0.gem ( 63%)Fetching: bundler-1.15.0.gem ( 68%)Fetching: bundler-1.15.0.gem ( 73%)Fetching: bundler-1.15.0.gem ( 78%)Fetching: bundler-1.15.0.gem ( 83%)Fetching: bundler-1.15.0.gem ( 87%)Fetching: bundler-1.15.0.gem ( 92%)Fetching: bundler-1.15.0.gem ( 97%)Fetching: bundler-1.15.0.gem (100%)Fetching: bundler-1.15.0.gem (100%)
Successfully installed bundler-1.15.0
1 gem installed

travis_time:end:0638d550:start=1495674429600515965,finish=1495674430170478601,duration=569962636travis_fold:end:before_install.1travis_fold:start:before_install.2travis_time:start:1454bcbc$ mkdir travis-phantomjs

travis_time:end:1454bcbc:start=1495674430175935893,finish=1495674430182410164,duration=6474271travis_fold:end:before_install.2travis_fold:start:before_install.3travis_time:start:05130180$ wget http://cifiles.diasporafoundation.org/phantomjs-2.1.1-linux-x86_64.tar.bz2 -O $PWD/travis-phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2
--2017-05-25 01:07:10--  http://cifiles.diasporafoundation.org/phantomjs-2.1.1-linux-x86_64.tar.bz2
Resolving cifiles.diasporafoundation.org (cifiles.diasporafoundation.org)... 5.9.7.84, 2a01:4f8:160:72d0::2
Connecting to cifiles.diasporafoundation.org (cifiles.diasporafoundation.org)|5.9.7.84|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 23415665 (22M) [application/octet-stream]
Saving to: `/home/travis/build/diaspora/diaspora/travis-phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2'

 0% [                                       ] 0           --.-K/s               0% [                                       ] 107,152      375K/s               3% [>                                      ] 918,984     1.57M/s              22% [=======>                               ] 5,298,192   6.66M/s              52% [===================>                   ] 12,353,056  12.3M/s              77% [=============================>         ] 18,218,904  14.3M/s              100%[======================================>] 23,415,665  16.8M/s   in 1.3s    

2017-05-25 01:07:12 (16.8 MB/s) - `/home/travis/build/diaspora/diaspora/travis-phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2' saved [23415665/23415665]


travis_time:end:05130180:start=1495674430188030382,finish=1495674432083994822,duration=1895964440travis_fold:end:before_install.3travis_fold:start:before_install.4travis_time:start:09c47e45$ tar -xvf $PWD/travis-phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2 -C $PWD/travis-phantomjs
phantomjs-2.1.1-linux-x86_64/
phantomjs-2.1.1-linux-x86_64/examples/
phantomjs-2.1.1-linux-x86_64/examples/colorwheel.js
phantomjs-2.1.1-linux-x86_64/examples/scandir.js
phantomjs-2.1.1-linux-x86_64/examples/page_events.js
phantomjs-2.1.1-linux-x86_64/examples/loadspeed.js
phantomjs-2.1.1-linux-x86_64/examples/injectme.js
phantomjs-2.1.1-linux-x86_64/examples/render_multi_url.js
phantomjs-2.1.1-linux-x86_64/examples/server.js
phantomjs-2.1.1-linux-x86_64/examples/netlog.js
phantomjs-2.1.1-linux-x86_64/examples/pagecallback.js
phantomjs-2.1.1-linux-x86_64/examples/module.js
phantomjs-2.1.1-linux-x86_64/examples/arguments.js
phantomjs-2.1.1-linux-x86_64/examples/universe.js
phantomjs-2.1.1-linux-x86_64/examples/openurlwithproxy.js
phantomjs-2.1.1-linux-x86_64/examples/sleepsort.js
phantomjs-2.1.1-linux-x86_64/examples/modernizr.js
phantomjs-2.1.1-linux-x86_64/examples/unrandomize.js
phantomjs-2.1.1-linux-x86_64/examples/hello.js
phantomjs-2.1.1-linux-x86_64/examples/stdin-stdout-stderr.js
phantomjs-2.1.1-linux-x86_64/examples/fibo.js
phantomjs-2.1.1-linux-x86_64/examples/phantomwebintro.js
phantomjs-2.1.1-linux-x86_64/examples/echoToFile.js
phantomjs-2.1.1-linux-x86_64/examples/post.js
phantomjs-2.1.1-linux-x86_64/examples/loadurlwithoutcss.js
phantomjs-2.1.1-linux-x86_64/examples/child_process-examples.js
phantomjs-2.1.1-linux-x86_64/examples/printenv.js
phantomjs-2.1.1-linux-x86_64/examples/useragent.js
phantomjs-2.1.1-linux-x86_64/examples/rasterize.js
phantomjs-2.1.1-linux-x86_64/examples/outputEncoding.js
phantomjs-2.1.1-linux-x86_64/examples/waitfor.js
phantomjs-2.1.1-linux-x86_64/examples/serverkeepalive.js
phantomjs-2.1.1-linux-x86_64/examples/postserver.js
phantomjs-2.1.1-linux-x86_64/examples/printmargins.js
phantomjs-2.1.1-linux-x86_64/examples/version.js
phantomjs-2.1.1-linux-x86_64/examples/run-qunit.js
phantomjs-2.1.1-linux-x86_64/examples/features.js
phantomjs-2.1.1-linux-x86_64/examples/netsniff.js
phantomjs-2.1.1-linux-x86_64/examples/walk_through_frames.js
phantomjs-2.1.1-linux-x86_64/examples/printheaderfooter.js
phantomjs-2.1.1-linux-x86_64/examples/responsive-screenshot.js
phantomjs-2.1.1-linux-x86_64/examples/countdown.js
phantomjs-2.1.1-linux-x86_64/examples/detectsniff.js
phantomjs-2.1.1-linux-x86_64/examples/simpleserver.js
phantomjs-2.1.1-linux-x86_64/examples/postjson.js
phantomjs-2.1.1-linux-x86_64/examples/run-jasmine2.js
phantomjs-2.1.1-linux-x86_64/examples/run-jasmine.js
phantomjs-2.1.1-linux-x86_64/README.md
phantomjs-2.1.1-linux-x86_64/LICENSE.BSD
phantomjs-2.1.1-linux-x86_64/bin/
phantomjs-2.1.1-linux-x86_64/bin/phantomjs
phantomjs-2.1.1-linux-x86_64/third-party.txt
phantomjs-2.1.1-linux-x86_64/ChangeLog

travis_time:end:09c47e45:start=1495674432089845915,finish=1495674435365643537,duration=3275797622travis_fold:end:before_install.4travis_fold:start:before_install.5travis_time:start:202ffa34$ export PATH=$PWD/travis-phantomjs/phantomjs-2.1.1-linux-x86_64/bin:$PATH

travis_time:end:202ffa34:start=1495674435371203260,finish=1495674435375520535,duration=4317275travis_fold:end:before_install.5travis_fold:start:install.bundlertravis_time:start:000294d8$ bundle install --deployment --without development production --with mysql postgresql --jobs 3 --retry 3
Fetching gem metadata from https://rails-assets.org/....
Fetching gem metadata from https://rubygems.org/.......
Fetching version metadata from https://rails-assets.org/..
Fetching version metadata from https://rubygems.org/..
Fetching dependency metadata from https://rails-assets.org/..
Fetching dependency metadata from https://rubygems.org/.
Fetching gem metadata from https://rails-assets.org/....
Fetching version metadata from https://rails-assets.org/..
Fetching dependency metadata from https://rails-assets.org/..
Using rake 12.0.0
Using i18n 0.8.1
Using minitest 5.10.1
Using thread_safe 0.3.6
Using builder 3.2.3
Using erubis 2.7.0
Using mini_portile2 2.1.0
Using rack 1.6.5
Using mime-types-data 3.2016.0521
Using arel 6.0.4
Using thor 0.19.1
Using hike 1.2.3
Using multi_json 1.12.1
Using tilt 1.4.1
Using bundler 1.15.0
Using raindrops 0.17.0
Using get_process_mem 0.2.1
Using multipart-post 2.0.0
Using kgio 2.11.0
Using ffi 1.9.18
Using valid 1.2.0
Using public_suffix 2.0.5
Using json 1.8.6
Using bcrypt 3.1.11
Using concurrent-ruby 1.0.5
Using connection_pool 2.2.1
Using redis 3.3.3
Using execjs 2.7.0
Using configurate 0.3.1
Using orm_adapter 0.5.0
Using rack-cors 0.4.1
Using sass 3.4.23
Using bootstrap-switch-rails 3.3.3
Using chunky_png 1.3.8
Using rb-fsevent 0.9.8
Using mysql2 0.4.5
Using pg 0.19.0
Using excon 0.55.0
Using formatador 0.2.5
Using ipaddress 0.8.3
Using mimemagic 0.3.2
Using mini_magick 4.6.1
Using systemu 2.6.5
Using rails-assets-jquery 3.1.1
Using rails-assets-highlightjs 9.9.0
Using rails-assets-markdown-it 8.3.0
Using rails-assets-markdown-it-hashtag 0.4.0
Using rails-assets-markdown-it-diaspora-mention 1.2.0
Using rails-assets-markdown-it-sanitizer 0.4.3
Using rails-assets-markdown-it--markdown-it-for-inline 0.1.1
Using rails-assets-markdown-it-sub 1.0.0
Using rails-assets-markdown-it-sup 1.0.0
Using rails-assets-underscore 1.8.3
Using rails-assets-fine-uploader 5.13.0
Using rails-assets-autosize 3.0.20
Using rails-assets-blueimp-gallery 2.25.0
Using rails-assets-perfect-scrollbar 0.6.16
Using http_accept_language 2.1.0
Using markerb 1.1.0
Using leaflet-rails 0.7.7
Using redcarpet 3.4.0
Using unf_ext 0.0.7.2
Using ruby-oembed 0.10.1
Using yard 0.9.8
Using hashie 3.5.5
Using jwt 1.5.6
Using multi_xml 0.6.0
Using oauth 0.5.1
Using buftok 0.2.0
Using equalizer 0.0.11
Using useragent 0.16.8
Using http-form_data 1.0.1
Using http_parser.rb 0.6.0
Using naught 1.1.0
Using simple_oauth 0.3.1
Using attr_required 1.0.1
Using bindata 2.3.5
Using securecompare 1.0.0
Using url_safe_base64 0.2.2
Using httpclient 2.8.3
Using diaspora-prosody-config 0.0.7
Using rails-assets-emojione 2.0.1
Using rails-assets-favico.js 0.3.10
Using rails-assets-jquery-fullscreen-plugin 0.5.0
Using rails-assets-jquery.slimscroll 1.3.8
Using request_store 1.3.2
Using temple 0.8.0
Using will_paginate 3.1.5
Using little-plugger 1.1.4
Using rubyzip 1.2.1
Using rspec-support 3.5.0
Using ruby-progressbar 1.8.1
Using database_cleaner 1.5.3
Using cliver 0.3.2
Using websocket-extensions 0.1.2
Using gherkin 4.0.0
Using cucumber-wire 0.0.1
Using diff-lcs 1.3
Using multi_test 0.1.2
Using timecop 0.8.1
Using safe_yaml 1.0.4
Using hashdiff 0.3.2
Using docile 1.1.5
Using simplecov-html 0.10.0
Using tins 1.13.2
Using jasmine-core 2.5.2
Using phantomjs 2.1.1.0
Using jasmine-jquery-rails 2.0.3
Using rails-assets-jasmine 2.5.2
Using i18n-inflector 2.6.7
Using tzinfo 1.2.3
Using memoizable 0.4.2
Using nokogiri 1.7.2
Using rack-test 0.6.3
Using rack-protection 1.5.3
Using rack-mobile-detect 0.4.0
Using warden 1.2.7
Using mime-types 3.1
Using jsonpath 0.5.8
Using sprockets 2.12.4
Using faraday 0.11.0
Using unicorn 5.2.0
Using ethon 0.10.1
Using rb-inotify 0.9.8
Using addressable 2.5.0
Using uglifier 3.1.2
Using autoprefixer-rails 6.7.6
Using compass-core 1.0.3
Using compass-import-once 1.0.5
Using redis-namespace 1.5.3
Using fog-core 1.43.0
Using macaddr 1.7.1
Using rails-assets-bootstrap 3.3.7
Using rails-assets-corejs-typeahead 1.1.1
Using rails-assets-jquery-placeholder 2.3.1
Using rails-assets-jquery-textchange 0.2.3
Using rails-assets-jquery-colorbox 1.6.4
Using rails-assets-jquery.ui 1.11.4
Using rails-assets-backbone 1.3.3
Using unf 0.1.4
Using string-direction 1.2.0
Using omniauth 1.4.2
Using secure_headers 3.6.1
Using hamlit 2.8.0
Using logging 2.1.0
Using rspec-core 3.5.4
Using websocket-driver 0.6.5
Using cucumber-core 1.5.0
Using rspec-expectations 3.5.0
Using rspec-mocks 3.5.0
Using crack 0.4.3
Using simplecov 0.12.0
Using term-ansicolor 1.4.0
Using jasmine 2.5.2
Using rails-assets-jasmine-ajax 3.3.1
Using activesupport 4.2.8
Using rufus-scheduler 3.3.4
Using loofah 2.0.3
Using xpath 2.0.0
Using sidekiq 4.2.9
Using mail 2.6.4
Using handlebars_assets 0.23.1
Using faraday_middleware 0.11.0.1
Using open_graph_reader 0.6.2
Using oauth2 1.3.1
Using unicorn-worker-killer 0.4.4
Using typhoeus 1.1.2
Using json-schema 2.8.0
Using bootstrap-sass 3.3.7
Using compass 1.0.3
Using fog-json 1.0.2
Using fog-xml 0.1.2
Using uuid 2.3.8
Using rails-assets-bootstrap-markdown 2.10.0
Using rails-assets-diaspora_jsxc 0.1.5.develop.7
Using twitter-text 1.14.5
Using domain_name 0.5.20170223
Using omniauth-oauth 1.1.0
Using logging-rails 0.5.0
Using fuubar 2.2.0
Using cucumber 2.4.0
Using rspec 3.5.0
Using webmock 2.3.2
Using coveralls 0.8.19
Using rails-deprecated_sanitizer 1.0.3
Using globalid 0.3.7
Using activemodel 4.2.8
Using json-jwt 1.7.1
Using rack-oauth2 1.5.1
Using swd 1.0.1
Using webfinger 1.0.2
Using factory_girl 4.8.0
Using shoulda-matchers 3.1.1
Using rails-html-sanitizer 1.0.3
Using capybara 2.12.1
Using sidekiq-cron 0.4.5
Using omniauth-oauth2 1.4.0
Using diaspora_federation 0.1.9
Using fog-aws 1.2.1
Using http-cookie 1.0.3
Using omniauth-tumblr 1.2
Using omniauth-twitter 1.4.0
Using cucumber-api-steps 0.13
Using rails-dom-testing 1.0.8
Using activejob 4.2.8
Using activerecord 4.2.8
Using acts_as_api 1.0.0
Using carrierwave 0.11.2
Using validate_email 0.1.6
Using validate_url 1.0.2
Using active_model_serializers 0.9.5
Using poltergeist 1.13.0
Using omniauth-facebook 4.0.0
Using omniauth-wordpress 0.2.2
Using diaspora_federation-test 0.1.9
Using http 2.2.1
Using faraday-cookie_jar 0.0.6
Using actionview 4.2.8
Using activerecord-import 0.17.1
Using acts-as-taggable-on 3.5.0
Using fixture_builder 0.4.1
Using test_after_commit 1.1.0
Using openid_connect 0.12.0
Using twitter 6.1.0
Using actionpack 4.2.8
Using actionmailer 4.2.8
Using railties 4.2.8
Using sprockets-rails 2.3.3
Using gon 6.1.0
Using rails-timeago 2.16.0
Using responders 2.3.0
Using entypo-rails 3.0.0
Using jquery-rails 4.2.2
Using jquery-ui-rails 5.0.5
Using i18n-inflector-rails 1.0.7
Using rails-i18n 4.0.8
Using versionist 1.5.0
Using factory_girl_rails 4.8.0
Using rspec-rails 3.5.2
Using cucumber-rails 1.4.5
Using sinon-rails 1.15.0
Using quiet_assets 1.1.0
Using rails 4.2.8
Using sass-rails 5.0.6
Using js-routes 1.3.3
Using devise 4.2.0
Using diaspora_federation-rails 0.1.9
Using simple_captcha2 0.4.3
Using js_image_paths 0.1.0
Using mobile-fu 1.3.1
Using compass-rails 2.0.5
Using devise_lastseenable 0.0.6
Bundle complete! 136 Gemfile dependencies, 252 gems now installed.
Gems in the groups development and production were not installed.
Bundled gems are installed into ./vendor/bundle.

travis_time:end:000294d8:start=1495674435380987237,finish=1495674453699427288,duration=18318440051travis_fold:end:install.bundlertravis_time:start:02b8b496$ ./script/ci/build.sh
Setting up database.yml for postgresql
WARNING: Configuration file /home/travis/build/diaspora/diaspora/config/diaspora.yml not found, ensure it's present
WARNING: Configuration file /home/travis/build/diaspora/diaspora/config/diaspora.yml not found, ensure it's present
** Invoke ci:travis:cucumber (first_time)
** Invoke ci:travis:prepare (first_time)
** Invoke ci:travis:prepare_db (first_time)
** Invoke db:create (first_time)
** Invoke db:load_config (first_time)
** Execute db:load_config
** Execute db:create
** Invoke db:test:load (first_time)
** Invoke db:test:purge (first_time)
** Invoke environment (first_time)
** Execute environment
WARNING: Configuration file /home/travis/build/diaspora/diaspora/config/diaspora.yml not found, ensure it's present
WARNING: Configuration file /home/travis/build/diaspora/diaspora/config/diaspora.yml not found, ensure it's present
** Invoke db:load_config 
** Execute db:test:purge
** Execute db:test:load
** Invoke db:test:load_schema (first_time)
** Invoke db:test:purge 
** Execute db:test:load_schema
** Execute ci:travis:prepare_db
** Invoke assets:generate_error_pages (first_time)
** Invoke assets:environment (first_time)
** Execute assets:environment
** Invoke environment 
** Execute assets:generate_error_pages
** Execute ci:travis:prepare
** Invoke cucumber (first_time)
** Invoke cucumber:ok (first_time)
** Invoke db:test:prepare (first_time)
** Invoke environment 
** Invoke db:load_config 
** Execute db:test:prepare
** Invoke db:test:load 
** Execute cucumber:ok
/home/travis/.rvm/rubies/ruby-2.1.5/bin/ruby -S bundle exec cucumber --profile default
[Coveralls] Set up the SimpleCov formatter.
[Coveralls] Using SimpleCov's 'rails' settings.
WARNING: Configuration file /home/travis/build/diaspora/diaspora/config/diaspora.yml not found, ensure it's present
WARNING: Configuration file /home/travis/build/diaspora/diaspora/config/diaspora.yml not found, ensure it's present
Using the default profile...
@javascript
Feature: The activity stream

  Background:                                                                 # features/desktop/activity_stream.feature:3
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    When "alice@alice.alice" has posted a status message with a photo         # features/step_definitions/user_steps.rb:169

  Scenario: delete a comment                                                   # features/desktop/activity_stream.feature:11
    When "bob@bob.bob" has commented "is that a poodle?" on "Look at this dog" # features/step_definitions/comment_steps.rb:18
    And I sign in as "bob@bob.bob"                                             # features/step_definitions/session_steps.rb:18
    And I go to the activity stream page                                       # features/step_definitions/web_steps.rb:26
    Then I should see "Look at this dog"                                       # features/step_definitions/web_steps.rb:98
    And I should see "is that a poodle?"                                       # features/step_definitions/web_steps.rb:98
    When I go to the commented stream page                                     # features/step_definitions/web_steps.rb:26
    Then I should see "Look at this dog"                                       # features/step_definitions/web_steps.rb:98
    And I should see "is that a poodle?"                                       # features/step_definitions/web_steps.rb:98
    When I go to the liked stream page                                         # features/step_definitions/web_steps.rb:26
    Then I should not see "Look at this dog"                                   # features/step_definitions/web_steps.rb:113
    When I am on "alice@alice.alice"'s page                                    # features/step_definitions/web_steps.rb:22
    And I confirm the alert after I click to delete the first comment          # features/step_definitions/custom_web_steps.rb:139
    And I go to the activity stream page                                       # features/step_definitions/web_steps.rb:26
    Then I should not see "Look at this dog"                                   # features/step_definitions/web_steps.rb:113
    When I go to the commented stream page                                     # features/step_definitions/web_steps.rb:26
    Then I should not see "Look at this dog"                                   # features/step_definitions/web_steps.rb:113

  Scenario: unliking a post                                # features/desktop/activity_stream.feature:34
    When I sign in as "bob@bob.bob"                        # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page                 # features/step_definitions/web_steps.rb:22
    Then I should see "Look at this dog"                   # features/step_definitions/web_steps.rb:98
    When I like the post "Look at this dog" in the stream  # features/step_definitions/stream_steps.rb:1
    And I go to the activity stream page                   # features/step_definitions/web_steps.rb:26
    Then I should see "Look at this dog"                   # features/step_definitions/web_steps.rb:98
    When I go to the commented stream page                 # features/step_definitions/web_steps.rb:26
    Then I should not see "Look at this dog"               # features/step_definitions/web_steps.rb:113
    When I go to the liked stream page                     # features/step_definitions/web_steps.rb:26
    Then I should see "Look at this dog"                   # features/step_definitions/web_steps.rb:98
    When I am on "alice@alice.alice"'s page                # features/step_definitions/web_steps.rb:22
    And I unlike the post "Look at this dog" in the stream # features/step_definitions/stream_steps.rb:1
    And I go to the activity stream page                   # features/step_definitions/web_steps.rb:26
    Then I should not see "Look at this dog"               # features/step_definitions/web_steps.rb:113
    When I go to the liked stream page                     # features/step_definitions/web_steps.rb:26
    Then I should not see "Look at this dog"               # features/step_definitions/web_steps.rb:113

@javascript
Feature: Aspect navigation on the left menu
    In order to filter posts visibility and post targeting
    As a diaspora user
    I want to use the aspect navigation menu

  Background:                            # features/desktop/aspect_navigation.feature:7
    Given a user with username "bob"     # features/step_definitions/user_steps.rb:13
    And I sign in as "bob@bob.bob"       # features/step_definitions/session_steps.rb:18
    And I have an aspect called "Others" # features/step_definitions/user_steps.rb:65

  Scenario: All aspects are selected by default  # features/desktop/aspect_navigation.feature:12
    When I go to the aspects page                # features/step_definitions/web_steps.rb:26
    Then I should see "Besties" aspect selected  # features/step_definitions/aspects_steps.rb:108
    Then I should see "Unicorns" aspect selected # features/step_definitions/aspects_steps.rb:108
    Then I should see "Others" aspect selected   # features/step_definitions/aspects_steps.rb:108

  Scenario: Aspects selection is remembered through site navigation # features/desktop/aspect_navigation.feature:18
    When I select only "Besties" aspect                             # features/step_definitions/aspects_steps.rb:47
    Then I should be on the aspects page                            # features/step_definitions/web_steps.rb:174
    When I go to the stream page                                    # features/step_definitions/web_steps.rb:26
    And I go to the aspects page                                    # features/step_definitions/web_steps.rb:26
    Then I should see "Besties" aspect selected                     # features/step_definitions/aspects_steps.rb:108
    And I should see "Unicorns" aspect unselected                   # features/step_definitions/aspects_steps.rb:115
    And I should see "Others" aspect unselected                     # features/step_definitions/aspects_steps.rb:115
    When I go to the contacts page                                  # features/step_definitions/web_steps.rb:26
    And I go to the aspects page                                    # features/step_definitions/web_steps.rb:26
    Then I should see "Besties" aspect selected                     # features/step_definitions/aspects_steps.rb:108
    Then I should see "Unicorns" aspect unselected                  # features/step_definitions/aspects_steps.rb:115
    Then I should see "Others" aspect unselected                    # features/step_definitions/aspects_steps.rb:115

  Scenario: Aspects selection can include one or more aspects # features/desktop/aspect_navigation.feature:34
    When I go to the aspects page                             # features/step_definitions/web_steps.rb:26
    And I select only "Besties" aspect                        # features/step_definitions/aspects_steps.rb:47
    And I select "Unicorns" aspect as well                    # features/step_definitions/aspects_steps.rb:56
    Then I should see "Besties" aspect selected               # features/step_definitions/aspects_steps.rb:108
    Then I should see "Unicorns" aspect selected              # features/step_definitions/aspects_steps.rb:108
    Then I should see "Others" aspect unselected              # features/step_definitions/aspects_steps.rb:115

  Scenario: Deselect all aspects                   # features/desktop/aspect_navigation.feature:42
    When I go to the aspects page                  # features/step_definitions/web_steps.rb:26
    And I follow "Deselect all"                    # features/step_definitions/web_steps.rb:36
    Then I should see "Besties" aspect unselected  # features/step_definitions/aspects_steps.rb:115
    Then I should see "Unicorns" aspect unselected # features/step_definitions/aspects_steps.rb:115
    Then I should see "Others" aspect unselected   # features/step_definitions/aspects_steps.rb:115

@javascript
Feature: Blocking a user from the stream

  Background:                                                                             # features/desktop/blocks_user.feature:3
    Given following users exist:                                                          # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice"             # features/step_definitions/user_steps.rb:82
    And Alice has a post mentioning Bob                                                   # features/step_definitions/mention_steps.rb:1
    And "alice@alice.alice" has a public post with text "All your base are belong to us!" # features/step_definitions/posts_steps.rb:43
    And I sign in as "bob@bob.bob"                                                        # features/step_definitions/session_steps.rb:18

  Scenario: Blocking a user                                          # features/desktop/blocks_user.feature:13
    When I confirm the alert after I click on the first block button # features/step_definitions/custom_web_steps.rb:139
    And I go to the home page                                        # features/step_definitions/web_steps.rb:26
    Then I should not see any posts in my stream                     # features/step_definitions/posts_steps.rb:17

  Scenario: Blocking a user from the profile page                     # features/desktop/blocks_user.feature:18
    When I am on "alice@alice.alice"'s page                           # features/step_definitions/web_steps.rb:22
    And I confirm the alert after I click on the profile block button # features/step_definitions/custom_web_steps.rb:139
    Then I should see "Stop ignoring" within "#unblock_user_button"   # features/step_definitions/web_steps.rb:98
    And "All your base are belong to us!" should be post 1            # features/step_definitions/stream_steps.rb:9
    When I go to the home page                                        # features/step_definitions/web_steps.rb:26
    Then I should not see any posts in my stream                      # features/step_definitions/posts_steps.rb:17

@javascript
Feature: Change password

  Scenario: Change my password                                                              # features/desktop/change_password.feature:4
    Given I am signed in                                                                    # features/step_definitions/session_steps.rb:1
    When I go to the edit user page                                                         # features/step_definitions/web_steps.rb:26
    And I fill out change password section with my password and "newsecret" and "newsecret" # features/step_definitions/session_steps.rb:35
    And I press "Change password"                                                           # features/step_definitions/web_steps.rb:30
    Then I should see "Password changed"                                                    # features/step_definitions/web_steps.rb:98
    Then I should be on the new user session page                                           # features/step_definitions/web_steps.rb:174
    When I sign in with password "newsecret"                                                # features/step_definitions/session_steps.rb:25
    Then I should be on the stream page                                                     # features/step_definitions/web_steps.rb:174

  Scenario: Attempt to change my password with invalid input                      # features/desktop/change_password.feature:14
    Given I am signed in                                                          # features/step_definitions/session_steps.rb:1
    When I go to the edit user page                                               # features/step_definitions/web_steps.rb:26
    And I fill out change password section with my password and "too" and "short" # features/step_definitions/session_steps.rb:35
    And I press "Change password"                                                 # features/step_definitions/web_steps.rb:30
    Then I should see "Password change failed"                                    # features/step_definitions/web_steps.rb:98
    And I should see "Password is too short"                                      # features/step_definitions/web_steps.rb:98
    And I should see "Password confirmation doesn't match"                        # features/step_definitions/web_steps.rb:98

  Scenario: Reset my password                                                    # features/desktop/change_password.feature:23
    Given a user named "Georges Abitbol" with email "forgetful@users.net"        # features/step_definitions/user_steps.rb:17
    Given I am on forgot password page                                           # features/step_definitions/web_steps.rb:22
    When I fill out forgot password form with "forgetful@users.net"              # features/step_definitions/session_steps.rb:39
    And I submit forgot password form                                            # features/step_definitions/session_steps.rb:43
    Then I should see "You will receive an email with instructions"              # features/step_definitions/web_steps.rb:98
    When I follow the "Change my password" link from the last sent email         # features/step_definitions/user_steps.rb:143
    When I fill out the password reset form with "supersecret" and "supersecret" # features/step_definitions/session_steps.rb:47
    And I submit the password reset form                                         # features/step_definitions/session_steps.rb:51
    Then I should be on the stream page                                          # features/step_definitions/web_steps.rb:174
    And I sign out manually                                                      # features/step_definitions/session_steps.rb:60
    And I sign in manually as "georges_abitbol" with password "supersecret"      # features/step_definitions/session_steps.rb:10
    Then I should be on the stream page                                          # features/step_definitions/web_steps.rb:174

  Scenario: Attempt to reset password with invalid password               # features/desktop/change_password.feature:37
    Given a user named "Georges Abitbol" with email "forgetful@users.net" # features/step_definitions/user_steps.rb:17
    Given I am on forgot password page                                    # features/step_definitions/web_steps.rb:22
    When I fill out forgot password form with "forgetful@users.net"       # features/step_definitions/session_steps.rb:39
    And I submit forgot password form                                     # features/step_definitions/session_steps.rb:43
    When I follow the "Change my password" link from the last sent email  # features/step_definitions/user_steps.rb:143
    When I fill out the password reset form with "too" and "short"        # features/step_definitions/session_steps.rb:47
    And I press "Change my password"                                      # features/step_definitions/web_steps.rb:30
    Then I should be on the user password page                            # features/step_definitions/web_steps.rb:174
    And I should see "Password is too short"                              # features/step_definitions/web_steps.rb:98
    And I should see "Password confirmation doesn't match"                # features/step_definitions/web_steps.rb:98

  Scenario: Attempt to reset password with invalid email   # features/desktop/change_password.feature:49
    Given I am on forgot password page                     # features/step_definitions/web_steps.rb:22
    When I fill out forgot password form with "notanemail" # features/step_definitions/session_steps.rb:39
    And I submit forgot password form                      # features/step_definitions/session_steps.rb:43
    Then I should see "No account with this email exists"  # features/step_definitions/web_steps.rb:98

@javascript
Feature: Change settings

  Background:                       # features/desktop/change_settings.feature:4
    Given I am signed in            # features/step_definitions/session_steps.rb:1
    And I have following aspects:   # features/step_definitions/user_steps.rb:70
      | Friends |
      | Family  |
    When I go to the edit user page # features/step_definitions/web_steps.rb:26

  Scenario: Change my email                                        # features/desktop/change_settings.feature:11
    When I fill in the following:                                  # features/step_definitions/web_steps.rb:59
      | user_email | new_email@newplac.es |
    And I press "Change email"                                     # features/step_definitions/web_steps.rb:30
    Then I should see "Email changed"                              # features/step_definitions/web_steps.rb:98
    And I follow the "confirm_email" link from the last sent email # features/step_definitions/user_steps.rb:143
    Then I should see "activated"                                  # features/step_definitions/web_steps.rb:98
    And my "email" should be "new_email@newplac.es"                # features/step_definitions/user_steps.rb:183

  Scenario: Change my email preferences                                                  # features/desktop/change_settings.feature:20
    When I uncheck "user_email_preferences_mentioned"                                    # features/step_definitions/web_steps.rb:79
    And I press "change_email_preferences"                                               # features/step_definitions/web_steps.rb:30
    Then I should see "Email notifications changed"                                      # features/step_definitions/web_steps.rb:98
    And the "user_email_preferences_mentioned" checkbox should not be checked            # features/step_definitions/web_steps.rb:150
    When I uncheck "user_email_preferences_mentioned_in_comment"                         # features/step_definitions/web_steps.rb:79
    And I press "change_email_preferences"                                               # features/step_definitions/web_steps.rb:30
    Then I should see "Email notifications changed"                                      # features/step_definitions/web_steps.rb:98
    And the "user_email_preferences_mentioned_in_comment" checkbox should not be checked # features/step_definitions/web_steps.rb:150

  Scenario: Change my preferred language                 # features/desktop/change_settings.feature:30
    When I select "polski" from "user_language"          # features/step_definitions/web_steps.rb:67
    And I press "Change language"                        # features/step_definitions/web_steps.rb:30
    Then I should see "Język został zmieniony"           # features/step_definitions/web_steps.rb:98
    And "polski" should be selected from "user_language" # features/step_definitions/web_steps.rb:156

  Scenario: Change my post default aspects                    # features/desktop/change_settings.feature:36
    When I go to the stream page                              # features/step_definitions/web_steps.rb:26
    And I expand the publisher                                # features/step_definitions/custom_web_steps.rb:63
    Then I should see "All aspects" within ".aspect_dropdown" # features/step_definitions/web_steps.rb:98
    When I go to the edit user page                           # features/step_definitions/web_steps.rb:26
    And I press the aspect dropdown                           # features/step_definitions/aspects_steps.rb:84
    And I toggle the aspect "Family"                          # features/step_definitions/aspects_steps.rb:104
    And I press the aspect dropdown                           # features/step_definitions/aspects_steps.rb:84
    And I press "Change" within "#post-default-aspects"       # features/step_definitions/web_steps.rb:30
    And I go to the stream page                               # features/step_definitions/web_steps.rb:26
    And I expand the publisher                                # features/step_definitions/custom_web_steps.rb:63
    Then I should see "Family" within ".aspect_dropdown"      # features/step_definitions/web_steps.rb:98

  Scenario: Change my post default to public             # features/desktop/change_settings.feature:49
    When I press the aspect dropdown                     # features/step_definitions/aspects_steps.rb:84
    And I toggle the aspect "Public"                     # features/step_definitions/aspects_steps.rb:104
    And I press "Change" within "#post-default-aspects"  # features/step_definitions/web_steps.rb:30
    And I go to the stream page                          # features/step_definitions/web_steps.rb:26
    And I expand the publisher                           # features/step_definitions/custom_web_steps.rb:63
    Then I should see "Public" within ".aspect_dropdown" # features/step_definitions/web_steps.rb:98

@javascript
Feature: Close account
 In order to close an existing account
 As a user
 I want to sign in, close my account and try to log in again

  Scenario: user closes account                                          # features/desktop/closes_account.feature:7
    Given I am signed in                                                 # features/step_definitions/session_steps.rb:1
    When I go to the edit user page                                      # features/step_definitions/web_steps.rb:26
    And I click on selector "#close_account"                             # features/step_definitions/custom_web_steps.rb:131
    Then I should see a modal                                            # features/step_definitions/modal_steps.rb:1
    And I should see "Hey, please don’t go!" within "#closeAccountModal" # features/step_definitions/web_steps.rb:98
    When I put in my password in "close_account_password"                # features/step_definitions/session_steps.rb:31
    And I confirm the alert after I press "Close account" in the modal   # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the new user session page                        # features/step_definitions/web_steps.rb:174
    When I try to sign in manually                                       # features/step_definitions/session_steps.rb:6
    Then I should be on the new user session page                        # features/step_definitions/web_steps.rb:174
    And I should see a flash message with a warning                      # features/step_definitions/custom_web_steps.rb:255

@javascript
Feature: commenting
  In order to tell Alice how great the picture of her dog is
  As Alice's friend
  I want to comment on her post

  Background:                                                                 # features/desktop/comments.feature:7
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    When "alice@alice.alice" has posted a status message with a photo         # features/step_definitions/user_steps.rb:169
    And I sign in as "bob@bob.bob"                                            # features/step_definitions/session_steps.rb:18

  Scenario: comment on a post from within a user's stream            # features/desktop/comments.feature:16
    When I am on "alice@alice.alice"'s page                          # features/step_definitions/web_steps.rb:22
    Then I should see "Look at this dog"                             # features/step_definitions/web_steps.rb:98
    When I focus the comment field                                   # features/step_definitions/comment_steps.rb:1
    And I fill in the following:                                     # features/step_definitions/web_steps.rb:59
      | text | is that a poodle? |
    And I press "Comment"                                            # features/step_definitions/web_steps.rb:30
    Then I should see "is that a poodle?" within ".comment"          # features/step_definitions/web_steps.rb:98
    And I should see "less than a minute ago" within ".comment time" # features/step_definitions/web_steps.rb:98

  Scenario: delete a comment                                                   # features/desktop/comments.feature:26
    When "bob@bob.bob" has commented "is that a poodle?" on "Look at this dog" # features/step_definitions/comment_steps.rb:18
    And I am on "alice@alice.alice"'s page                                     # features/step_definitions/web_steps.rb:22
    Then I should see "is that a poodle?"                                      # features/step_definitions/web_steps.rb:98
    When I confirm the alert after I click to delete the first comment         # features/step_definitions/custom_web_steps.rb:139
    Then I should not see "is that a poodle?"                                  # features/step_definitions/web_steps.rb:113

  Scenario: expand the comment form in the main stream and an individual aspect stream # features/desktop/comments.feature:33
    Then I should see "Look at this dog"                                               # features/step_definitions/web_steps.rb:98
    And the first comment field should be closed                                       # features/step_definitions/comment_steps.rb:9
    When I focus the comment field                                                     # features/step_definitions/comment_steps.rb:1
    Then the first comment field should be open                                        # features/step_definitions/comment_steps.rb:5
    When I select only "Besties" aspect                                                # features/step_definitions/aspects_steps.rb:47
    Then I should see "Look at this dog"                                               # features/step_definitions/web_steps.rb:98
    And the first comment field should be closed                                       # features/step_definitions/comment_steps.rb:9
    When I focus the comment field                                                     # features/step_definitions/comment_steps.rb:1
    Then the first comment field should be open                                        # features/step_definitions/comment_steps.rb:5

  Scenario: comment on a status show page                         # features/desktop/comments.feature:45
    When I am on "alice@alice.alice"'s page                       # features/step_definitions/web_steps.rb:22
    Then I should see "Look at this dog"                          # features/step_definitions/web_steps.rb:98
    When I follow "less than a minute ago"                        # features/step_definitions/web_steps.rb:36
    Then I should see "Look at this dog"                          # features/step_definitions/web_steps.rb:98
    When I make a show page comment "I think that’s a cat"        # features/step_definitions/comment_steps.rb:14
    Then I should see "less than a minute ago" within "#comments" # features/step_definitions/web_steps.rb:98
    When I go to "alice@alice.alice"'s page                       # features/step_definitions/web_steps.rb:26
    Then I should see "I think that’s a cat"                      # features/step_definitions/web_steps.rb:98

  Scenario: permalink to comment from within a users stream                      # features/desktop/comments.feature:55
    When "bob@bob.bob" has commented a lot on "Look at this dog"                 # features/step_definitions/comment_steps.rb:30
    And "bob@bob.bob" has commented "I think that’s a cat" on "Look at this dog" # features/step_definitions/comment_steps.rb:18
    And I am on "alice@alice.alice"'s page                                       # features/step_definitions/web_steps.rb:22
    Then I should see "Look at this dog"                                         # features/step_definitions/web_steps.rb:98
    And I should see "I think that’s a cat" within ".comment:last-child"         # features/step_definitions/web_steps.rb:98
    When I follow "less than a minute ago" within ".comment:last-child"          # features/step_definitions/web_steps.rb:36
    Then I should see "Look at this dog" within "#single-post-content"           # features/step_definitions/web_steps.rb:98
    And I should see "I think that’s a cat" within ".comment .highlighted"       # features/step_definitions/web_steps.rb:98
    And I should have scrolled down                                              # features/step_definitions/custom_web_steps.rb:214

  Scenario: permalink to comment from a status show page                              # features/desktop/comments.feature:66
    When "bob@bob.bob" has commented a lot on "Look at this dog"                      # features/step_definitions/comment_steps.rb:30
    And "bob@bob.bob" has commented "I think that’s a cat" on "Look at this dog"      # features/step_definitions/comment_steps.rb:18
    And I am on "alice@alice.alice"'s page                                            # features/step_definitions/web_steps.rb:22
    Then I should see "Look at this dog"                                              # features/step_definitions/web_steps.rb:98
    When I follow "less than a minute ago" within "span.details.gray"                 # features/step_definitions/web_steps.rb:36
    Then I should see "I think that’s a cat" within ".comments .comment:last-child"   # features/step_definitions/web_steps.rb:98
    When I follow "less than a minute ago" within ".comments .comment:last-child"     # features/step_definitions/web_steps.rb:36
    Then I should see "I think that’s a cat" within ".comments .comment .highlighted" # features/step_definitions/web_steps.rb:98
    And I should have scrolled down                                                   # features/step_definitions/custom_web_steps.rb:214

  Scenario: Show more comments after loading likes                     # features/desktop/comments.feature:77
    When "alice@alice.alice" has commented a lot on "Look at this dog" # features/step_definitions/comment_steps.rb:30
    And "alice@alice.alice" has liked the post "Look at this dog"      # features/step_definitions/like_steps.rb:1
    And I am on "alice@alice.alice"'s page                             # features/step_definitions/web_steps.rb:22
    Then I should see "Look at this dog"                               # features/step_definitions/web_steps.rb:98
    And I should not see "Comment 2"                                   # features/step_definitions/web_steps.rb:113
    When I follow "1 Like"                                             # features/step_definitions/web_steps.rb:36
    Then I should not see "1 Like"                                     # features/step_definitions/web_steps.rb:113
    When I click on selector ".toggle_post_comments"                   # features/step_definitions/custom_web_steps.rb:131
    Then I should see "Comment 2"                                      # features/step_definitions/web_steps.rb:98

@javascript
Feature: following and being followed

  Background:                                   # features/desktop/connects_users.feature:4
    Given following users exist:                # features/step_definitions/user_steps.rb:29
      | email             |
      | bob@bob.bob       |
      | alice@alice.alice |
    When I sign in as "bob@bob.bob"             # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page      # features/step_definitions/web_steps.rb:22
    And I add the person to my "Besties" aspect # features/step_definitions/user_steps.rb:129
    And I sign out                              # features/step_definitions/session_steps.rb:55

  Scenario: I follow a malicious user                                                                # features/desktop/connects_users.feature:15
    When I sign in as "bob@bob.bob"                                                                  # features/step_definitions/session_steps.rb:18
    And I go to the edit profile page                                                                # features/step_definitions/web_steps.rb:26
    And I fill in the following:                                                                     # features/step_definitions/web_steps.rb:59
      | profile_first_name | <script>alert(0)// |
      | profile_last_name  |                    |
    And I press "update_profile"                                                                     # features/step_definitions/web_steps.rb:30
    Then I should be on my edit profile page                                                         # features/step_definitions/web_steps.rb:174
    When I sign in as "alice@alice.alice"                                                            # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                                                                 # features/step_definitions/web_steps.rb:22
    And I add the person to my "Besties" aspect                                                      # features/step_definitions/user_steps.rb:129
    Then I should see a flash message containing "You have started sharing with <script>alert(0)//!" # features/step_definitions/custom_web_steps.rb:259

  Scenario: adding someone who follows you while creating a new aspect           # features/desktop/connects_users.feature:29
    When I sign in as "alice@alice.alice"                                        # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                                             # features/step_definitions/web_steps.rb:22
    And I press the first ".aspect_membership_dropdown .dropdown-toggle"         # features/step_definitions/custom_web_steps.rb:165
    And I press the first "a" within ".add_aspect"                               # features/step_definitions/custom_web_steps.rb:165
    And I fill in "aspect_name" with "Super People" in the aspect creation modal # features/step_definitions/aspects_steps.rb:88
    And I click on selector ".btn-primary" in the aspect creation modal          # features/step_definitions/aspects_steps.rb:88
    When I go to the home page                                                   # features/step_definitions/web_steps.rb:26
    Then I should have 1 contact in "Super People"                               # features/step_definitions/user_steps.rb:125
    Then I sign out                                                              # features/step_definitions/session_steps.rb:55
    When I sign in as "bob@bob.bob"                                              # features/step_definitions/session_steps.rb:18
    Then I should have 1 contact in "Besties"                                    # features/step_definitions/user_steps.rb:125

  Scenario: interacting with the profile page of someone you follow who is not following you # features/desktop/connects_users.feature:46
    When I sign in as "bob@bob.bob"                                                          # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page                                                   # features/step_definitions/web_steps.rb:22
    Then I should see "Besties"                                                              # features/step_definitions/web_steps.rb:98
    Then I should see a "#mention_button" within "#profile_buttons"                          # features/step_definitions/custom_web_steps.rb:177
    Then I should not see a "#message_button" within "#profile_buttons"                      # features/step_definitions/custom_web_steps.rb:183

  Scenario: interacting with the profile page of someone who follows you but who you do not follow # features/desktop/connects_users.feature:54
    Given I sign in as "alice@alice.alice"                                                         # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                                                               # features/step_definitions/web_steps.rb:22
    Then I should see "Add contact"                                                                # features/step_definitions/web_steps.rb:98
    Then I should not see a "#mention_button" within "#profile_buttons"                            # features/step_definitions/custom_web_steps.rb:183
    Then I should not see a "#message_button" within "#profile_buttons"                            # features/step_definitions/custom_web_steps.rb:183

  Scenario: interacting with the profile page of someone you follow who also follows you # features/desktop/connects_users.feature:62
    Given I sign in as "alice@alice.alice"                                               # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                                                     # features/step_definitions/web_steps.rb:22
    When I add the person to my "Besties" aspect                                         # features/step_definitions/user_steps.rb:129
    And I add the person to my "Unicorns" aspect                                         # features/step_definitions/user_steps.rb:129
    When I go to "bob@bob.bob"'s page                                                    # features/step_definitions/web_steps.rb:26
    Then I should see "All aspects"                                                      # features/step_definitions/web_steps.rb:98
    Then I should see a "#mention_button" within "#profile_buttons"                      # features/step_definitions/custom_web_steps.rb:177
    Then I should see a "#message_button" within "#profile_buttons"                      # features/step_definitions/custom_web_steps.rb:177

@javascript
Feature: show contacts

  Background:                                    # features/desktop/contacts.feature:4
    Given following users exist:                 # features/step_definitions/user_steps.rb:29
      | username     | email              |
      | Bob Jones    | bob@bob.bob        |
      | Alice Smith  | alice@alice.alice  |
      | Robert Grimm | robert@grimm.grimm |
    And I sign in as "robert@grimm.grimm"        # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page       # features/step_definitions/web_steps.rb:22
    And I add the person to my "Unicorns" aspect # features/step_definitions/user_steps.rb:129

  Scenario: see own contacts on profile      # features/desktop/contacts.feature:14
    When I am on "robert@grimm.grimm"'s page # features/step_definitions/web_steps.rb:22
    And I press the first "#contacts_link"   # features/step_definitions/custom_web_steps.rb:165
    Then I should be on the contacts page    # features/step_definitions/web_steps.rb:174

  Scenario: see contacts of a visible aspect list                                           # features/desktop/contacts.feature:19
    When I am on "bob@bob.bob"'s page                                                       # features/step_definitions/web_steps.rb:22
    And I add the person to my "Unicorns" aspect                                            # features/step_definitions/user_steps.rb:129
    And I sign out                                                                          # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                                                    # features/step_definitions/session_steps.rb:18
    And I am on "robert@grimm.grimm"'s page                                                 # features/step_definitions/web_steps.rb:22
    Then I should see "Contacts" within "#profile-horizontal-bar"                           # features/step_definitions/web_steps.rb:98
    When I press the first "#contacts_link"                                                 # features/step_definitions/custom_web_steps.rb:165
    Then I should see "Bob Jones" within "#people_stream .media-body"                       # features/step_definitions/web_steps.rb:98
    When I add the person to my "Besties" aspect within "#people_stream"                    # features/step_definitions/user_steps.rb:129
    Then I should see a flash message containing "You have started sharing with Bob Jones!" # features/step_definitions/custom_web_steps.rb:259

  Scenario: don't see contacts of an invisible aspect list            # features/desktop/contacts.feature:32
    When I am on "bob@bob.bob"'s page                                 # features/step_definitions/web_steps.rb:22
    And I add the person to my "Unicorns" aspect                      # features/step_definitions/user_steps.rb:129
    And I am on the contacts page                                     # features/step_definitions/web_steps.rb:22
    And I follow "Unicorns"                                           # features/step_definitions/web_steps.rb:36
    And I press the first "a#contacts_visibility_toggle"              # features/step_definitions/custom_web_steps.rb:165
    And I sign out                                                    # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                              # features/step_definitions/session_steps.rb:18
    And I am on "robert@grimm.grimm"'s page                           # features/step_definitions/web_steps.rb:22
    Then I should not see "Contacts" within "#profile-horizontal-bar" # features/step_definitions/web_steps.rb:113

@javascript
Feature: private conversations
    In order to be talkative
    As a User
    I want to converse with people

  Background:                                                                 # features/desktop/conversations.feature:7
    Given a user named "Robert Grimm" with email "bob@bob.bob"                # features/step_definitions/user_steps.rb:17
    And a user named "Alice Awesome" with email "alice@alice.alice"           # features/step_definitions/user_steps.rb:17
    And a user with username "robert_grimm" is connected with "alice_awesome" # features/step_definitions/user_steps.rb:88

  Scenario: open the conversations page without any contacts                              # features/desktop/conversations.feature:12
    Given a user with email "eve@eve.eve"                                                 # features/step_definitions/user_steps.rb:9
    When I sign in as "eve@eve.eve"                                                       # features/step_definitions/session_steps.rb:18
    And I am on the conversations page                                                    # features/step_definitions/web_steps.rb:22
    Then I should see "You need to add some contacts before you can start a conversation" # features/step_definitions/web_steps.rb:98

  Scenario: send a message                                                                    # features/desktop/conversations.feature:18
    When I sign in as "bob@bob.bob"                                                           # features/step_definitions/session_steps.rb:18
    And I send a message with subject "Greetings" and text "hello, alice!" to "Alice Awesome" # features/step_definitions/conversations_steps.rb:15
    Then I should see "Greetings" within "#conversation-inbox"                                # features/step_definitions/web_steps.rb:98
    And I should see "Greetings" within "#conversation-show"                                  # features/step_definitions/web_steps.rb:98
    And I should see "less than a minute ago" within "#conversation-inbox"                    # features/step_definitions/web_steps.rb:98
    And I should see "less than a minute ago" within "#conversation-show"                     # features/step_definitions/web_steps.rb:98
    And I should see "Alice Awesome" as a participant                                         # features/step_definitions/conversations_steps.rb:61
    And "Alice Awesome" should be part of active conversation                                 # features/step_definitions/conversations_steps.rb:1
    And I should see "hello, alice!" within ".stream_container"                               # features/step_definitions/web_steps.rb:98
    When I sign in as "alice@alice.alice"                                                     # features/step_definitions/session_steps.rb:18
    Then I should have 1 unread private message                                               # features/step_definitions/conversations_steps.rb:7
    And I should have 1 email delivery                                                        # features/step_definitions/user_steps.rb:159
    When I reply with "hey, how you doing?"                                                   # features/step_definitions/conversations_steps.rb:37
    Then I should see "hey, how you doing?" within ".stream_container"                        # features/step_definitions/web_steps.rb:98

  Scenario: send a message using keyboard shortcuts                                                                    # features/desktop/conversations.feature:34
    When I sign in as "bob@bob.bob"                                                                                    # features/step_definitions/session_steps.rb:18
    And I send a message with subject "Greetings" and text "hello, alice!" to "Alice Awesome" using keyboard shortcuts # features/step_definitions/conversations_steps.rb:26
    Then I should see "Greetings" within "#conversation-inbox"                                                         # features/step_definitions/web_steps.rb:98
    And I should see "Greetings" within "#conversation-show"                                                           # features/step_definitions/web_steps.rb:98
    And "Alice Awesome" should be part of active conversation                                                          # features/step_definitions/conversations_steps.rb:1
    And I should see "hello, alice!" within ".stream_container"                                                        # features/step_definitions/web_steps.rb:98
    When I reply with "hey, how you doing?" using keyboard shortcuts                                                   # features/step_definitions/conversations_steps.rb:44
    Then I should see "hey, how you doing?" within ".stream_container"                                                 # features/step_definitions/web_steps.rb:98
    When I sign in as "alice@alice.alice"                                                                              # features/step_definitions/session_steps.rb:18
    Then I should have 2 unread private messages                                                                       # features/step_definitions/conversations_steps.rb:7
    And I should have 2 email delivery                                                                                 # features/step_definitions/user_steps.rb:159

  Scenario: send a message from the profile page                # features/desktop/conversations.feature:47
    When I sign in as "bob@bob.bob"                             # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page                      # features/step_definitions/web_steps.rb:22
    And I click on selector "#message_button"                   # features/step_definitions/custom_web_steps.rb:131
    And I fill in "conversation-subject" with "Greetings"       # features/step_definitions/web_steps.rb:42
    And I fill in "new-message-text" with "hello, alice!"       # features/step_definitions/web_steps.rb:42
    And I press "Send" within "#conversationModal"              # features/step_definitions/web_steps.rb:30
    Then I should see "Greetings" within "#conversation-inbox"  # features/step_definitions/web_steps.rb:98
    And I should see "Greetings" within "#conversation-show"    # features/step_definitions/web_steps.rb:98
    And "Alice Awesome" should be part of active conversation   # features/step_definitions/conversations_steps.rb:1
    And I should see "hello, alice!" within ".stream_container" # features/step_definitions/web_steps.rb:98

  Scenario: delete a conversation                                                             # features/desktop/conversations.feature:59
    When I sign in as "bob@bob.bob"                                                           # features/step_definitions/session_steps.rb:18
    And I send a message with subject "Greetings" and text "hello, alice!" to "Alice Awesome" # features/step_definitions/conversations_steps.rb:15
    Then I should see "Greetings" within "#conversation-inbox"                                # features/step_definitions/web_steps.rb:98
    When I click on selector ".hide_conversation"                                             # features/step_definitions/custom_web_steps.rb:131
    Then I should not see "Greetings" within "#conversation-inbox"                            # features/step_definitions/web_steps.rb:113
    When I sign in as "alice@alice.alice"                                                     # features/step_definitions/session_steps.rb:18
    Then I should have 1 unread private message                                               # features/step_definitions/conversations_steps.rb:7
    And I should have 1 email delivery                                                        # features/step_definitions/user_steps.rb:159
    When I reply with "hey, how you doing?"                                                   # features/step_definitions/conversations_steps.rb:37
    Then I should see "hey, how you doing?" within ".stream_container"                        # features/step_definitions/web_steps.rb:98
    When I sign in as "bob@bob.bob"                                                           # features/step_definitions/session_steps.rb:18
    Then I should have 1 email delivery                                                       # features/step_definitions/user_steps.rb:159
    And I should have no unread private messages                                              # features/step_definitions/conversations_steps.rb:11

@javascript
Feature: donations
  In order to accept donation
  As a podmin
  I want a donation box shown on the stream page

  Background:                            # features/desktop/donations.feature:7
    Given following user exists:         # features/step_definitions/user_steps.rb:29
      | username | email             |
      | Alice    | alice@alice.alice |
    And I sign in as "alice@alice.alice" # features/step_definitions/session_steps.rb:18

  Scenario: Bitcoin donations                     # features/desktop/donations.feature:13
    Given I have configured a Bitcoin address     # features/step_definitions/custom_web_steps.rb:283
    And I go to the home page                     # features/step_definitions/web_steps.rb:26
    Then I should see "Donate" within ".info-bar" # features/step_definitions/web_steps.rb:98
    And I click on "Donate" navbar title          # features/step_definitions/stream_steps.rb:25
    Then I should see the Bitcoin address         # features/step_definitions/custom_web_steps.rb:287

  Scenario: Liberapay donations                   # features/desktop/donations.feature:20
    Given I have configured a Liberapay username  # features/step_definitions/custom_web_steps.rb:291
    And I go to the home page                     # features/step_definitions/web_steps.rb:26
    Then I should see "Donate" within ".info-bar" # features/step_definitions/web_steps.rb:98
    And I click on "Donate" navbar title          # features/step_definitions/stream_steps.rb:25
    Then I should see the Liberapay donate button # features/step_definitions/custom_web_steps.rb:295

@javascript
Feature: Download Photos

  Scenario: Request my photos                                                             # features/desktop/download_photos.feature:4
    Given I am signed in                                                                  # features/step_definitions/session_steps.rb:1
    When I click on my name in the header                                                 # features/step_definitions/custom_web_steps.rb:53
    When I follow "Settings"                                                              # features/step_definitions/web_steps.rb:36
    Then I should be on my account settings page                                          # features/step_definitions/web_steps.rb:174
    When I follow "Request my photos"                                                     # features/step_definitions/web_steps.rb:36
    Then I should see a flash message indicating success                                  # features/step_definitions/custom_web_steps.rb:243
    And I should see a flash message containing "We are currently processing your photos" # features/step_definitions/custom_web_steps.rb:259

  Scenario: Refresh my photos                                                             # features/desktop/download_photos.feature:13
    Given I am signed in                                                                  # features/step_definitions/session_steps.rb:1
    When I did request my photos                                                          # features/step_definitions/user_steps.rb:232
    And I click on my name in the header                                                  # features/step_definitions/custom_web_steps.rb:53
    When I follow "Settings"                                                              # features/step_definitions/web_steps.rb:36
    Then I should be on my account settings page                                          # features/step_definitions/web_steps.rb:174
    When I follow "Refresh my photos"                                                     # features/step_definitions/web_steps.rb:36
    Then I should see a flash message indicating success                                  # features/step_definitions/custom_web_steps.rb:243
    And I should see a flash message containing "We are currently processing your photos" # features/step_definitions/custom_web_steps.rb:259

  Scenario: Download my photos                   # features/desktop/download_photos.feature:23
    Given I am signed in                         # features/step_definitions/session_steps.rb:1
    When I did request my photos                 # features/step_definitions/user_steps.rb:232
    And I click on my name in the header         # features/step_definitions/custom_web_steps.rb:53
    When I follow "Settings"                     # features/step_definitions/web_steps.rb:36
    Then I should be on my account settings page # features/step_definitions/web_steps.rb:174
    When I follow "Download my photos"           # features/step_definitions/web_steps.rb:36
    Then I should get a zipped file              # features/step_definitions/user_steps.rb:236

@javascript
Feature: editing your profile

  Scenario: editing profile fields                                                             # features/desktop/edits_profile.feature:3
    Given I am signed in                                                                       # features/step_definitions/session_steps.rb:1
    And I go to the edit profile page                                                          # features/step_definitions/web_steps.rb:26
    When I fill in the following:                                                              # features/step_definitions/web_steps.rb:59
      | profile_gender     | Fearless      |
      | profile_first_name | Boba          |
      | profile_last_name  | Fett          |
      | profile_bio        | This is a bio |
      | profile_location   | Kamino        |
    And I select "1986" from "profile_date_year"                                               # features/step_definitions/web_steps.rb:67
    And I select "30" from "profile_date_day"                                                  # features/step_definitions/web_steps.rb:67
    And I select "November" from "profile_date_month"                                          # features/step_definitions/web_steps.rb:67
    And I fill in "profile[tag_string]" with "#starwars"                                       # features/step_definitions/web_steps.rb:42
    And I press the first ".as-result-item" within ".as-results"                               # features/step_definitions/custom_web_steps.rb:165
    And I press "update_profile"                                                               # features/step_definitions/web_steps.rb:30
    Then I should be on my edit profile page                                                   # features/step_definitions/web_steps.rb:174
    And I should see a flash message indicating success                                        # features/step_definitions/custom_web_steps.rb:243
    And the "profile_gender" field should contain "Fearless"                                   # features/step_definitions/web_steps.rb:128
    And the "profile_first_name" field should contain "Boba"                                   # features/step_definitions/web_steps.rb:128
    And the "profile_last_name" field should contain "Fett"                                    # features/step_definitions/web_steps.rb:128
    And the "profile_bio" field should contain "This is a bio"                                 # features/step_definitions/web_steps.rb:128
    And the "profile_date_year" field should be filled with "1986"                             # features/step_definitions/custom_web_steps.rb:197
    And the "profile_date_month" field should be filled with "11"                              # features/step_definitions/custom_web_steps.rb:197
    And the "profile_date_day" field should be filled with "30"                                # features/step_definitions/custom_web_steps.rb:197
    And the "profile_location" field should be filled with "Kamino"                            # features/step_definitions/custom_web_steps.rb:197
    And I should see "#starwars" within "ul#as-selections-tags"                                # features/step_definitions/web_steps.rb:98
    And the "#profile_public_details" bootstrap-switch should be off                           # features/step_definitions/web_steps.rb:162
    When I fill in "profile[tag_string]" with "#kamino"                                        # features/step_definitions/web_steps.rb:42
    And I press the first ".as-result-item" within ".as-results"                               # features/step_definitions/custom_web_steps.rb:165
    And I toggle the "#profile_public_details" bootstrap-switch                                # features/step_definitions/web_steps.rb:170
    And I press "update_profile"                                                               # features/step_definitions/web_steps.rb:30
    Then I should see "#kamino" within "ul#as-selections-tags"                                 # features/step_definitions/web_steps.rb:98
    And I should see "#starwars" within "ul#as-selections-tags"                                # features/step_definitions/web_steps.rb:98
    And the "#profile_public_details" bootstrap-switch should be on                            # features/step_definitions/web_steps.rb:162
    When I attach the file "spec/fixtures/bad_urls.txt" to "qqfile" within "#file-upload"      # features/step_definitions/web_steps.rb:91
    Then I should see a flash message indicating failure                                       # features/step_definitions/custom_web_steps.rb:247
    When I attach the file "spec/fixtures/button.png" to hidden "qqfile" within "#file-upload" # features/step_definitions/web_steps.rb:91
    Then I should see "button.png completed"                                                   # features/step_definitions/web_steps.rb:98
    And I should see a "img" within "#profile_photo_upload"                                    # features/step_definitions/custom_web_steps.rb:177
    When I go to my edit profile page                                                          # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within "#profile_photo_upload"                                   # features/step_definitions/custom_web_steps.rb:177

@javascript
Feature: posting
  In order to take over humanity for the good of society
  As a rock star
  I want to see what humanity is saying about particular tags

  Background:                                                     # features/desktop/follows_tags.feature:7
    Given following users exist:                                  # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Alice Smith | alice@alice.alice |
      | Bob Jones   | bob@bob.bob       |
    And "bob@bob.bob" has a public post with text "I am da #boss" # features/step_definitions/posts_steps.rb:43
    When I sign in as "alice@alice.alice"                         # features/step_definitions/session_steps.rb:18
    And I go to the tag page for "boss"                           # features/step_definitions/web_steps.rb:26
    And I press "Follow #boss"                                    # features/step_definitions/web_steps.rb:30
    Then I should see a ".tag-following-action .followed"         # features/step_definitions/custom_web_steps.rb:177

  Scenario: can post a message from the tag page                  # features/desktop/follows_tags.feature:18
    Then I should see "#boss " in the publisher                   # features/step_definitions/posts_steps.rb:35
    When I click the publisher and post "#boss from the tag page" # features/step_definitions/posts_steps.rb:101
    And I go to the tag page for "boss"                           # features/step_definitions/web_steps.rb:26
    Then I should see "#boss from the tag page"                   # features/step_definitions/web_steps.rb:98

  Scenario: see a tag that I am following           # features/desktop/follows_tags.feature:24
    When I go to the home page                      # features/step_definitions/web_steps.rb:26
    And I follow "#boss"                            # features/step_definitions/web_steps.rb:36
    Then I should see "I am da #boss" within "body" # features/step_definitions/web_steps.rb:98

  Scenario: see a tag that I am following and I post over there        # features/desktop/follows_tags.feature:29
    When I go to the home page                                         # features/step_definitions/web_steps.rb:26
    And I follow "#boss"                                               # features/step_definitions/web_steps.rb:36
    And I click the publisher and post "#boss from the #boss tag page" # features/step_definitions/posts_steps.rb:101
    Then I should see "#boss from the #boss tag page" within "body"    # features/step_definitions/web_steps.rb:98

  Scenario: can stop following a tag from the tag page # features/desktop/follows_tags.feature:35
    When I press "Following #boss"                     # features/step_definitions/web_steps.rb:30
    And I go to the followed tags stream page          # features/step_definitions/web_steps.rb:26
    Then I should not see "#boss" within "#tags_list"  # features/step_definitions/web_steps.rb:113

  Scenario: can stop following a tag from the homepage              # features/desktop/follows_tags.feature:40
    When I go to the followed tags stream page                      # features/step_definitions/web_steps.rb:26
    And I unfollow the "boss" tag                                   # features/step_definitions/tag_steps.rb:1
    Then I should not see "#tag-following-boss" within "#tags_list" # features/step_definitions/web_steps.rb:113

  Scenario: Go to a tags page with no posts      # features/desktop/follows_tags.feature:45
    When I go to the tag page for "NoPosts"      # features/step_definitions/web_steps.rb:26
    Then I should not see any posts in my stream # features/step_definitions/posts_steps.rb:17

@javascript
Feature: Getting help

  Scenario: Visit help page                                                            # features/desktop/help.feature:4
    When I am on the help page                                                         # features/step_definitions/web_steps.rb:22
    Then I should see "diaspora* FAQ"                                                  # features/step_definitions/web_steps.rb:98
    When I follow "Mentions"                                                           # features/step_definitions/web_steps.rb:36
    Then I should see "What is a “mention”?" within ".faq_question_mentions .question" # features/step_definitions/web_steps.rb:98

@javascript
Feature: Hovercards
  In order to not having to leave the page to view a persons profile
  As a user
  I want to use hovercards

  Background:                                                                         # features/desktop/hovercards.feature:7
    Given a user named "Bob Jones" with email "bob@bob.bob"                           # features/step_definitions/user_steps.rb:17
    And "bob@bob.bob" has a public post with text "public stuff #hashtag"             # features/step_definitions/posts_steps.rb:43
    And a user named "Alice" with email "alice@alice.alice"                           # features/step_definitions/user_steps.rb:17
    And "alice@alice.alice" has a public post with text "alice public stuff"          # features/step_definitions/posts_steps.rb:43
    And the post with text "public stuff #hashtag" is reshared by "alice@alice.alice" # features/step_definitions/posts_steps.rb:78
    And the post with text "alice public stuff" is reshared by "bob@bob.bob"          # features/step_definitions/posts_steps.rb:78

  Scenario: Hovercards on the main stream                     # features/desktop/hovercards.feature:15
    Given I sign in as "alice@alice.alice"                    # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                          # features/step_definitions/web_steps.rb:22
    Then I should see "public stuff" within ".stream-element" # features/step_definitions/web_steps.rb:98
    When I activate the first hovercard                       # features/step_definitions/hovercard_steps.rb:1
    Then I should see a hovercard                             # features/step_definitions/hovercard_steps.rb:5
    When I deactivate the first hovercard                     # features/step_definitions/hovercard_steps.rb:14
    Then I should not see a hovercard                         # features/step_definitions/hovercard_steps.rb:18

  Scenario: Hovercards on the main stream in reshares   # features/desktop/hovercards.feature:24
    Given I sign in as "alice@alice.alice"              # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                    # features/step_definitions/web_steps.rb:22
    Then I should see "Alice" within "#main_stream"     # features/step_definitions/web_steps.rb:98
    When I hover "Alice" within "#main_stream"          # features/step_definitions/hovercard_steps.rb:22
    Then I should not see a hovercard                   # features/step_definitions/hovercard_steps.rb:18
    When I am on "alice@alice.alice"'s page             # features/step_definitions/web_steps.rb:22
    Then I should see "Bob Jones" within "#main_stream" # features/step_definitions/web_steps.rb:98
    When I hover "Bob Jones" within "#main_stream"      # features/step_definitions/hovercard_steps.rb:22
    Then I should see a hovercard                       # features/step_definitions/hovercard_steps.rb:5

  Scenario: Hovercards on the tag stream as a logged out user # features/desktop/hovercards.feature:35
    Given I am on the tag page for "hashtag"                  # features/step_definitions/web_steps.rb:22
    Then I should see "public stuff" within ".stream-element" # features/step_definitions/web_steps.rb:98
    When I activate the first hovercard                       # features/step_definitions/hovercard_steps.rb:1
    Then I should see a hovercard                             # features/step_definitions/hovercard_steps.rb:5
    When I deactivate the first hovercard                     # features/step_definitions/hovercard_steps.rb:14
    Then I should not see a hovercard                         # features/step_definitions/hovercard_steps.rb:18

  Scenario: Hovercards contain profile tags                          # features/desktop/hovercards.feature:43
    Given a user with email "bob@bob.bob" is tagged "#first #second" # features/step_definitions/user_steps.rb:103
    And I sign in as "alice@alice.alice"                             # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                                 # features/step_definitions/web_steps.rb:22
    Then I should see "public stuff" within ".stream-element"        # features/step_definitions/web_steps.rb:98
    When I activate the first hovercard                              # features/step_definitions/hovercard_steps.rb:1
    Then I should see a hovercard                                    # features/step_definitions/hovercard_steps.rb:5
    And I should see "#first" hashtag in the hovercard               # features/step_definitions/hovercard_steps.rb:9
    And I should see "#second" hashtag in the hovercard              # features/step_definitions/hovercard_steps.rb:9

@javascript
Feature: Invitations

  Background:                    # features/desktop/invitations.feature:3
    Given following users exist: # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Alice Smith | alice@alice.alice |

  Scenario: accept invitation from admin                    # features/desktop/invitations.feature:8
    Given I have been invited by an admin                   # features/step_definitions/user_steps.rb:42
    And I am on my acceptance form page                     # features/step_definitions/web_steps.rb:22
    And I fill in the new user form                         # features/step_definitions/user_steps.rb:218
    And I press "Create account"                            # features/step_definitions/web_steps.rb:30
    Then I should be on the getting started page            # features/step_definitions/web_steps.rb:174
    And I should see "Well, hello there!"                   # features/step_definitions/web_steps.rb:98
    And I fill in the following:                            # features/step_definitions/web_steps.rb:59
      | profile_first_name | O |
    And I confirm the alert after I follow "awesome_button" # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                     # features/step_definitions/web_steps.rb:174
    And I close the publisher                               # features/step_definitions/custom_web_steps.rb:67

  Scenario: accept invitation from user                     # features/desktop/invitations.feature:22
    Given I have been invited by "alice@alice.alice"        # features/step_definitions/user_steps.rb:49
    And I am on my acceptance form page                     # features/step_definitions/web_steps.rb:22
    And I fill in the new user form                         # features/step_definitions/user_steps.rb:218
    And I press "Create account"                            # features/step_definitions/web_steps.rb:30
    Then I should be on the getting started page            # features/step_definitions/web_steps.rb:174
    And I should see "Well, hello there!"                   # features/step_definitions/web_steps.rb:98
    And I should be able to friend "alice@alice.alice"      # features/step_definitions/user_steps.rb:222
    And I fill in the following:                            # features/step_definitions/web_steps.rb:59
      | profile_first_name | O |
    And I confirm the alert after I follow "awesome_button" # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                     # features/step_definitions/web_steps.rb:174
    And I close the publisher                               # features/step_definitions/custom_web_steps.rb:67
    And I log out                                           # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                    # features/step_definitions/session_steps.rb:18
    And I click on "Invite your friends" navbar title       # features/step_definitions/stream_steps.rb:25
    And I click on selector "#invitations-button"           # features/step_definitions/custom_web_steps.rb:131
    Then I should see one less invite                       # features/step_definitions/user_steps.rb:57

  Scenario: sends an invitation from the sidebar                                    # features/desktop/invitations.feature:42
    When I sign in as "alice@alice.alice"                                           # features/step_definitions/session_steps.rb:18
    And I click on "Invite your friends" navbar title                               # features/step_definitions/stream_steps.rb:25
    And I click on selector "#invitations-button"                                   # features/step_definitions/custom_web_steps.rb:131
    And I fill in the following:                                                    # features/step_definitions/web_steps.rb:59
      | email_inviter_emails | alex@example.com |
    And I press "Send an invitation"                                                # features/step_definitions/web_steps.rb:30
    Then I should see a flash message indicating success                            # features/step_definitions/custom_web_steps.rb:243
    And I should have 1 Devise email delivery                                       # features/step_definitions/user_steps.rb:155
    And I should not see "change your notification settings" in the last sent email # features/step_definitions/user_steps.rb:163

  Scenario: sends an invitation from the stream                                           # features/desktop/invitations.feature:53
    When I sign in as "alice@alice.alice"                                                 # features/step_definitions/session_steps.rb:18
    And I press the first "a.invitations-link" within "#no_contacts"                      # features/step_definitions/custom_web_steps.rb:165
    Then I should see "Invite someone to join diaspora*!" within "#invitationsModalLabel" # features/step_definitions/web_steps.rb:98
    And I fill in the following:                                                          # features/step_definitions/web_steps.rb:59
      | email_inviter_emails | alex@example.com |
    And I press "Send an invitation"                                                      # features/step_definitions/web_steps.rb:30
    Then I should see a flash message indicating success                                  # features/step_definitions/custom_web_steps.rb:243
    And I should have 1 Devise email delivery                                             # features/step_definitions/user_steps.rb:155
    And I should not see "change your notification settings" in the last sent email       # features/step_definitions/user_steps.rb:163

  Scenario: sends an invitation from the people search page                         # features/desktop/invitations.feature:64
    When I sign in as "alice@alice.alice"                                           # features/step_definitions/session_steps.rb:18
    And I search for "test"                                                         # features/step_definitions/search_steps.rb:15
    Then I should see "Users matching test" within "#search_title"                  # features/step_definitions/web_steps.rb:98
    When I click on selector "#invitations-button"                                  # features/step_definitions/custom_web_steps.rb:131
    And I fill in the following:                                                    # features/step_definitions/web_steps.rb:59
      | email_inviter_emails | alex@example.com |
    And I press "Send an invitation"                                                # features/step_definitions/web_steps.rb:30
    Then I should have 1 Devise email delivery                                      # features/step_definitions/user_steps.rb:155
    And I should not see "change your notification settings" in the last sent email # features/step_definitions/user_steps.rb:163

@javascript
Feature: Keyboard navigation
  In order not to have to move my hand to the mouse
  As a user
  I want to be able to navigate the stream by keyboard

  Background:                           # features/desktop/keyboard_navigation.feature:7
    Given many posts from alice for bob # features/step_definitions/user_steps.rb:110
    And I sign in as "bob@bob.bob"      # features/step_definitions/session_steps.rb:18

  Scenario: navigate downwards                          # features/desktop/keyboard_navigation.feature:11
    When I press the "J" key somewhere                  # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 1 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post # features/step_definitions/keyboard_navigation_steps.rb:15
    When I press the "J" key somewhere                  # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 2 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post # features/step_definitions/keyboard_navigation_steps.rb:15
    Given I expand the publisher                        # features/step_definitions/custom_web_steps.rb:63
    When I press the "J" key in the publisher           # features/step_definitions/keyboard_navigation_steps.rb:7
    Then post 2 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I close the publisher                           # features/step_definitions/custom_web_steps.rb:67

  Scenario: navigate downwards after changing the stream            # features/desktop/keyboard_navigation.feature:25
    When I go to the activity stream page                           # features/step_definitions/web_steps.rb:26
    And I click on selector "[data-stream='stream'] a"              # features/step_definitions/custom_web_steps.rb:131
    Then I should see "Stream" within "#stream_selection .selected" # features/step_definitions/web_steps.rb:98
    When I press the "J" key somewhere                              # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 1 should be highlighted                               # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post             # features/step_definitions/keyboard_navigation_steps.rb:15
    When I press the "J" key somewhere                              # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 2 should be highlighted                               # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post             # features/step_definitions/keyboard_navigation_steps.rb:15

  Scenario: navigate upwards                            # features/desktop/keyboard_navigation.feature:38
    When I press the "J" key somewhere                  # features/step_definitions/keyboard_navigation_steps.rb:1
    And I press the "J" key somewhere                   # features/step_definitions/keyboard_navigation_steps.rb:1
    And I press the "J" key somewhere                   # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 3 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    When I press the "K" key somewhere                  # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 2 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post # features/step_definitions/keyboard_navigation_steps.rb:15

  Scenario: expand the comment form in the main stream # features/desktop/keyboard_navigation.feature:48
    Given the first comment field should be closed     # features/step_definitions/comment_steps.rb:9
    When I press the "J" key somewhere                 # features/step_definitions/keyboard_navigation_steps.rb:1
    And I press the "C" key somewhere                  # features/step_definitions/keyboard_navigation_steps.rb:1
    Then the first comment field should be open        # features/step_definitions/comment_steps.rb:5

  Scenario: navigate downwards on a profile page        # features/desktop/keyboard_navigation.feature:54
    When I am on "alice@alice.alice"'s page             # features/step_definitions/web_steps.rb:22
    And I press the "J" key somewhere                   # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 1 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post # features/step_definitions/keyboard_navigation_steps.rb:15
    When I press the "J" key somewhere                  # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 2 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post # features/step_definitions/keyboard_navigation_steps.rb:15

  Scenario: navigate downwards on a small screen        # features/desktop/keyboard_navigation.feature:64
    When I resize my window to 800x600                  # features/step_definitions/custom_web_steps.rb:218
    And I press the "J" key somewhere                   # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 1 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post # features/step_definitions/keyboard_navigation_steps.rb:15
    When I press the "J" key somewhere                  # features/step_definitions/keyboard_navigation_steps.rb:1
    Then post 2 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I should have navigated to the highlighted post # features/step_definitions/keyboard_navigation_steps.rb:15
    Given I expand the publisher                        # features/step_definitions/custom_web_steps.rb:63
    When I press the "J" key in the publisher           # features/step_definitions/keyboard_navigation_steps.rb:7
    Then post 2 should be highlighted                   # features/step_definitions/keyboard_navigation_steps.rb:11
    And I close the publisher                           # features/step_definitions/custom_web_steps.rb:67

@javascript
Feature: Liking posts
  In order to show my appreciation
  As a friendly person
  I want to like their posts

  Background:                                                                 # features/desktop/likes.feature:7
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And "bob@bob.bob" has a public post with text "I like unicorns"           # features/step_definitions/posts_steps.rb:43
    And I sign in as "alice@alice.alice"                                      # features/step_definitions/session_steps.rb:18

  Scenario: Liking and unliking a post from the stream                           # features/desktop/likes.feature:16
    Then I should not have activated notifications for the post                  # features/step_definitions/notifications_steps.rb:9
    When I like the post "I like unicorns" in the stream                         # features/step_definitions/stream_steps.rb:1
    Then I should see "Unlike" within ".stream-element .feedback"                # features/step_definitions/web_steps.rb:98
    And I should see a ".likes .media" within "#main_stream .stream-element"     # features/step_definitions/custom_web_steps.rb:177
    And I should have activated notifications for the post                       # features/step_definitions/notifications_steps.rb:9
    When I unlike the post "I like unicorns" in the stream                       # features/step_definitions/stream_steps.rb:1
    Then I should see "Like" within ".stream-element .feedback"                  # features/step_definitions/web_steps.rb:98
    And I should not see a ".likes .media" within "#main_stream .stream-element" # features/step_definitions/custom_web_steps.rb:183

  Scenario: Liking and unliking a post from a single post page                          # features/desktop/likes.feature:28
    When I open the show page of the "I like unicorns" post                             # features/step_definitions/posts_steps.rb:125
    Then I should not have activated notifications for the post in the single post view # features/step_definitions/notifications_steps.rb:9
    When I click to like the post                                                       # features/step_definitions/single_post_view_steps.rb:17
    Then I should see a ".count" within "#single-post-interactions"                     # features/step_definitions/custom_web_steps.rb:177
    And I should have activated notifications for the post in the single post view      # features/step_definitions/notifications_steps.rb:9
    When I click to unlike the post                                                     # features/step_definitions/single_post_view_steps.rb:17
    Then I should not see a ".count" within "#single-post-interactions"                 # features/step_definitions/custom_web_steps.rb:183

  Scenario: Someone likes my post                                      # features/desktop/likes.feature:38
    When I like the post "I like unicorns" in the stream               # features/step_definitions/stream_steps.rb:1
    And I sign out                                                     # features/step_definitions/session_steps.rb:55
    And I sign in as "bob@bob.bob"                                     # features/step_definitions/session_steps.rb:18
    Then I should see a ".likes" within "#main_stream .stream-element" # features/step_definitions/custom_web_steps.rb:177

@javascript
Feature: Browsing Diaspora as a logged out user
    In order to view public diaspora content
    as a random internet user
    I want to view public pages

  Background:                                                    # features/desktop/logged_out_browsing.feature:7
    Given a user named "Bob Jones" with email "bob@bob.bob"      # features/step_definitions/user_steps.rb:17
    And "bob@bob.bob" has a public post with text "public stuff" # features/step_definitions/posts_steps.rb:43
    And I log out                                                # features/step_definitions/session_steps.rb:55

  Scenario: Visiting a profile page                  # features/desktop/logged_out_browsing.feature:12
    When I am on "bob@bob.bob"'s page                # features/step_definitions/web_steps.rb:22
    Then I should see "public stuff" within "body"   # features/step_definitions/web_steps.rb:98
    And page should not have ".media .control-icons" # features/step_definitions/custom_web_steps.rb:189

  Scenario: Visiting a post show page              # features/desktop/logged_out_browsing.feature:17
    When I view "bob@bob.bob"'s first post         # features/step_definitions/user_steps.rb:212
    Then I should see "public stuff" within "body" # features/step_definitions/web_steps.rb:98

  Scenario: Visiting a non-public post                                       # features/desktop/logged_out_browsing.feature:21
    Given "bob@bob.bob" has a non public post with text "my darkest secrets" # features/step_definitions/posts_steps.rb:73
    When I open the show page of the "my darkest secrets" post               # features/step_definitions/posts_steps.rb:125
    Then I should not see "my darkest secrets"                               # features/step_definitions/web_steps.rb:113
    When I sign in as "bob@bob.bob"                                          # features/step_definitions/session_steps.rb:18
    Then I should see "my darkest secrets" within "#single-post-content"     # features/step_definitions/web_steps.rb:98

@javascript
Feature: user authentication

  Scenario: user logs in                                     # features/desktop/logs_in_and_out.feature:4
    Given a user with username "ohai" and password "secret"  # features/step_definitions/user_steps.rb:1
    When I sign in manually as "ohai" with password "secret" # features/step_definitions/session_steps.rb:10
    Then I should be on the stream page                      # features/step_definitions/web_steps.rb:174

  Scenario: user logs out                         # features/desktop/logs_in_and_out.feature:9
    Given I am signed in                          # features/step_definitions/session_steps.rb:1
    And I click on my name in the header          # features/step_definitions/custom_web_steps.rb:53
    And I follow "Log out"                        # features/step_definitions/web_steps.rb:36
    Then I should be on the new user session page # features/step_definitions/web_steps.rb:174

@aspects @javascript
Feature: User manages contacts
  In order to share with a limited group
  As a User
  I want to create new aspects

  Scenario: creating an aspect from contacts index                             # features/desktop/manages_aspects.feature:7
    Given I am signed in                                                       # features/step_definitions/session_steps.rb:1
    And I am on the contacts page                                              # features/step_definitions/web_steps.rb:22
    And I follow "Add an aspect"                                               # features/step_definitions/web_steps.rb:36
    And I fill in "aspect_name" with "Dorm Mates" in the aspect creation modal # features/step_definitions/aspects_steps.rb:88
    And I click on selector ".btn-primary" in the aspect creation modal        # features/step_definitions/aspects_steps.rb:88
    Then I should see "Dorm Mates" within "#aspect_nav"                        # features/step_definitions/web_steps.rb:98

  Scenario: creating an aspect from homepage                               # features/desktop/manages_aspects.feature:15
    Given I am signed in                                                   # features/step_definitions/session_steps.rb:1
    And I go to the aspects page                                           # features/step_definitions/web_steps.rb:26
    When I follow "Add an aspect"                                          # features/step_definitions/web_steps.rb:36
    And I fill in "aspect_name" with "losers" in the aspect creation modal # features/step_definitions/aspects_steps.rb:88
    And I click on selector ".btn-primary" in the aspect creation modal    # features/step_definitions/aspects_steps.rb:88
    Then I should be on the contacts page                                  # features/step_definitions/web_steps.rb:174
    And I should see "losers" within "#aspect_nav"                         # features/step_definitions/web_steps.rb:98

  Scenario: deleting an aspect from contacts index                     # features/desktop/manages_aspects.feature:24
    Given I am signed in                                               # features/step_definitions/session_steps.rb:1
    And I have an aspect called "People"                               # features/step_definitions/user_steps.rb:65
    When I am on the contacts page                                     # features/step_definitions/web_steps.rb:22
    And I follow "People"                                              # features/step_definitions/web_steps.rb:36
    And I confirm the alert after I click on selector "#delete_aspect" # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the contacts page                              # features/step_definitions/web_steps.rb:174
    And I should not see "People" within "#aspect_nav"                 # features/step_definitions/web_steps.rb:113

  Scenario: deleting an aspect from homepage                           # features/desktop/manages_aspects.feature:33
    Given I am signed in                                               # features/step_definitions/session_steps.rb:1
    And I have an aspect called "People"                               # features/step_definitions/user_steps.rb:65
    When I am on the aspects page                                      # features/step_definitions/web_steps.rb:22
    And I click on "People" aspect edit icon                           # features/step_definitions/aspects_steps.rb:39
    And I confirm the alert after I click on selector "#delete_aspect" # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the contacts page                              # features/step_definitions/web_steps.rb:174
    And I should not see "People" within "#aspect_nav"                 # features/step_definitions/web_steps.rb:113

  Scenario: Editing the aspect memberships of a contact from the contacts page # features/desktop/manages_aspects.feature:42
    Given I am signed in                                                       # features/step_definitions/session_steps.rb:1
    And I have 2 contacts                                                      # features/step_definitions/user_steps.rb:187
    And I have an aspect called "Cat People"                                   # features/step_definitions/user_steps.rb:65
    When I am on the contacts page                                             # features/step_definitions/web_steps.rb:22
    And I follow "Cat People"                                                  # features/step_definitions/web_steps.rb:36
DEPRECATED: #parent is deprecated in favor of #query_scope - Note: #parent was not the elements parent in the document so it's most likely not what you wanted anyway
    And I add the first person to the aspect                                   # features/step_definitions/aspects_steps.rb:69
    Then I should have 1 contact in "Cat People"                               # features/step_definitions/user_steps.rb:125
DEPRECATED: #parent is deprecated in favor of #query_scope - Note: #parent was not the elements parent in the document so it's most likely not what you wanted anyway
    When I remove the first person from the aspect                             # features/step_definitions/aspects_steps.rb:76
    Then I should have 0 contacts in "Cat People"                              # features/step_definitions/user_steps.rb:125

  Scenario: Renaming an aspect                               # features/desktop/manages_aspects.feature:54
    Given I am signed in                                     # features/step_definitions/session_steps.rb:1
    And I have an aspect called "Cat People"                 # features/step_definitions/user_steps.rb:65
    When I am on the contacts page                           # features/step_definitions/web_steps.rb:22
    And I follow "Cat People"                                # features/step_definitions/web_steps.rb:36
    And I click on selector "#change_aspect_name"            # features/step_definitions/custom_web_steps.rb:131
    And I fill in "aspect_name" with "Unicorn People"        # features/step_definitions/web_steps.rb:42
    And I press "Update"                                     # features/step_definitions/web_steps.rb:30
    Then I should see "Unicorn People" within "#aspect_name" # features/step_definitions/web_steps.rb:98

  Scenario: sorting the aspects                 # features/desktop/manages_aspects.feature:64
    Given I am signed in                        # features/step_definitions/session_steps.rb:1
    And I have an aspect called "People"        # features/step_definitions/user_steps.rb:65
    And I have an aspect called "Cat People"    # features/step_definitions/user_steps.rb:65
    When I am on the contacts page              # features/step_definitions/web_steps.rb:22
    And I have turned off jQuery effects        # features/step_definitions/custom_web_steps.rb:193
    And I drag "Cat People" up                  # features/step_definitions/aspects_steps.rb:94
    Then I should see "Cat People" as 2. aspect # features/step_definitions/aspects_steps.rb:126
    And I should see "People" as 3. aspect      # features/step_definitions/aspects_steps.rb:126
    When I go to the contacts page              # features/step_definitions/web_steps.rb:26
    Then I should see "Cat People" as 2. aspect # features/step_definitions/aspects_steps.rb:126
    And I should see "People" as 3. aspect      # features/step_definitions/aspects_steps.rb:126

@javascript
Feature: Mentions
  As user
  I want to mention another user and have a link to them
  To show people that this person exsists.

  Scenario: A user mentions another user and it displays correctly            # features/desktop/mentions.feature:7
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And Alice has a post mentioning Bob                                       # features/step_definitions/mention_steps.rb:1
    When I sign in as "alice@alice.alice"                                     # features/step_definitions/session_steps.rb:18
    And I follow "Bob Jones"                                                  # features/step_definitions/web_steps.rb:36
    Then I should see "Bob Jones"                                             # features/step_definitions/web_steps.rb:98

  Scenario: A user mentions another user at the end of a post                 # features/desktop/mentions.feature:18
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    When I sign in as "alice@alice.alice"                                     # features/step_definitions/session_steps.rb:18
    And I expand the publisher                                                # features/step_definitions/custom_web_steps.rb:63
    And I append "@Bob" to the publisher                                      # features/step_definitions/posts_steps.rb:117
    And I click on the first user in the mentions dropdown list               # features/step_definitions/mention_steps.rb:22
    And I press "Share"                                                       # features/step_definitions/web_steps.rb:30
    Then I should see "Bob Jones" within ".stream-element"                    # features/step_definitions/web_steps.rb:98
    When I follow "Bob Jones"                                                 # features/step_definitions/web_steps.rb:36
    Then I should see "Bob Jones"                                             # features/step_definitions/web_steps.rb:98

  Scenario: A user tries to mention another user multiple times               # features/desktop/mentions.feature:33
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    When I sign in as "alice@alice.alice"                                     # features/step_definitions/session_steps.rb:18
    And I expand the publisher                                                # features/step_definitions/custom_web_steps.rb:63
    And I append "@Bob" to the publisher                                      # features/step_definitions/posts_steps.rb:117
    Then I should see "Bob Jones" within ".tt-suggestion"                     # features/step_definitions/web_steps.rb:98
    When I click on the first user in the mentions dropdown list              # features/step_definitions/mention_steps.rb:22
    When I press the "A" key in the publisher                                 # features/step_definitions/keyboard_navigation_steps.rb:7
    And I append "@Bob" to the publisher                                      # features/step_definitions/posts_steps.rb:117
    Then I should not see the mentions dropdown list                          # features/step_definitions/mention_steps.rb:26
    When I press "Share"                                                      # features/step_definitions/web_steps.rb:30
    Then I should see "Bob Jones" within ".stream-element"                    # features/step_definitions/web_steps.rb:98
    When I expand the publisher                                               # features/step_definitions/custom_web_steps.rb:63
    And I append "@Bob" to the publisher                                      # features/step_definitions/posts_steps.rb:117
    And I click on the first user in the mentions dropdown list               # features/step_definitions/mention_steps.rb:22
    And I press "Share"                                                       # features/step_definitions/web_steps.rb:30
    Then I should see "Bob Jones" within ".stream-element"                    # features/step_definitions/web_steps.rb:98
    When I follow "Bob Jones"                                                 # features/step_definitions/web_steps.rb:36
    Then I should see "Bob Jones"                                             # features/step_definitions/web_steps.rb:98

  Scenario: A user mentions another user in a comment and it displays correctly         # features/desktop/mentions.feature:58
    Given following users exist:                                                        # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice"           # features/step_definitions/user_steps.rb:82
    And "alice@alice.alice" has a public post with text "check this out!"               # features/step_definitions/posts_steps.rb:43
    And "alice@alice.alice" has commented mentioning "bob@bob.bob" on "check this out!" # features/step_definitions/comment_steps.rb:24
    When I sign in as "alice@alice.alice"                                               # features/step_definitions/session_steps.rb:18
    And I follow "Bob Jones"                                                            # features/step_definitions/web_steps.rb:36
    Then I should see "Bob Jones"                                                       # features/step_definitions/web_steps.rb:98

  Scenario: A user mentions another user in a comment using mention suggestions # features/desktop/mentions.feature:70
    Given following users exist:                                                # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice"   # features/step_definitions/user_steps.rb:82
    And "alice@alice.alice" has a public post with text "check this out!"       # features/step_definitions/posts_steps.rb:43
    When I sign in as "alice@alice.alice"                                       # features/step_definitions/session_steps.rb:18
    Then I should see "check this out!"                                         # features/step_definitions/web_steps.rb:98
    When I focus the comment field                                              # features/step_definitions/comment_steps.rb:1
    And I enter "@Bob" in the comment field                                     # features/step_definitions/comment_steps.rb:42
    Then I should see "Bob Jones" within ".tt-suggestion"                       # features/step_definitions/web_steps.rb:98
    When I click on the first user in the mentions dropdown list                # features/step_definitions/mention_steps.rb:22
    And I press the "A" key in the publisher                                    # features/step_definitions/keyboard_navigation_steps.rb:7
    And I append "@Bob" to the publisher                                        # features/step_definitions/posts_steps.rb:117
    Then I should not see the mentions dropdown list                            # features/step_definitions/mention_steps.rb:26
    When I press "Comment"                                                      # features/step_definitions/web_steps.rb:30
    Then I should see "Bob Jones" within ".comments .comment:last-child"        # features/step_definitions/web_steps.rb:98

@javascript
Feature: mentioning a contact from their profile page
    In order to enlighten humanity for the good of society
    As a rock star
    I want to mention someone more cool than the average bear

  Background:                                                                        # features/desktop/mentions_from_profile_page.feature:7
    Given following users exist:                                                     # features/step_definitions/user_steps.rb:29
      | username |
      | bob      |
      | alice    |
    And a user with username "bob" is connected with "alice"                         # features/step_definitions/user_steps.rb:88
    And I sign in as "bob@bob.bob"                                                   # features/step_definitions/session_steps.rb:18
    And I have following aspects:                                                    # features/step_definitions/user_steps.rb:70
      | PostingTo            |
      | NotPostingThingsHere |
    And I have user with username "alice" in an aspect called "PostingTo"            # features/step_definitions/user_steps.rb:76
    And I have user with username "alice" in an aspect called "NotPostingThingsHere" # features/step_definitions/user_steps.rb:76
    And I go to the home page                                                        # features/step_definitions/web_steps.rb:26

  Scenario: mentioning while posting to all aspects                           # features/desktop/mentions_from_profile_page.feature:22
    Given I am on "alice@alice.alice"'s page                                  # features/step_definitions/web_steps.rb:22
    And I want to mention her from the profile                                # features/step_definitions/custom_web_steps.rb:79
    And I append "I am eating a yogurt" to the publisher in the mention modal # features/step_definitions/custom_web_steps.rb:159
    And I press "Share" in the mention modal                                  # features/step_definitions/custom_web_steps.rb:159
    Then I should see a flash message indicating success                      # features/step_definitions/custom_web_steps.rb:243
    When I am on the aspects page                                             # features/step_definitions/web_steps.rb:22
    And I follow "PostingTo" within "#aspects_list"                           # features/step_definitions/web_steps.rb:36
    Then I should see "I am eating a yogurt"                                  # features/step_definitions/web_steps.rb:98
    When I am on the aspects page                                             # features/step_definitions/web_steps.rb:22
    And I follow "NotPostingThingsHere" within "#aspects_list"                # features/step_definitions/web_steps.rb:36
    Then I should see "I am eating a yogurt"                                  # features/step_definitions/web_steps.rb:98

  Scenario: mentioning while posting to just one aspect                       # features/desktop/mentions_from_profile_page.feature:36
    Given I am on "alice@alice.alice"'s page                                  # features/step_definitions/web_steps.rb:22
    And I want to mention her from the profile                                # features/step_definitions/custom_web_steps.rb:79
    And I append "I am eating a yogurt" to the publisher in the mention modal # features/step_definitions/custom_web_steps.rb:159
    And I press the aspect dropdown in the mention modal                      # features/step_definitions/custom_web_steps.rb:159
    And I toggle the aspect "NotPostingThingsHere" in the mention modal       # features/step_definitions/custom_web_steps.rb:159
    And I press the aspect dropdown in the mention modal                      # features/step_definitions/custom_web_steps.rb:159
    And I press "Share" in the mention modal                                  # features/step_definitions/custom_web_steps.rb:159
    Then I should see a flash message indicating success                      # features/step_definitions/custom_web_steps.rb:243
    When I am on the aspects page                                             # features/step_definitions/web_steps.rb:22
    And I select only "PostingTo" aspect                                      # features/step_definitions/aspects_steps.rb:47
    Then I should see "I am eating a yogurt"                                  # features/step_definitions/web_steps.rb:98
    When I am on the aspects page                                             # features/step_definitions/web_steps.rb:22
    And I select all aspects                                                  # features/step_definitions/aspects_steps.rb:63
    And I select only "NotPostingThingsHere" aspect                           # features/step_definitions/aspects_steps.rb:47
    Then I should not see "I am eating a yogurt"                              # features/step_definitions/web_steps.rb:113

@javascript
Feature: Not safe for work

  Scenario: Setting not safe for work                      # features/desktop/not_safe_for_work.feature:4
    Given following users exist:                           # features/step_definitions/user_steps.rb:29
      | username  | email          |
      | pr0n king | tommy@pr0n.xxx |
    And I sign in as "tommy@pr0n.xxx"                      # features/step_definitions/session_steps.rb:18
    When I go to the edit profile page                     # features/step_definitions/web_steps.rb:26
    And I mark myself as not safe for work                 # features/step_definitions/profile_steps.rb:1
    And I submit the form                                  # features/step_definitions/custom_web_steps.rb:59
    Then I should be on the edit profile page              # features/step_definitions/web_steps.rb:174
    And the "profile[nsfw]" checkbox should be checked     # features/step_definitions/web_steps.rb:144
    When I go to the edit profile page                     # features/step_definitions/web_steps.rb:26
    And I mark myself as safe for work                     # features/step_definitions/profile_steps.rb:5
    And I submit the form                                  # features/step_definitions/custom_web_steps.rb:59
    Then I should be on the edit profile page              # features/step_definitions/web_steps.rb:174
    And the "profile[nsfw]" checkbox should not be checked # features/step_definitions/web_steps.rb:150

  Scenario: Toggling nsfw state                                                            # features/desktop/not_safe_for_work.feature:20
      #Nsfw users posts are marked nsfw
    Given a nsfw user with email "tommy@pr0nking.com"                                      # features/step_definitions/user_steps.rb:23
    And a user with email "laura@officeworkers.com"                                        # features/step_definitions/user_steps.rb:9
    And a user with email "laura@officeworkers.com" is connected with "tommy@pr0nking.com" # features/step_definitions/user_steps.rb:82
    And "tommy@pr0nking.com" has a public post with text "I love 0bj3ction4bl3 c0nt3nt!"   # features/step_definitions/posts_steps.rb:43
    And "tommy@pr0nking.com" has a public post with text "Sexy Senators Gone Wild!"        # features/step_definitions/posts_steps.rb:43
      #toggling global nsfw state
    When I sign in as "laura@officeworkers.com"                                            # features/step_definitions/session_steps.rb:18
    Then I should not see "I love 0bj3ction4bl3 c0nt3nt!"                                  # features/step_definitions/web_steps.rb:113
    When I toggle nsfw posts                                                               # features/step_definitions/stream_steps.rb:13
    Then I should see "I love 0bj3ction4bl3 c0nt3nt!" and "Sexy Senators Gone Wild!"       # features/step_definitions/web_steps.rb:98
      #hiding
    When I toggle nsfw posts                                                               # features/step_definitions/stream_steps.rb:13
    Then I should not see "I love 0bj3ction4bl3 c0nt3nt!" and "Sexy Senators Gone Wild!"   # features/step_definitions/web_steps.rb:113

  Scenario: Resharing a nsfw post                                                          # features/desktop/not_safe_for_work.feature:38
    Given a nsfw user with email "tommy@pr0nking.com"                                      # features/step_definitions/user_steps.rb:23
    And a user with email "laura@officeworkers.com"                                        # features/step_definitions/user_steps.rb:9
    And a user with email "laura@officeworkers.com" is connected with "tommy@pr0nking.com" # features/step_definitions/user_steps.rb:82
    And "tommy@pr0nking.com" has a public post with text "Sexy Senators Gone Wild!"        # features/step_definitions/posts_steps.rb:43
    And I sign in as "laura@officeworkers.com"                                             # features/step_definitions/session_steps.rb:18
    And I toggle nsfw posts                                                                # features/step_definitions/stream_steps.rb:13
    And I confirm the alert after I follow "Reshare"                                       # features/step_definitions/custom_web_steps.rb:139
    And I go to the home page                                                              # features/step_definitions/web_steps.rb:26
    Then I should not see "Sexy Senators Gone Wild!"                                       # features/step_definitions/web_steps.rb:113
    And I should have 2 nsfw posts                                                         # features/step_definitions/stream_steps.rb:21

@javascript
Feature: Notifications
  In order to see what is happening
  As a User
  I want to get notifications

  Background:                   # features/desktop/notifications.feature:7
    Given That following users: # features/step_definitions/user_steps.rb:29
      | email             |
      | bob@bob.bob       |
      | alice@alice.alice |
      | carol@carol.carol |

  Scenario: someone shares with me                   # features/desktop/notifications.feature:14
    When I sign in as "bob@bob.bob"                  # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page           # features/step_definitions/web_steps.rb:22
    And I add the person to my "Besties" aspect      # features/step_definitions/user_steps.rb:129
    And I sign out                                   # features/step_definitions/session_steps.rb:55
    When I sign in as "alice@alice.alice"            # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header       # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible # features/step_definitions/notifications_steps.rb:32
    Then I should see "started sharing with you"     # features/step_definitions/web_steps.rb:98
    And I go to the notifications page               # features/step_definitions/web_steps.rb:26
    Then I should see "started sharing with you"     # features/step_definitions/web_steps.rb:98
    And I should have 1 email delivery               # features/step_definitions/user_steps.rb:159

  Scenario: someone re-shares my post                                           # features/desktop/notifications.feature:27
    Given a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And "alice@alice.alice" has a public post with text "check this out!"       # features/step_definitions/posts_steps.rb:43
    When I sign in as "bob@bob.bob"                                             # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page                                      # features/step_definitions/web_steps.rb:22
    And I confirm the alert after I follow "Reshare"                            # features/step_definitions/custom_web_steps.rb:139
    And I sign out                                                              # features/step_definitions/session_steps.rb:55
    When I sign in as "alice@alice.alice"                                       # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                  # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                            # features/step_definitions/notifications_steps.rb:32
    Then I should see "reshared your post"                                      # features/step_definitions/web_steps.rb:98
    And I should have 1 email delivery                                          # features/step_definitions/user_steps.rb:159

  Scenario: someone likes my post                                               # features/desktop/notifications.feature:40
    Given a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And "alice@alice.alice" has a public post with text "check this out!"       # features/step_definitions/posts_steps.rb:43
    When I sign in as "bob@bob.bob"                                             # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page                                      # features/step_definitions/web_steps.rb:22
    And I follow "Like"                                                         # features/step_definitions/web_steps.rb:36
    And I sign out                                                              # features/step_definitions/session_steps.rb:55
    When I sign in as "alice@alice.alice"                                       # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                  # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                            # features/step_definitions/notifications_steps.rb:32
    Then I should see "liked your post"                                         # features/step_definitions/web_steps.rb:98
    And I should have 1 email delivery                                          # features/step_definitions/user_steps.rb:159

  Scenario: someone comments on my post                                         # features/desktop/notifications.feature:53
    Given a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And "alice@alice.alice" has a public post with text "check this out!"       # features/step_definitions/posts_steps.rb:43
    And "bob@bob.bob" has commented "great post!" on "check this out!"          # features/step_definitions/comment_steps.rb:18
    When I sign in as "alice@alice.alice"                                       # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                  # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                            # features/step_definitions/notifications_steps.rb:32
    Then I should see "commented on your post"                                  # features/step_definitions/web_steps.rb:98
    And I should have 1 email delivery                                          # features/step_definitions/user_steps.rb:159

  Scenario: unconnected user comments in reply to comment by another user who commented a post of someone who she shares with # features/desktop/notifications.feature:63
    Given "alice@alice.alice" has a public post with text "check this out!"                                                   # features/step_definitions/posts_steps.rb:43
    And "bob@bob.bob" has commented "great post, alice!" on "check this out!"                                                 # features/step_definitions/comment_steps.rb:18
    And "carol@carol.carol" has commented "great comment, bob!" on "check this out!"                                          # features/step_definitions/comment_steps.rb:18
    When I sign in as "bob@bob.bob"                                                                                           # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                                                                # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                                                                          # features/step_definitions/notifications_steps.rb:32
    And I should see "also commented on"                                                                                      # features/step_definitions/web_steps.rb:98
    And I should have 3 email delivery                                                                                        # features/step_definitions/user_steps.rb:159

  Scenario: unconnected user comments in reply to my comment to her post               # features/desktop/notifications.feature:74
    Given "alice@alice.alice" has a public post with text "check this out!"            # features/step_definitions/posts_steps.rb:43
    And "carol@carol.carol" has commented "great post, alice!" on "check this out!"    # features/step_definitions/comment_steps.rb:18
    And "alice@alice.alice" has commented "great comment, carol!" on "check this out!" # features/step_definitions/comment_steps.rb:18
    When I sign in as "carol@carol.carol"                                              # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                         # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                                   # features/step_definitions/notifications_steps.rb:32
    And I should see "also commented on"                                               # features/step_definitions/web_steps.rb:98
    And I should have 2 email delivery                                                 # features/step_definitions/user_steps.rb:159

  Scenario: connected user comments in reply to my comment to an unconnected user's post # features/desktop/notifications.feature:84
    Given "alice@alice.alice" has a public post with text "check this out!"              # features/step_definitions/posts_steps.rb:43
    And a user with email "bob@bob.bob" is connected with "carol@carol.carol"            # features/step_definitions/user_steps.rb:82
    And "carol@carol.carol" has commented "great post, alice!" on "check this out!"      # features/step_definitions/comment_steps.rb:18
    And "bob@bob.bob" has commented "great post!" on "check this out!"                   # features/step_definitions/comment_steps.rb:18
    When I sign in as "carol@carol.carol"                                                # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                           # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                                     # features/step_definitions/notifications_steps.rb:32
    And I should see "also commented on"                                                 # features/step_definitions/web_steps.rb:98
    And I should have 3 email delivery                                                   # features/step_definitions/user_steps.rb:159

  Scenario: someone mentioned me in their post                                  # features/desktop/notifications.feature:95
    Given a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And Alice has a post mentioning Bob                                         # features/step_definitions/mention_steps.rb:1
    When I sign in as "bob@bob.bob"                                             # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                  # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                            # features/step_definitions/notifications_steps.rb:32
    Then I should see "mentioned you in the post"                               # features/step_definitions/web_steps.rb:98
    And I should have 1 email delivery                                          # features/step_definitions/user_steps.rb:159

  Scenario: someone mentioned me in a comment                                           # features/desktop/notifications.feature:104
    Given "alice@alice.alice" has a public post with text "check this out!"             # features/step_definitions/posts_steps.rb:43
    And "bob@bob.bob" has commented mentioning "alice@alice.alice" on "check this out!" # features/step_definitions/comment_steps.rb:24
    When I sign in as "alice@alice.alice"                                               # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                          # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                                    # features/step_definitions/notifications_steps.rb:32
    And I should see "mentioned you in a comment"                                       # features/step_definitions/web_steps.rb:98
    And I should have 1 email delivery                                                  # features/step_definitions/user_steps.rb:159

  Scenario: I mark a notification as read                                       # features/desktop/notifications.feature:113
    Given a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And Alice has a post mentioning Bob                                         # features/step_definitions/mention_steps.rb:1
    When I sign in as "bob@bob.bob"                                             # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                  # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                            # features/step_definitions/notifications_steps.rb:32
    And I wait for notifications to load                                        # features/step_definitions/notifications_steps.rb:20
    And I should see a ".unread .unread-toggle .entypo-eye"                     # features/step_definitions/custom_web_steps.rb:177
    When I click on selector ".unread .unread-toggle .entypo-eye"               # features/step_definitions/custom_web_steps.rb:131
    Then I should see a ".read .unread-toggle"                                  # features/step_definitions/custom_web_steps.rb:177

  Scenario: filter notifications                                                # features/desktop/notifications.feature:124
    Given a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And Alice has a post mentioning Bob                                         # features/step_definitions/mention_steps.rb:1
    When I sign in as "bob@bob.bob"                                             # features/step_definitions/session_steps.rb:18
    And I am on the notifications page                                          # features/step_definitions/web_steps.rb:22
    Then I should see "mentioned you in the post"                               # features/step_definitions/web_steps.rb:98
    When I filter notifications by likes                                        # features/step_definitions/notifications_steps.rb:1
    Then I should not see "mentioned you in the post"                           # features/step_definitions/web_steps.rb:113
    When I filter notifications by mentions                                     # features/step_definitions/notifications_steps.rb:5
    Then I should see "mentioned you in the post"                               # features/step_definitions/web_steps.rb:98

  Scenario: show hovercard in notification dropdown from the profile edit page # features/desktop/notifications.feature:135
    When I sign in as "bob@bob.bob"                                            # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page                                     # features/step_definitions/web_steps.rb:22
    And I add the person to my "Besties" aspect                                # features/step_definitions/user_steps.rb:129
    And I sign out                                                             # features/step_definitions/session_steps.rb:55
    When I sign in as "alice@alice.alice"                                      # features/step_definitions/session_steps.rb:18
    And I go to the edit profile page                                          # features/step_definitions/web_steps.rb:26
    And I follow "Notifications" in the header                                 # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                           # features/step_definitions/notifications_steps.rb:32
    When I wait for notifications to load                                      # features/step_definitions/notifications_steps.rb:20
    And I activate the first hovercard in the notification dropdown            # features/step_definitions/notifications_steps.rb:44
    And I press the aspect dropdown                                            # features/step_definitions/aspects_steps.rb:84
    Then the aspect dropdown should be visible                                 # features/step_definitions/aspects_steps.rb:122

  Scenario: show hovercard in notification dropdown from the stream # features/desktop/notifications.feature:149
    When I sign in as "bob@bob.bob"                                 # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page                          # features/step_definitions/web_steps.rb:22
    And I add the person to my "Besties" aspect                     # features/step_definitions/user_steps.rb:129
    And I sign out                                                  # features/step_definitions/session_steps.rb:55
    When I sign in as "alice@alice.alice"                           # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                      # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                # features/step_definitions/notifications_steps.rb:32
    When I wait for notifications to load                           # features/step_definitions/notifications_steps.rb:20
    And I activate the first hovercard in the notification dropdown # features/step_definitions/notifications_steps.rb:44
    And I press the aspect dropdown                                 # features/step_definitions/aspects_steps.rb:84
    Then the aspect dropdown should be visible                      # features/step_definitions/aspects_steps.rb:122

  Scenario: scrollbar shows up when >5 notifications                            # features/desktop/notifications.feature:162
    Given a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And Alice has 6 posts mentioning Bob                                        # features/step_definitions/mention_steps.rb:8
    When I sign in as "bob@bob.bob"                                             # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                  # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                            # features/step_definitions/notifications_steps.rb:32
    Then the notification dropdown scrollbar should be visible                  # features/step_definitions/notifications_steps.rb:36

  Scenario: dropdown will load more elements when bottom is reached             # features/desktop/notifications.feature:170
    Given a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And Alice has 20 posts mentioning Bob                                       # features/step_definitions/mention_steps.rb:8
    When I sign in as "bob@bob.bob"                                             # features/step_definitions/session_steps.rb:18
    And I follow "Notifications" in the header                                  # features/step_definitions/custom_web_steps.rb:53
    Then the notification dropdown should be visible                            # features/step_definitions/notifications_steps.rb:32
    Then the notification dropdown scrollbar should be visible                  # features/step_definitions/notifications_steps.rb:36
    When I wait for notifications to load                                       # features/step_definitions/notifications_steps.rb:20
    Then there should be 10 notifications loaded                                # features/step_definitions/notifications_steps.rb:40
    When I scroll down on the notifications dropdown                            # features/step_definitions/notifications_steps.rb:24
    Then the notification dropdown should load more notifications               # features/step_definitions/notifications_steps.rb:28
    When I wait for notifications to load                                       # features/step_definitions/notifications_steps.rb:20
    Then there should be 15 notifications loaded                                # features/step_definitions/notifications_steps.rb:40

@javascript
Feature: oembed
  In order to make videos easy accessible
  As a user
  I want the links in my posts be replaced by their oEmbed representation

  Background:                               # features/desktop/oembed.feature:7
    Given following user exists:            # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Alice Smith | alice@alice.alice |
    And I have several oEmbed data in cache # features/step_definitions/oembed_steps.rb:1
    And I sign in as "alice@alice.alice"    # features/step_definitions/session_steps.rb:18

  Scenario: Post a secure video link                                                         # features/desktop/oembed.feature:14
    Given I expand the publisher                                                             # features/step_definitions/custom_web_steps.rb:63
    When I click the publisher and post "http://youtube.com/watch?v=M3r2XDceM6A&format=json" # features/step_definitions/posts_steps.rb:101
    Then I should see a video player                                                         # features/step_definitions/oembed_steps.rb:125

  Scenario: Post an unsecure video link                                                           # features/desktop/oembed.feature:19
    Given I expand the publisher                                                                  # features/step_definitions/custom_web_steps.rb:63
    When I click the publisher and post "http://mytube.com/watch?v=M3r2XDceM6A&format=json"       # features/step_definitions/posts_steps.rb:101
    And I follow "My aspects"                                                                     # features/step_definitions/web_steps.rb:36
    Then I should not see a video player                                                          # features/step_definitions/oembed_steps.rb:131
    And I should see "http://mytube.com/watch?v=M3r2XDceM6A&format=json" within ".stream-element" # features/step_definitions/web_steps.rb:98

  Scenario: Post an unsecure rich-typed link                                                          # features/desktop/oembed.feature:26
    Given I expand the publisher                                                                      # features/step_definitions/custom_web_steps.rb:63
    When I click the publisher and post "http://myrichtube.com/watch?v=M3r2XDceM6A&format=json"       # features/step_definitions/posts_steps.rb:101
    And I follow "My aspects"                                                                         # features/step_definitions/web_steps.rb:36
    Then I should not see a video player                                                              # features/step_definitions/oembed_steps.rb:131
    And I should see "http://myrichtube.com/watch?v=M3r2XDceM6A&format=json" within ".stream-element" # features/step_definitions/web_steps.rb:98

  Scenario: Post a photo link                                                                             # features/desktop/oembed.feature:33
    Given I expand the publisher                                                                          # features/step_definitions/custom_web_steps.rb:63
    When I click the publisher and post "http://farm4.static.flickr.com/3123/2341623661_7c99f48bbf_m.jpg" # features/step_definitions/posts_steps.rb:101
    And I follow "My aspects"                                                                             # features/step_definitions/web_steps.rb:36
    Then I should see a "img" within ".stream-element"                                                    # features/step_definitions/custom_web_steps.rb:177

  Scenario: Post an unsupported text link                                                           # features/desktop/oembed.feature:39
    Given I expand the publisher                                                                    # features/step_definitions/custom_web_steps.rb:63
    When I click the publisher and post "http://www.we-do-not-support-oembed.com/index.html"        # features/step_definitions/posts_steps.rb:101
    And I follow "My aspects"                                                                       # features/step_definitions/web_steps.rb:36
    Then I should see "http://www.we-do-not-support-oembed.com/index.html" within ".stream-element" # features/step_definitions/web_steps.rb:98

@javascript
Feature: Access protected resources using auth code flow

  Background:                         # features/desktop/oidc_auth_code_flow.feature:3
    Given a user with username "kent" # features/step_definitions/user_steps.rb:13

  Scenario: Invalid client id to auth endpoint                                                                   # features/desktop/oidc_auth_code_flow.feature:6
    When I register a new client                                                                                 # features/step_definitions/oidc_common_steps.rb:12
    And I send a post request from that client to the code flow authorization endpoint using a invalid client id # features/step_definitions/auth_code_steps.rb:17
    And I sign in as "kent@kent.kent"                                                                            # features/step_definitions/session_steps.rb:18
    Then I should see a message containing "Invalid client id or redirect uri"                                   # features/step_definitions/oidc_common_steps.rb:37

  Scenario: Application is denied authorization                                        # features/desktop/oidc_auth_code_flow.feature:12
    When I register a new client                                                       # features/step_definitions/oidc_common_steps.rb:12
    And I send a post request from that client to the code flow authorization endpoint # features/step_definitions/auth_code_steps.rb:9
    And I sign in as "kent@kent.kent"                                                  # features/step_definitions/session_steps.rb:18
    And I deny authorization to the client                                             # features/step_definitions/implicit_flow_steps.rb:43
    Then I should not see any tokens in the redirect url                               # features/step_definitions/implicit_flow_steps.rb:47

  Scenario: Application is authorized                                                  # features/desktop/oidc_auth_code_flow.feature:19
    When I register a new client                                                       # features/step_definitions/oidc_common_steps.rb:12
    And I send a post request from that client to the code flow authorization endpoint # features/step_definitions/auth_code_steps.rb:9
    And I sign in as "kent@kent.kent"                                                  # features/step_definitions/session_steps.rb:18
    And I give my consent and authorize the client                                     # features/step_definitions/implicit_flow_steps.rb:39
    And I parse the auth code and create a request to the token endpoint               # features/step_definitions/auth_code_steps.rb:22
    And I parse the tokens and use it obtain user info                                 # features/step_definitions/auth_code_steps.rb:31
    Then I should receive "kent"'s id, username, and email                             # features/step_definitions/oidc_common_steps.rb:25

@javascript
Feature: Access protected resources using implicit flow

  Background:                         # features/desktop/oidc_implicit_flow.feature:3
    Given a user with username "kent" # features/step_definitions/user_steps.rb:13

  Scenario: Invalid client id to auth endpoint                                                         # features/desktop/oidc_implicit_flow.feature:6
    When I register a new client                                                                       # features/step_definitions/oidc_common_steps.rb:12
    And I send a post request from that client to the authorization endpoint using a invalid client id # features/step_definitions/implicit_flow_steps.rb:35
    And I sign in as "kent@kent.kent"                                                                  # features/step_definitions/session_steps.rb:18
    Then I should see a message containing "Invalid client id or redirect uri"                         # features/step_definitions/oidc_common_steps.rb:37

  Scenario: Application is denied authorization                              # features/desktop/oidc_implicit_flow.feature:12
    When I register a new client                                             # features/step_definitions/oidc_common_steps.rb:12
    And I send a post request from that client to the authorization endpoint # features/step_definitions/implicit_flow_steps.rb:20
    And I sign in as "kent@kent.kent"                                        # features/step_definitions/session_steps.rb:18
    And I deny authorization to the client                                   # features/step_definitions/implicit_flow_steps.rb:43
    Then I should not see any tokens in the redirect url                     # features/step_definitions/implicit_flow_steps.rb:47

  Scenario: Application is authorized                                        # features/desktop/oidc_implicit_flow.feature:19
    When I register a new client                                             # features/step_definitions/oidc_common_steps.rb:12
    And I send a post request from that client to the authorization endpoint # features/step_definitions/implicit_flow_steps.rb:20
    And I sign in as "kent@kent.kent"                                        # features/step_definitions/session_steps.rb:18
    And I give my consent and authorize the client                           # features/step_definitions/implicit_flow_steps.rb:39
    And I parse the bearer tokens and use it to access user info             # features/step_definitions/implicit_flow_steps.rb:54
    Then I should receive "kent"'s id, username, and email                   # features/step_definitions/oidc_common_steps.rb:25

  Scenario: Application is authorized and uses small value for the max_age parameter      # features/desktop/oidc_implicit_flow.feature:27
    When I register a new client                                                          # features/step_definitions/oidc_common_steps.rb:12
    And I sign in as "kent@kent.kent"                                                     # features/step_definitions/session_steps.rb:18
    And I have signed in 5 minutes ago                                                    # features/step_definitions/implicit_flow_steps.rb:25
    And I send a post request from that client to the authorization endpoint with max age # features/step_definitions/implicit_flow_steps.rb:29
    And I sign in as "kent@kent.kent"                                                     # features/step_definitions/session_steps.rb:18
    And I give my consent and authorize the client                                        # features/step_definitions/implicit_flow_steps.rb:39
    And I parse the bearer tokens and use it to access user info                          # features/step_definitions/implicit_flow_steps.rb:54
    Then I should receive "kent"'s id, username, and email                                # features/step_definitions/oidc_common_steps.rb:25

@javascript
Feature: viewing the photo lightbox

  Background:                                                        # features/desktop/photo_gallery.feature:3
    Given a user with username "alice"                               # features/step_definitions/user_steps.rb:13
    And "alice@alice.alice" has posted a status message with a photo # features/step_definitions/user_steps.rb:169
    And I sign in as "alice@alice.alice"                             # features/step_definitions/session_steps.rb:18

  Scenario: viewing a photo              # features/desktop/photo_gallery.feature:8
    When I press the attached image      # features/step_definitions/custom_web_steps.rb:226
    Then I should see the photo lightbox # features/step_definitions/gallery_steps.rb:1

  Scenario: closing the lightbox by clicking the close link # features/desktop/photo_gallery.feature:12
    When I press the attached image                         # features/step_definitions/custom_web_steps.rb:226
    And I press the close lightbox link                     # features/step_definitions/gallery_steps.rb:9
    Then I should not see the photo lightbox                # features/step_definitions/gallery_steps.rb:5

@javascript
Feature: preview posts in the stream
    In order to test markdown without posting
    As a user
    I want to see a preview of my posts in the stream

  Background:                                                                 # features/desktop/post_preview.feature:7
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    When I sign in as "bob@bob.bob"                                           # features/step_definitions/session_steps.rb:18
    Then I should not see any posts in my stream                              # features/step_definitions/posts_steps.rb:17

  Scenario: preview and post a text-only message               # features/desktop/post_preview.feature:16
    Given I expand the publisher                               # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "I am eating yogurt"       # features/step_definitions/posts_steps.rb:109
    And I preview the post                                     # features/step_definitions/post_preview_steps.rb:13
    Then I should see "I am eating yogurt" in the preview      # features/step_definitions/post_preview_steps.rb:19
    Given I edit the post                                      # features/step_definitions/post_preview_steps.rb:1
    When I write the status message "This preview rocks"       # features/step_definitions/posts_steps.rb:109
    And I preview the post                                     # features/step_definitions/post_preview_steps.rb:13
    Then I should see "This preview rocks" in the preview      # features/step_definitions/post_preview_steps.rb:19
    And I should not see "I am eating a yogurt" in the preview # features/step_definitions/post_preview_steps.rb:25
    Given I edit the post                                      # features/step_definitions/post_preview_steps.rb:1
    When I write the status message "I like rocks"             # features/step_definitions/posts_steps.rb:109
    And I press "Share"                                        # features/step_definitions/web_steps.rb:30
    Then "I like rocks" should be post 1                       # features/step_definitions/stream_steps.rb:9
    When I expand the publisher                                # features/step_definitions/custom_web_steps.rb:63
    Then I should not be in preview mode                       # features/step_definitions/post_preview_steps.rb:31

  Scenario: preview a very long message            # features/desktop/post_preview.feature:35
    Given I expand the publisher                   # features/step_definitions/custom_web_steps.rb:63
    When I insert an extremely long status message # features/step_definitions/posts_steps.rb:113
    And I preview the post                         # features/step_definitions/post_preview_steps.rb:13
    Then the preview should not be collapsed       # features/step_definitions/post_preview_steps.rb:7
    When I press "Share"                           # features/step_definitions/web_steps.rb:30
    Then the post should be collapsed              # features/step_definitions/posts_steps.rb:1

  Scenario: preview a photo with text                                                 # features/desktop/post_preview.feature:43
    Given I expand the publisher                                                      # features/step_definitions/custom_web_steps.rb:63
    And I attach "spec/fixtures/button.png" to the publisher                          # features/step_definitions/posts_steps.rb:121
    When I fill in the following:                                                     # features/step_definitions/web_steps.rb:59
      | status_message_text | Look at this dog |
    And I preview the post                                                            # features/step_definitions/post_preview_steps.rb:13
    Then I should see a "img" within ".md-preview .stream-element .photo_attachments" # features/step_definitions/custom_web_steps.rb:177
    And I should see "Look at this dog" within ".md-preview .stream-element"          # features/step_definitions/web_steps.rb:98
    And I close the publisher                                                         # features/step_definitions/custom_web_steps.rb:67

  Scenario: preview a post with mentions                 # features/desktop/post_preview.feature:53
    Given I expand the publisher                         # features/step_definitions/custom_web_steps.rb:63
    And I mention Alice in the publisher                 # features/step_definitions/mention_steps.rb:17
    And I preview the post                               # features/step_definitions/post_preview_steps.rb:13
    And I confirm the alert after I follow "Alice Smith" # features/step_definitions/custom_web_steps.rb:139
    Then I should see "Alice Smith"                      # features/step_definitions/web_steps.rb:98

  Scenario: preview a post on tag page                              # features/desktop/post_preview.feature:60
    Given there is a user "Samuel Beckett" who's tagged "#rockstar" # features/step_definitions/user_steps.rb:94
    When I go to the tag page for "rockstar"                        # features/step_definitions/web_steps.rb:26
    Then I should see "Samuel Beckett"                              # features/step_definitions/web_steps.rb:98
    When I expand the publisher                                     # features/step_definitions/custom_web_steps.rb:63
    And I fill in the following:                                    # features/step_definitions/web_steps.rb:59
      | status_message_text | This preview rocks |
    And I preview the post                                          # features/step_definitions/post_preview_steps.rb:13
    Then I should see "This preview rocks" in the preview           # features/step_definitions/post_preview_steps.rb:19
    And I close the publisher                                       # features/step_definitions/custom_web_steps.rb:67

  Scenario: preview a post with the poll                                  # features/desktop/post_preview.feature:71
    Given I expand the publisher                                          # features/step_definitions/custom_web_steps.rb:63
    When I fill in the following:                                         # features/step_definitions/web_steps.rb:59
      | status_message_text | I am eating yogurt |
    And I click on selector "#poll_creator"                               # features/step_definitions/custom_web_steps.rb:131
    When I fill in the following:                                         # features/step_definitions/web_steps.rb:59
      | status_message_text | I am eating yogurt               |
      | poll_question       | What kind of yogurt do you like? |
    And I fill in the following for the options:                          # features/step_definitions/post_with_poll_steps.rb:13
      | normal     |
      | not normal |
    And I preview the post                                                # features/step_definitions/post_preview_steps.rb:13
    Then I should see a ".poll_form" within ".md-preview .stream-element" # features/step_definitions/custom_web_steps.rb:177
    And I should see a "form" within ".md-preview .stream-element"        # features/step_definitions/custom_web_steps.rb:177
    And I close the publisher                                             # features/step_definitions/custom_web_steps.rb:67

  Scenario: preview a post with location                                               # features/desktop/post_preview.feature:87
    Given I expand the publisher                                                       # features/step_definitions/custom_web_steps.rb:63
    When I fill in the following:                                                      # features/step_definitions/web_steps.rb:59
      | status_message_text | I am eating yogurt |
    And I allow geolocation                                                            # features/step_definitions/location_steps.rb:1
    And I click on selector "#locator"                                                 # features/step_definitions/custom_web_steps.rb:131
    When I fill in the following:                                                      # features/step_definitions/web_steps.rb:59
      | status_message_text | I am eating yogurt |
      | location_address    | Some cool place    |
    And I preview the post                                                             # features/step_definitions/post_preview_steps.rb:13
    Then I should see a ".near-from" within ".md-preview .stream-element"              # features/step_definitions/custom_web_steps.rb:177
    And I should see "Some cool place" within ".md-preview .stream-element .near-from" # features/step_definitions/web_steps.rb:98
    And I close the publisher                                                          # features/step_definitions/custom_web_steps.rb:67

@javascript
Feature: posting with a poll

  Background:                      # features/desktop/post_with_a_poll.feature:4
    Given following users exist:   # features/step_definitions/user_steps.rb:29
      | username |
      | bob      |
    And I sign in as "bob@bob.bob" # features/step_definitions/session_steps.rb:18

  Scenario: expanding the publisher              # features/desktop/post_with_a_poll.feature:10
    Given "#poll_creator_container" is hidden    # features/step_definitions/custom_web_steps.rb:299
    When I expand the publisher                  # features/step_definitions/custom_web_steps.rb:63
    Then I should see an element "#poll_creator" # features/step_definitions/post_with_poll_steps.rb:36

  Scenario: expanding the poll creator                     # features/desktop/post_with_a_poll.feature:15
    Given "#poll_creator_container" is hidden              # features/step_definitions/custom_web_steps.rb:299
    When I expand the publisher                            # features/step_definitions/custom_web_steps.rb:63
    And I click on selector "#poll_creator"                # features/step_definitions/custom_web_steps.rb:131
    Then I should see an element "#poll_creator_container" # features/step_definitions/post_with_poll_steps.rb:36

  Scenario: adding option to poll                  # features/desktop/post_with_a_poll.feature:21
    Given "#poll_creator_container" is hidden      # features/step_definitions/custom_web_steps.rb:299
    When I expand the publisher                    # features/step_definitions/custom_web_steps.rb:63
    And I click on selector "#poll_creator"        # features/step_definitions/custom_web_steps.rb:131
    And I fill in values for the first two options # features/step_definitions/post_with_poll_steps.rb:26
    And I lose focus                               # features/step_definitions/post_with_poll_steps.rb:32
    Then I should see 3 options                    # features/step_definitions/post_with_poll_steps.rb:1

  Scenario: delete an option                       # features/desktop/post_with_a_poll.feature:29
    Given "#poll_creator_container" is hidden      # features/step_definitions/custom_web_steps.rb:299
    When I expand the publisher                    # features/step_definitions/custom_web_steps.rb:63
    And I click on selector "#poll_creator"        # features/step_definitions/custom_web_steps.rb:131
    And I fill in values for the first two options # features/step_definitions/post_with_poll_steps.rb:26
    And I lose focus                               # features/step_definitions/post_with_poll_steps.rb:32
    And I delete the last option                   # features/step_definitions/post_with_poll_steps.rb:5
    Then I should see 2 option                     # features/step_definitions/post_with_poll_steps.rb:1
    And I should not see a remove icon             # features/step_definitions/post_with_poll_steps.rb:9

  Scenario: post with an attached poll                        # features/desktop/post_with_a_poll.feature:39
    Given I expand the publisher                              # features/step_definitions/custom_web_steps.rb:63
    And I click on selector "#poll_creator"                   # features/step_definitions/custom_web_steps.rb:131
    When I fill in the following:                             # features/step_definitions/web_steps.rb:59
      | status_message_text | I am eating yogurt               |
      | poll_question       | What kind of yogurt do you like? |
    And I fill in the following for the options:              # features/step_definitions/post_with_poll_steps.rb:13
      | normal     |
      | not normal |
    And I press "Share"                                       # features/step_definitions/web_steps.rb:30
    Then I should see a ".poll_form" within ".stream-element" # features/step_definitions/custom_web_steps.rb:177
    And I should see a "form" within ".stream-element"        # features/step_definitions/custom_web_steps.rb:177

  Scenario: vote for an option                                # features/desktop/post_with_a_poll.feature:52
    Given I expand the publisher                              # features/step_definitions/custom_web_steps.rb:63
    And I click on selector "#poll_creator"                   # features/step_definitions/custom_web_steps.rb:131
    When I fill in the following:                             # features/step_definitions/web_steps.rb:59
      | status_message_text | I am eating yogurt               |
      | poll_question       | What kind of yogurt do you like? |
    And I fill in the following for the options:              # features/step_definitions/post_with_poll_steps.rb:13
      | normal     |
      | not normal |
    And I press "Share"                                       # features/step_definitions/web_steps.rb:30
    And I check the first option                              # features/step_definitions/post_with_poll_steps.rb:21
    And I press "Vote" within ".stream-element"               # features/step_definitions/web_steps.rb:30
    Then I should see an element ".poll_progress_bar"         # features/step_definitions/post_with_poll_steps.rb:36
    And I should see an element ".percentage"                 # features/step_definitions/post_with_poll_steps.rb:36
    And I should see "1 vote so far" within ".poll_statistic" # features/step_definitions/web_steps.rb:98

  Scenario: click to show result                 # features/desktop/post_with_a_poll.feature:69
    Given I expand the publisher                 # features/step_definitions/custom_web_steps.rb:63
    And I click on selector "#poll_creator"      # features/step_definitions/custom_web_steps.rb:131
    When I fill in the following:                # features/step_definitions/web_steps.rb:59
      | status_message_text | I am eating yogurt               |
      | poll_question       | What kind of yogurt do you like? |
    And I fill in the following for the options: # features/step_definitions/post_with_poll_steps.rb:13
      | normal     |
      | not normal |
    And I press "Share"                          # features/step_definitions/web_steps.rb:30
    And I click on selector ".toggle_result"     # features/step_definitions/custom_web_steps.rb:131
    Then I should see an element ".percentage"   # features/step_definitions/post_with_poll_steps.rb:36

  Scenario: validate answer input                           # features/desktop/post_with_a_poll.feature:82
    Given I expand the publisher                            # features/step_definitions/custom_web_steps.rb:63
    And I click on selector "#poll_creator"                 # features/step_definitions/custom_web_steps.rb:131
    When I fill in the following:                           # features/step_definitions/web_steps.rb:59
      | status_message_text | I am eating yogurt               |
      | poll_question       | What kind of yogurt do you like? |
    And I fill in the following for the options:            # features/step_definitions/post_with_poll_steps.rb:13
      | normal |
      |        |
    And I click on selector "#poll_creator_container"       # features/step_definitions/custom_web_steps.rb:131
    And I click on selector "#publisher button#submit"      # features/step_definitions/custom_web_steps.rb:131
    Then I should see an element ".poll-answer input.error" # features/step_definitions/post_with_poll_steps.rb:36

@javascript
Feature: posting from the main page
    In order to enlighten humanity for the good of society
    As a rock star
    I want to tell the world I am eating a yogurt

  Background:                                                                        # features/desktop/posts_from_main_page.feature:7
    Given following users exist:                                                     # features/step_definitions/user_steps.rb:29
      | username |
      | bob      |
      | alice    |
    And a user with username "bob" is connected with "alice"                         # features/step_definitions/user_steps.rb:88
    And I sign in as "bob@bob.bob"                                                   # features/step_definitions/session_steps.rb:18
    And I have following aspects:                                                    # features/step_definitions/user_steps.rb:70
      | PostingTo            |
      | NotPostingThingsHere |
    And I have user with username "alice" in an aspect called "PostingTo"            # features/step_definitions/user_steps.rb:76
    And I have user with username "alice" in an aspect called "NotPostingThingsHere" # features/step_definitions/user_steps.rb:76
    And I go to the home page                                                        # features/step_definitions/web_steps.rb:26

  Scenario: expanding the publisher                                                            # features/desktop/posts_from_main_page.feature:21
    Given ".markdownIndications" is hidden                                                     # features/step_definitions/custom_web_steps.rb:299
    And ".options_and_submit" is hidden                                                        # features/step_definitions/custom_web_steps.rb:299
    When I expand the publisher                                                                # features/step_definitions/custom_web_steps.rb:63
    Then I should see "You can use Markdown to format your post" within ".markdownIndications" # features/step_definitions/web_steps.rb:98
    Then I should see "All aspects" within ".options_and_submit"                               # features/step_definitions/web_steps.rb:98
    Then I should see a ".md-write-tab" within ".md-header"                                    # features/step_definitions/custom_web_steps.rb:177
    Then I should see a ".md-preview-tab" within ".md-header"                                  # features/step_definitions/custom_web_steps.rb:177

  Scenario: post a text-only message to all aspects      # features/desktop/posts_from_main_page.feature:30
    Given I expand the publisher                         # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "I am eating yogurt" # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                           # features/step_definitions/posts_steps.rb:84
    And I go to the aspects page                         # features/step_definitions/web_steps.rb:26
    Then "I am eating yogurt" should be post 1           # features/step_definitions/stream_steps.rb:9

  Scenario: re-posting a text-only message                       # features/desktop/posts_from_main_page.feature:38
    Given I expand the publisher                                 # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "The World needs more Cats." # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                   # features/step_definitions/posts_steps.rb:84
    Given I expand the publisher                                 # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "The World needs more Cats." # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                   # features/step_definitions/posts_steps.rb:84
    Then "The World needs more Cats." should be post 1           # features/step_definitions/stream_steps.rb:9
    And "The World needs more Cats." should be post 2            # features/step_definitions/stream_steps.rb:9
    When I go to the aspects page                                # features/step_definitions/web_steps.rb:26
    Then "The World needs more Cats." should be post 1           # features/step_definitions/stream_steps.rb:9
    And "The World needs more Cats." should be post 2            # features/step_definitions/stream_steps.rb:9

  Scenario: posting a message appends it to the top of the stream # features/desktop/posts_from_main_page.feature:53
    When I click the publisher and post "sup dog"                 # features/step_definitions/posts_steps.rb:101
    And I click the publisher and post "hello there"              # features/step_definitions/posts_steps.rb:101
    Then "hello there" should be post 1                           # features/step_definitions/stream_steps.rb:9

  Scenario: post a text-only message to just one aspect    # features/desktop/posts_from_main_page.feature:58
    When I select only "PostingTo" aspect                  # features/step_definitions/aspects_steps.rb:47
    And I expand the publisher                             # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "I am eating a yogurt" # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                             # features/step_definitions/posts_steps.rb:84
    When I am on the aspects page                          # features/step_definitions/web_steps.rb:22
    And I select all aspects                               # features/step_definitions/aspects_steps.rb:63
    And I select only "PostingTo" aspect                   # features/step_definitions/aspects_steps.rb:47
    Then "I am eating a yogurt" should be post 1           # features/step_definitions/stream_steps.rb:9
    When I am on the aspects page                          # features/step_definitions/web_steps.rb:22
    And I select all aspects                               # features/step_definitions/aspects_steps.rb:63
    And I select only "NotPostingThingsHere" aspect        # features/step_definitions/aspects_steps.rb:47
    Then I should not see "I am eating a yogurt"           # features/step_definitions/web_steps.rb:113

  Scenario: post a photo with text                                           # features/desktop/posts_from_main_page.feature:75
    Given I expand the publisher                                             # features/step_definitions/custom_web_steps.rb:63
    And I attach "spec/fixtures/button.png" to the publisher                 # features/step_definitions/posts_steps.rb:121
    When I write the status message "Look at this dog"                       # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                               # features/step_definitions/posts_steps.rb:84
    And I go to the aspects page                                             # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within ".stream-element div.photo_attachments" # features/step_definitions/custom_web_steps.rb:177
    And I should see "Look at this dog" within ".stream-element"             # features/step_definitions/web_steps.rb:98
    When I log out                                                           # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                                     # features/step_definitions/session_steps.rb:18
    And I go to "bob@bob.bob"'s page                                         # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within ".stream-element div.photo_attachments" # features/step_definitions/custom_web_steps.rb:177
    And I should see "Look at this dog" within ".stream-element"             # features/step_definitions/web_steps.rb:98

  Scenario: post a photo without text                                        # features/desktop/posts_from_main_page.feature:89
    Given I expand the publisher                                             # features/step_definitions/custom_web_steps.rb:63
    And I attach "spec/fixtures/button.png" to the publisher                 # features/step_definitions/posts_steps.rb:121
    Then I should see an uploaded image within the photo drop zone           # features/step_definitions/posts_steps.rb:9
    When I press "Share"                                                     # features/step_definitions/web_steps.rb:30
    Then I should see a "img" within ".stream-element div.photo_attachments" # features/step_definitions/custom_web_steps.rb:177
    When I go to the aspects page                                            # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within ".stream-element div.photo_attachments" # features/step_definitions/custom_web_steps.rb:177
    When I log out                                                           # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                                     # features/step_definitions/session_steps.rb:18
    And I go to "bob@bob.bob"'s page                                         # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within ".stream-element div.photo_attachments" # features/step_definitions/custom_web_steps.rb:177

  Scenario: back out of posting a photo-only post                      # features/desktop/posts_from_main_page.feature:102
    Given I expand the publisher                                       # features/step_definitions/custom_web_steps.rb:63
    And I attach "spec/fixtures/button.png" to the publisher           # features/step_definitions/posts_steps.rb:121
    When I click to delete the first uploaded photo                    # features/step_definitions/custom_web_steps.rb:126
    Then I should not see an uploaded image within the photo drop zone # features/step_definitions/posts_steps.rb:13
    And I should not be able to submit the publisher                   # features/step_definitions/posts_steps.rb:31

  Scenario: back out of uploading a picture to a post with text        # features/desktop/posts_from_main_page.feature:109
    Given I expand the publisher                                       # features/step_definitions/custom_web_steps.rb:63
    And I have turned off jQuery effects                               # features/step_definitions/custom_web_steps.rb:193
    When I write the status message "I am eating a yogurt"             # features/step_definitions/posts_steps.rb:109
    And I attach "spec/fixtures/button.png" to the publisher           # features/step_definitions/posts_steps.rb:121
    And I click to delete the first uploaded photo                     # features/step_definitions/custom_web_steps.rb:126
    Then I should not see an uploaded image within the photo drop zone # features/step_definitions/posts_steps.rb:13
    And the publisher should be expanded                               # features/step_definitions/custom_web_steps.rb:71
    And I close the publisher                                          # features/step_definitions/custom_web_steps.rb:67

  Scenario: back out of uploading a picture when another has been attached # features/desktop/posts_from_main_page.feature:119
    Given I expand the publisher                                           # features/step_definitions/custom_web_steps.rb:63
    And I have turned off jQuery effects                                   # features/step_definitions/custom_web_steps.rb:193
    When I write the status message "I am eating a yogurt"                 # features/step_definitions/posts_steps.rb:109
    And I attach "spec/fixtures/button.png" to the publisher               # features/step_definitions/posts_steps.rb:121
    And I attach "spec/fixtures/button.png" to the publisher               # features/step_definitions/posts_steps.rb:121
    And I click to delete the first uploaded photo                         # features/step_definitions/custom_web_steps.rb:126
    Then I should see an uploaded image within the photo drop zone         # features/step_definitions/posts_steps.rb:9
    And the publisher should be expanded                                   # features/step_definitions/custom_web_steps.rb:71
    And I close the publisher                                              # features/step_definitions/custom_web_steps.rb:67

  Scenario: hide a contact's post                                    # features/desktop/posts_from_main_page.feature:130
    Given I expand the publisher                                     # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "Here is a post for you to hide" # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                       # features/step_definitions/posts_steps.rb:84
    And I log out                                                    # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                             # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                                 # features/step_definitions/web_steps.rb:22
    And I hover over the ".stream-element"                           # features/step_definitions/custom_web_steps.rb:86
    And I click to hide the first post                               # features/step_definitions/custom_web_steps.rb:114
    And I go to "bob@bob.bob"'s page                                 # features/step_definitions/web_steps.rb:26
    Then I should not see "Here is a post for you to hide"           # features/step_definitions/web_steps.rb:113
    When I am on the aspects page                                    # features/step_definitions/web_steps.rb:22
    Then I should not see "Here is a post for you to hide"           # features/step_definitions/web_steps.rb:113

  Scenario: delete one of my posts                         # features/desktop/posts_from_main_page.feature:146
    Given I expand the publisher                           # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "I am eating a yogurt" # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                             # features/step_definitions/posts_steps.rb:84
    And I go to the aspects page                           # features/step_definitions/web_steps.rb:26
    And I hover over the ".stream-element"                 # features/step_definitions/custom_web_steps.rb:86
    And I click to delete the first post                   # features/step_definitions/custom_web_steps.rb:108
    And I go to the aspects page                           # features/step_definitions/web_steps.rb:26
    Then I should not see "I am eating a yogurt"           # features/step_definitions/web_steps.rb:113

  Scenario: change post target aspects with the aspect-dropdown before posting # features/desktop/posts_from_main_page.feature:156
    When I expand the publisher                                                # features/step_definitions/custom_web_steps.rb:63
    And I press the aspect dropdown                                            # features/step_definitions/aspects_steps.rb:84
    And I toggle the aspect "PostingTo"                                        # features/step_definitions/aspects_steps.rb:104
    And I press the aspect dropdown                                            # features/step_definitions/aspects_steps.rb:84
    And I append "I am eating a yogurt" to the publisher                       # features/step_definitions/posts_steps.rb:117
    And I submit the publisher                                                 # features/step_definitions/posts_steps.rb:84
    And I am on the aspects page                                               # features/step_definitions/web_steps.rb:22
    And I select only "PostingTo" aspect                                       # features/step_definitions/aspects_steps.rb:47
    Then "I am eating a yogurt" should be post 1                               # features/step_definitions/stream_steps.rb:9
    When I am on the aspects page                                              # features/step_definitions/web_steps.rb:22
    And I select all aspects                                                   # features/step_definitions/aspects_steps.rb:63
    And I select only "NotPostingThingsHere" aspect                            # features/step_definitions/aspects_steps.rb:47
    Then I should not see "I am eating a yogurt"                               # features/step_definitions/web_steps.rb:113

  Scenario: post 2 in a row using the aspects-dropdown                     # features/desktop/posts_from_main_page.feature:172
    When I expand the publisher                                            # features/step_definitions/custom_web_steps.rb:63
    And I press the aspect dropdown                                        # features/step_definitions/aspects_steps.rb:84
    And I toggle the aspect "PostingTo"                                    # features/step_definitions/aspects_steps.rb:104
    And I press the aspect dropdown                                        # features/step_definitions/aspects_steps.rb:84
    And I append "I am eating a yogurt" to the publisher                   # features/step_definitions/posts_steps.rb:117
    And I submit the publisher                                             # features/step_definitions/posts_steps.rb:84
    And I expand the publisher                                             # features/step_definitions/custom_web_steps.rb:63
    And I press the aspect dropdown                                        # features/step_definitions/aspects_steps.rb:84
    And I toggle the aspect "Besties"                                      # features/step_definitions/aspects_steps.rb:104
    And I press the aspect dropdown                                        # features/step_definitions/aspects_steps.rb:84
    And I append "And cornflakes also" to the publisher                    # features/step_definitions/posts_steps.rb:117
    And I submit the publisher                                             # features/step_definitions/posts_steps.rb:84
    And I am on the aspects page                                           # features/step_definitions/web_steps.rb:22
    And I select only "PostingTo" aspect                                   # features/step_definitions/aspects_steps.rb:47
    Then I should see "I am eating a yogurt" and "And cornflakes also"     # features/step_definitions/web_steps.rb:98
    When I am on the aspects page                                          # features/step_definitions/web_steps.rb:22
    And I select all aspects                                               # features/step_definitions/aspects_steps.rb:63
    And I select only "Besties" aspect                                     # features/step_definitions/aspects_steps.rb:47
    Then I should not see "I am eating a yogurt"                           # features/step_definitions/web_steps.rb:113
    Then I should see "And cornflakes also"                                # features/step_definitions/web_steps.rb:98
    When I am on the aspects page                                          # features/step_definitions/web_steps.rb:22
    And I select all aspects                                               # features/step_definitions/aspects_steps.rb:63
    And I select only "NotPostingThingsHere" aspect                        # features/step_definitions/aspects_steps.rb:47
    Then I should not see "I am eating a yogurt" and "And cornflakes also" # features/step_definitions/web_steps.rb:113

  Scenario: Write html in the publisher                                                          # features/desktop/posts_from_main_page.feature:200
    When I expand the publisher                                                                  # features/step_definitions/custom_web_steps.rb:63
    Then I should not see any alert after I write the status message "<script>alert();</script>" # features/step_definitions/custom_web_steps.rb:151
    When I submit the publisher                                                                  # features/step_definitions/posts_steps.rb:84
    Then "<script>alert();</script>" should be post 1                                            # features/step_definitions/stream_steps.rb:9

  # (NOTE) make this a jasmine spec
  Scenario: reject deletion one of my posts                               # features/desktop/posts_from_main_page.feature:207
    When I expand the publisher                                           # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "I am eating a yogurt"                # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                            # features/step_definitions/posts_steps.rb:84
    And I hover over the ".stream-element"                                # features/step_definitions/custom_web_steps.rb:86
    And I reject the alert after I prepare the deletion of the first post # features/step_definitions/custom_web_steps.rb:145
    Then I should see "I am eating a yogurt"                              # features/step_definitions/web_steps.rb:98

@javascript
Feature: posting from own profile page
    In order to be all cool and stuff
    I want to post from my profile page

  Background:                              # features/desktop/posts_from_profile_page.feature:6
    Given a user with username "alice"     # features/step_definitions/user_steps.rb:13
    And I sign in as "alice@alice.alice"   # features/step_definitions/session_steps.rb:18
    And I have following aspects:          # features/step_definitions/user_steps.rb:70
      | Family |
      | Work   |
    And I am on "alice@alice.alice"'s page # features/step_definitions/web_steps.rb:22

  Scenario: posting some text                                   # features/desktop/posts_from_profile_page.feature:14
    Given I expand the publisher                                # features/step_definitions/custom_web_steps.rb:63
    And I have turned off jQuery effects                        # features/step_definitions/custom_web_steps.rb:193
    And I append "I want to understand people" to the publisher # features/step_definitions/posts_steps.rb:117
    And I select "Family" on the aspect dropdown                # features/step_definitions/posts_steps.rb:129
    And I press "Share"                                         # features/step_definitions/web_steps.rb:30
    Then "I want to understand people" should be post 1         # features/step_definitions/stream_steps.rb:9
    When I go to the home page                                  # features/step_definitions/web_steps.rb:26
    Then "I want to understand people" should be post 1         # features/step_definitions/stream_steps.rb:9
    When I am on the aspects page                               # features/step_definitions/web_steps.rb:22
    And I select only "Family" aspect                           # features/step_definitions/aspects_steps.rb:47
    Then "I want to understand people" should be post 1         # features/step_definitions/stream_steps.rb:9
    When I select all aspects                                   # features/step_definitions/aspects_steps.rb:63
    And I select only "Work" aspect                             # features/step_definitions/aspects_steps.rb:47
    Then I should not see "I want to understand people"         # features/step_definitions/web_steps.rb:113

  Scenario: post a photo with text                                           # features/desktop/posts_from_profile_page.feature:35
    Given I expand the publisher                                             # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "who am I?"                              # features/step_definitions/posts_steps.rb:109
    And I attach "spec/fixtures/button.png" to the publisher                 # features/step_definitions/posts_steps.rb:121
    And I submit the publisher                                               # features/step_definitions/posts_steps.rb:84
    When I go to the home page                                               # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within ".stream-element div.photo_attachments" # features/step_definitions/custom_web_steps.rb:177
    And I should see "who am I?" within ".stream-element"                    # features/step_definitions/web_steps.rb:98

  Scenario: back out of posting a photo-only post                      # features/desktop/posts_from_profile_page.feature:45
    Given I expand the publisher                                       # features/step_definitions/custom_web_steps.rb:63
    And I have turned off jQuery effects                               # features/step_definitions/custom_web_steps.rb:193
    And I attach "spec/fixtures/button.png" to the publisher           # features/step_definitions/posts_steps.rb:121
    And I click to delete the first uploaded photo                     # features/step_definitions/custom_web_steps.rb:126
    Then I should not see an uploaded image within the photo drop zone # features/step_definitions/posts_steps.rb:13
    And I close the publisher                                          # features/step_definitions/custom_web_steps.rb:67

@javascript
Feature: Posting from the tag page
  In order to share my opinion on cats
  I want to post from the tag page

  Background:                            # features/desktop/posts_from_tag_page.feature:6
    Given a user with username "alice"   # features/step_definitions/user_steps.rb:13
    And I sign in as "alice@alice.alice" # features/step_definitions/session_steps.rb:18
    And I am on the tag page for "cats"  # features/step_definitions/web_steps.rb:22

  Scenario: posting some text                    # features/desktop/posts_from_tag_page.feature:11
    When I expand the publisher                  # features/step_definitions/custom_web_steps.rb:63
    And I have turned off jQuery effects         # features/step_definitions/custom_web_steps.rb:193
    And I append "I like cats." to the publisher # features/step_definitions/posts_steps.rb:117
    And I press "Share"                          # features/step_definitions/web_steps.rb:30
    Then "#cats I like cats." should be post 1   # features/step_definitions/stream_steps.rb:9
    When I go to the home page                   # features/step_definitions/web_steps.rb:26
    Then "#cats I like cats." should be post 1   # features/step_definitions/stream_steps.rb:9
    When I am on the tag page for "cats"         # features/step_definitions/web_steps.rb:22
    Then "#cats I like cats." should be post 1   # features/step_definitions/stream_steps.rb:9

@javascript
Feature: show photos

  Background:                                                         # features/desktop/profile_photos.feature:4
    Given following users exist:                                      # features/step_definitions/user_steps.rb:29
      | username     | email              |
      | Bob Jones    | bob@bob.bob        |
      | Alice Smith  | alice@alice.alice  |
      | Robert Grimm | robert@grimm.grimm |
    And "robert@grimm.grimm" has posted a status message with a photo # features/step_definitions/user_steps.rb:169
    And I sign in as "robert@grimm.grimm"                             # features/step_definitions/session_steps.rb:18

  Scenario: see my own photos                # features/desktop/profile_photos.feature:13
    When I am on "robert@grimm.grimm"'s page # features/step_definitions/web_steps.rb:22
    And I press the first "#photos_link"     # features/step_definitions/custom_web_steps.rb:165
    Then I should be on person_photos page   # features/step_definitions/web_steps.rb:174

  Scenario: I cannot see photos of people who don't share with me   # features/desktop/profile_photos.feature:18
    When I sign in as "alice@alice.alice"                           # features/step_definitions/session_steps.rb:18
    And I am on "robert@grimm.grimm"'s page                         # features/step_definitions/web_steps.rb:22
    Then I should not see "Photos" within "#profile-horizontal-bar" # features/step_definitions/web_steps.rb:113

  Scenario: I can see public photos of people who share with me               # features/desktop/profile_photos.feature:23
    When "robert@grimm.grimm" has posted a public status message with a photo # features/step_definitions/user_steps.rb:169
    And I sign in as "alice@alice.alice"                                      # features/step_definitions/session_steps.rb:18
    And I am on "robert@grimm.grimm"'s page                                   # features/step_definitions/web_steps.rb:22
    Then I should see "Photos" within "#profile-horizontal-bar"               # features/step_definitions/web_steps.rb:98
    When I press the first "#photos_link"                                     # features/step_definitions/custom_web_steps.rb:165
    Then I should be on "robert@grimm.grimm"'s photos page                    # features/step_definitions/web_steps.rb:174
    And I should see "Photos" within "#profile-horizontal-bar"                # features/step_definitions/web_steps.rb:98

  Scenario: I delete a photo                                        # features/desktop/profile_photos.feature:32
    When I am on "robert@grimm.grimm"'s photos page                 # features/step_definitions/web_steps.rb:22
    Then I should see a ".thumbnail" within "#main_stream"          # features/step_definitions/custom_web_steps.rb:177
    When I confirm the alert after I delete a photo                 # features/step_definitions/custom_web_steps.rb:139
    Then I should not see a ".thumbnail" within "#main_stream"      # features/step_definitions/custom_web_steps.rb:183
    When I am on "robert@grimm.grimm"'s page                        # features/step_definitions/web_steps.rb:22
    Then I should not see "Photos" within "#profile-horizontal-bar" # features/step_definitions/web_steps.rb:113

@javascript
Feature: The public stream

  Background:                                                         # features/desktop/public_stream.feature:3
    Given following users exist:                                      # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Alice Smith | alice@alice.alice |
      | Bob Jones   | bob@bob.bob       |
    And "bob@bob.bob" has a public post with text "Bob’s public post" # features/step_definitions/posts_steps.rb:43

  Scenario: seeing public posts           # features/desktop/public_stream.feature:11
    When I sign in as "alice@alice.alice" # features/step_definitions/session_steps.rb:18
    And I am on the public stream page    # features/step_definitions/web_steps.rb:22
    Then I should see "Bob’s public post" # features/step_definitions/web_steps.rb:98

@javascript
Feature: public repost
  In order to make Diaspora more viral
  As a User
  I want to reshare my friend's post

  Background:                                                                 # features/desktop/reshare.feature:7
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
      | Eve Doe     | eve@eve.eve       |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And a user with email "eve@eve.eve" is connected with "bob@bob.bob"       # features/step_definitions/user_steps.rb:82
    And "bob@bob.bob" has a public post with text "reshare this!"             # features/step_definitions/posts_steps.rb:43

  Scenario: Resharing a post from a single post page              # features/desktop/reshare.feature:17
    Given I sign in as "alice@alice.alice"                        # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                              # features/step_definitions/web_steps.rb:22
    And I open the show page of the "reshare this!" post          # features/step_definitions/posts_steps.rb:125
    And I confirm the alert after I click on selector "a.reshare" # features/step_definitions/custom_web_steps.rb:139
    Then I should see a flash message indicating success          # features/step_definitions/custom_web_steps.rb:243
    And I should see a flash message containing "successfully"    # features/step_definitions/custom_web_steps.rb:259

  Scenario: Resharing a post from a single post page that is reshared     # features/desktop/reshare.feature:25
    Given the post with text "reshare this!" is reshared by "eve@eve.eve" # features/step_definitions/posts_steps.rb:78
    And I sign in as "alice@alice.alice"                                  # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                                      # features/step_definitions/web_steps.rb:22
    And I open the show page of the "reshare this!" post                  # features/step_definitions/posts_steps.rb:125
    And I confirm the alert after I click on selector "a.reshare"         # features/step_definitions/custom_web_steps.rb:139
    Then I should see a flash message indicating success                  # features/step_definitions/custom_web_steps.rb:243
    And I should see a flash message containing "successfully"            # features/step_definitions/custom_web_steps.rb:259

  Scenario: Delete original reshared post                                       # features/desktop/reshare.feature:34
    Given "alice@alice.alice" has a public post with text "Don't reshare this!" # features/step_definitions/posts_steps.rb:43
    And the post with text "Don't reshare this!" is reshared by "bob@bob.bob"   # features/step_definitions/posts_steps.rb:78
    And I sign in as "alice@alice.alice"                                        # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page                                      # features/step_definitions/web_steps.rb:22
    When I click to delete the first post                                       # features/step_definitions/custom_web_steps.rb:108
    And I log out                                                               # features/step_definitions/session_steps.rb:55
    And I sign in as "bob@bob.bob"                                              # features/step_definitions/session_steps.rb:18
    Then I should see "Original post deleted by author" within ".reshare"       # features/step_definitions/web_steps.rb:98

  Scenario: Reshare a post from the stream                     # features/desktop/reshare.feature:45
    When I sign in as "alice@alice.alice"                      # features/step_definitions/session_steps.rb:18
    Then I should see a ".reshare" within ".feedback"          # features/step_definitions/custom_web_steps.rb:177
    When I confirm the alert after I follow "Reshare"          # features/step_definitions/custom_web_steps.rb:139
    Then I should see a flash message indicating success       # features/step_definitions/custom_web_steps.rb:243
    And I should see a flash message containing "successfully" # features/step_definitions/custom_web_steps.rb:259
    And I should not see a ".reshare" within ".feedback"       # features/step_definitions/custom_web_steps.rb:183

  Scenario: Reshare a post from another user's profile         # features/desktop/reshare.feature:53
    When I sign in as "alice@alice.alice"                      # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                           # features/step_definitions/web_steps.rb:22
    Then I should see a ".reshare" within ".feedback"          # features/step_definitions/custom_web_steps.rb:177
    When I confirm the alert after I follow "Reshare"          # features/step_definitions/custom_web_steps.rb:139
    Then I should see a flash message indicating success       # features/step_definitions/custom_web_steps.rb:243
    And I should see a flash message containing "successfully" # features/step_definitions/custom_web_steps.rb:259
    And I should not see a ".reshare" within ".feedback"       # features/step_definitions/custom_web_steps.rb:183

  Scenario: Try to reshare an already reshared post from another user's profile # features/desktop/reshare.feature:62
    Given the post with text "reshare this!" is reshared by "alice@alice.alice" # features/step_definitions/posts_steps.rb:78
    When I sign in as "alice@alice.alice"                                       # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                                            # features/step_definitions/web_steps.rb:22
    Then I should not see a ".reshare" within ".feedback"                       # features/step_definitions/custom_web_steps.rb:183

@javascript
Feature: search for users and hashtags
  In order to find my friends on diaspora
  As a user
  I want search for them

  Background:                    # features/desktop/search.feature:7
    Given following users exist: # features/step_definitions/user_steps.rb:29
      | username       | email             |
      | Bob Jones      | bob@bob.bob       |
      | Alice Smith    | alice@alice.alice |
      | Carol Williams | carol@example.com |

  Scenario: search for a user and go to its profile                # features/desktop/search.feature:14
    When I sign in as "bob@bob.bob"                                # features/step_definitions/session_steps.rb:18
    And I enter "Alice Sm" in the search input                     # features/step_definitions/search_steps.rb:1
    Then I should see "Alice Smith" within ".tt-menu"              # features/step_definitions/web_steps.rb:98
    When I click on the first search result                        # features/step_definitions/search_steps.rb:5
    Then I should see "Alice Smith" within ".profile_header #name" # features/step_definitions/web_steps.rb:98

  Scenario: search for a inexistent user and go to the search page    # features/desktop/search.feature:22
    When I sign in as "bob@bob.bob"                                   # features/step_definitions/session_steps.rb:18
    And I enter "Trinity" in the search input                         # features/step_definitions/search_steps.rb:1
    And I press enter in the search input                             # features/step_definitions/search_steps.rb:11
    Then I should see "Users matching Trinity" within "#search_title" # features/step_definitions/web_steps.rb:98

  Scenario: search for a user in background                                 # features/desktop/search.feature:29
    When I sign in as "bob@bob.bob"                                         # features/step_definitions/session_steps.rb:18
    And I search for "user@pod.tld"                                         # features/step_definitions/search_steps.rb:15
    And a person with ID "user@pod.tld" has been discovered                 # features/step_definitions/user_steps.rb:240
    Then I should see "user@pod.tld" within ".stream .info.diaspora_handle" # features/step_definitions/web_steps.rb:98
    And I should see a ".aspect_dropdown" within ".stream"                  # features/step_definitions/custom_web_steps.rb:177

  Scenario: search for a not searchable user                                    # features/desktop/search.feature:36
    When I sign in as "carol@example.com"                                       # features/step_definitions/session_steps.rb:18
    And I go to the edit profile page                                           # features/step_definitions/web_steps.rb:26
    And I mark myself as not searchable                                         # features/step_definitions/profile_steps.rb:9
    And I submit the form                                                       # features/step_definitions/custom_web_steps.rb:59
    Then I should be on the edit profile page                                   # features/step_definitions/web_steps.rb:174
    And the "profile[searchable]" checkbox should not be checked                # features/step_definitions/web_steps.rb:150
    When I sign out                                                             # features/step_definitions/session_steps.rb:55
    And I sign in as "bob@bob.bob"                                              # features/step_definitions/session_steps.rb:18
    And I enter "Carol Wi" in the search input                                  # features/step_definitions/search_steps.rb:1
    Then I should not see any search results                                    # features/step_definitions/search_steps.rb:22
    Given a user with email "bob@bob.bob" is connected with "carol@example.com" # features/step_definitions/user_steps.rb:82
    When I go to the home page                                                  # features/step_definitions/web_steps.rb:26
    And I enter "Carol Wi" in the search input                                  # features/step_definitions/search_steps.rb:1
    Then I should see "Carol Williams" within ".tt-menu"                        # features/step_definitions/web_steps.rb:98
    When I click on the first search result                                     # features/step_definitions/search_steps.rb:5
    Then I should see "Carol Williams" within ".profile_header #name"           # features/step_definitions/web_steps.rb:98

  Scenario: search for a tag                      # features/desktop/search.feature:57
    When I sign in as "bob@bob.bob"               # features/step_definitions/session_steps.rb:18
    And I enter "#Matrix" in the search input     # features/step_definitions/search_steps.rb:1
    Then I should see "#Matrix" within ".tt-menu" # features/step_definitions/web_steps.rb:98
    When I click on the first search result       # features/step_definitions/search_steps.rb:5
    Then I should be on the tag page for "matrix" # features/step_definitions/web_steps.rb:174

@javascript
Feature: collapsing and expanding long posts
    In order to tame the lengths of posts in my stream
    As a rocket scientist
    I want long posts to be collapsed and expand on click

  Background:                         # features/desktop/show_more.feature:7
    Given that following user exists: # features/step_definitions/user_steps.rb:29
      | username |
      | bob      |
    And I sign in as "bob@bob.bob"    # features/step_definitions/session_steps.rb:18

  Scenario: post a very long message              # features/desktop/show_more.feature:13
    Given I post an extremely long status message # features/step_definitions/posts_steps.rb:105
    And I go to the home page                     # features/step_definitions/web_steps.rb:26
    Then the post should be collapsed             # features/step_definitions/posts_steps.rb:1

  Scenario: expand a very long message            # features/desktop/show_more.feature:18
    Given I post an extremely long status message # features/step_definitions/posts_steps.rb:105
    And I go to the home page                     # features/step_definitions/web_steps.rb:26
    And I expand the post                         # features/step_definitions/posts_steps.rb:97
    Then the post should be expanded              # features/step_definitions/posts_steps.rb:5

@javascript
Feature: new user registration

  Background:                                        # features/desktop/signs_up.feature:4
    When I go to the new user registration page      # features/step_definitions/web_steps.rb:26
    And I fill in the new user form                  # features/step_definitions/user_steps.rb:218
    And I submit the form                            # features/step_definitions/custom_web_steps.rb:59
    Then I should be on the getting started page     # features/step_definitions/web_steps.rb:174
    Then I should see the 'getting started' contents # features/step_definitions/session_steps.rb:72

  Scenario: new user goes through the setup wizard          # features/desktop/signs_up.feature:11
    When I fill in the following:                           # features/step_definitions/web_steps.rb:59
      | profile_first_name | O |
    And I confirm the alert after I follow "awesome_button" # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                     # features/step_definitions/web_steps.rb:174
    And the publisher should be expanded                    # features/step_definitions/custom_web_steps.rb:71
    And I close the publisher                               # features/step_definitions/custom_web_steps.rb:67
    Then I should not see "awesome_button"                  # features/step_definitions/web_steps.rb:113
    And I should not see any posts in my stream             # features/step_definitions/posts_steps.rb:17

  Scenario: new user tries to XSS itself                                    # features/desktop/signs_up.feature:21
    When I fill in the following:                                           # features/step_definitions/web_steps.rb:59
      | profile_first_name | <script>alert(0)// |
    And I focus the "follow_tags" field                                     # features/step_definitions/custom_web_steps.rb:279
    Then I should see a flash message containing "Hey, <script>alert(0)//!" # features/step_definitions/custom_web_steps.rb:259

  Scenario: new user does not add any tags in setup wizard and cancel the alert # features/desktop/signs_up.feature:27
    When I fill in the following:                                               # features/step_definitions/web_steps.rb:59
      | profile_first_name | some name |
    And I focus the "follow_tags" field                                         # features/step_definitions/custom_web_steps.rb:279
    Then I should see a flash message containing "Hey, some name!"              # features/step_definitions/custom_web_steps.rb:259
    When I reject the alert after I follow "awesome_button"                     # features/step_definitions/custom_web_steps.rb:145
    Then I should be on the getting started page                                # features/step_definitions/web_steps.rb:174
    And I should see a flash message containing "All right, I’ll wait."         # features/step_definitions/custom_web_steps.rb:259

  Scenario: new user skips the setup wizard                  # features/desktop/signs_up.feature:36
    When I confirm the alert after I follow "awesome_button" # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                      # features/step_definitions/web_steps.rb:174
    And the publisher should be expanded                     # features/step_definitions/custom_web_steps.rb:71

  Scenario: first status message is public                   # features/desktop/signs_up.feature:41
    When I confirm the alert after I follow "awesome_button" # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                      # features/step_definitions/web_steps.rb:174
    And the publisher should be expanded                     # features/step_definitions/custom_web_steps.rb:71
    And I should see "Public" within ".aspect_dropdown"      # features/step_definitions/web_steps.rb:98

  Scenario: new user without any tags posts first status message # features/desktop/signs_up.feature:47
    When I confirm the alert after I follow "awesome_button"     # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                          # features/step_definitions/web_steps.rb:174
    And the publisher should be expanded                         # features/step_definitions/custom_web_steps.rb:71
    When I wait for the popovers to appear                       # features/step_definitions/custom_web_steps.rb:230
    And I click close on all the popovers                        # features/step_definitions/custom_web_steps.rb:234
    And I submit the publisher                                   # features/step_definitions/posts_steps.rb:84
    Then "Hey everyone, I’m #newhere." should be post 1          # features/step_definitions/stream_steps.rb:9

  Scenario: new user with some tags posts first status message                       # features/desktop/signs_up.feature:56
    When I fill in the following:                                                    # features/step_definitions/web_steps.rb:59
      | profile_first_name | some name |
    And I fill in "tags" with "#rockstar"                                            # features/step_definitions/web_steps.rb:42
    And I press the first ".as-result-item" within "#as-results-tags"                # features/step_definitions/custom_web_steps.rb:165
    And I follow "awesome_button"                                                    # features/step_definitions/web_steps.rb:36
    Then I should be on the stream page                                              # features/step_definitions/web_steps.rb:174
    And the publisher should be expanded                                             # features/step_definitions/custom_web_steps.rb:71
    When I wait for the popovers to appear                                           # features/step_definitions/custom_web_steps.rb:230
    And I click close on all the popovers                                            # features/step_definitions/custom_web_steps.rb:234
    And I submit the publisher                                                       # features/step_definitions/posts_steps.rb:84
    Then "Hey everyone, I’m #newhere. I’m interested in #rockstar." should be post 1 # features/step_definitions/stream_steps.rb:9

  Scenario: closing a popover clears getting started         # features/desktop/signs_up.feature:69
    When I confirm the alert after I follow "awesome_button" # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                      # features/step_definitions/web_steps.rb:174
    And I wait for the popovers to appear                    # features/step_definitions/custom_web_steps.rb:230
    And I click close on all the popovers                    # features/step_definitions/custom_web_steps.rb:234
    And I close the publisher                                # features/step_definitions/custom_web_steps.rb:67
    Then I should not see "Welcome to diaspora*"             # features/step_definitions/web_steps.rb:113

  Scenario: user fills in bogus data - client side validation                           # features/desktop/signs_up.feature:77
    When I log out manually                                                             # features/step_definitions/session_steps.rb:60
    And I go to the new user registration page                                          # features/step_definitions/web_steps.rb:26
    And I fill in the following:                                                        # features/step_definitions/web_steps.rb:59
      | user_username | $%&(/&%$&/=)(/ |
    And I press "Create account"                                                        # features/step_definitions/web_steps.rb:30
    Then I should not be able to sign up                                                # features/step_definitions/session_steps.rb:68
    And I should have a validation error on "user_username, user_password, user_email"  # features/step_definitions/custom_web_steps.rb:304
    When I fill in the following:                                                       # features/step_definitions/web_steps.rb:59
      | user_username | valid_user                        |
      | user_email    | this is not a valid email $%&/()( |
    And I press "Create account"                                                        # features/step_definitions/web_steps.rb:30
    Then I should not be able to sign up                                                # features/step_definitions/session_steps.rb:68
    And I should have a validation error on "user_password, user_email"                 # features/step_definitions/custom_web_steps.rb:304
    When I fill in the following:                                                       # features/step_definitions/web_steps.rb:59
      | user_email    | valid@email.com |
      | user_password | 1               |
    And I press "Create account"                                                        # features/step_definitions/web_steps.rb:30
    Then I should not be able to sign up                                                # features/step_definitions/session_steps.rb:68
    And I should have a validation error on "user_password, user_password_confirmation" # features/step_definitions/custom_web_steps.rb:304

  Scenario: User signs up with an already existing username and email and then tries to sign in (Issue #6136) # features/desktop/signs_up.feature:100
    When I log out manually                                                                                   # features/step_definitions/session_steps.rb:60
    And I go to the new user registration page                                                                # features/step_definitions/web_steps.rb:26
    And I fill in the new user form with an existing email and username                                       # features/step_definitions/user_steps.rb:218
    And I submit the form                                                                                     # features/step_definitions/custom_web_steps.rb:59
    Then I should see a flash message indicating failure                                                      # features/step_definitions/custom_web_steps.rb:247
    When I click the sign in button                                                                           # features/step_definitions/user_steps.rb:228
    Then I should not see a flash message indicating failure                                                  # features/step_definitions/custom_web_steps.rb:251

@javascript
Feature: using SPV moderation buttons

  Background:                                                # features/desktop/single_post_view_moderation.feature:4
    Given following users exist:                             # features/step_definitions/user_steps.rb:29
      | username |
      | bob      |
      | alice    |
    And a user with username "bob" is connected with "alice" # features/step_definitions/user_steps.rb:88
    And I sign in as "bob@bob.bob"                           # features/step_definitions/session_steps.rb:18

  Scenario: hide a contact's post                                      # features/desktop/single_post_view_moderation.feature:12
    Given I expand the publisher                                       # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "Here is a post to test with"      # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                         # features/step_definitions/posts_steps.rb:84
    And I log out                                                      # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                               # features/step_definitions/session_steps.rb:18
    And I open the show page of the "Here is a post to test with" post # features/step_definitions/posts_steps.rb:125
    And I confirm the alert after I click to hide the post             # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                                # features/step_definitions/web_steps.rb:174

  Scenario: block a contact                                            # features/desktop/single_post_view_moderation.feature:25
    Given I expand the publisher                                       # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "Here is a post to test with"      # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                         # features/step_definitions/posts_steps.rb:84
    And I log out                                                      # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                               # features/step_definitions/session_steps.rb:18
    And I open the show page of the "Here is a post to test with" post # features/step_definitions/posts_steps.rb:125
    And I confirm the alert after I click to block the user            # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                                # features/step_definitions/web_steps.rb:174

  Scenario: report a contact                                                               # features/desktop/single_post_view_moderation.feature:38
    Given I expand the publisher                                                           # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "Here is a post to test with"                          # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                                             # features/step_definitions/posts_steps.rb:84
    And I log out                                                                          # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                                                   # features/step_definitions/session_steps.rb:18
    And I open the show page of the "Here is a post to test with" post                     # features/step_definitions/posts_steps.rb:125
    And I confirm the alert after I click to report the post                               # features/step_definitions/custom_web_steps.rb:139
    And I should see a flash message containing "The report has successfully been created" # features/step_definitions/custom_web_steps.rb:259

  Scenario: delete own post                                            # features/desktop/single_post_view_moderation.feature:51
    Given I expand the publisher                                       # features/step_definitions/custom_web_steps.rb:63
    When I write the status message "Here is a post to test with"      # features/step_definitions/posts_steps.rb:109
    And I submit the publisher                                         # features/step_definitions/posts_steps.rb:84
    And I open the show page of the "Here is a post to test with" post # features/step_definitions/posts_steps.rb:125
    And I confirm the alert after I click to delete the post           # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the stream page                                # features/step_definitions/web_steps.rb:174

@javascript
Feature: Unfollowing
  In order to stop seeing updates from self-important rockstars
  As a user
  I want to be able to stop following people

  Background:                                   # features/desktop/stops_following_users.feature:7
    Given following users:                      # features/step_definitions/user_steps.rb:29
      | email             |
      | bob@bob.bob       |
      | alice@alice.alice |
    When I sign in as "bob@bob.bob"             # features/step_definitions/session_steps.rb:18
    And I am on "alice@alice.alice"'s page      # features/step_definitions/web_steps.rb:22
    And I add the person to my "Besties" aspect # features/step_definitions/user_steps.rb:129

  Scenario: stop following someone while on their profile page # features/desktop/stops_following_users.feature:16
    When I am on "alice@alice.alice"'s page                    # features/step_definitions/web_steps.rb:22
    And I remove the person from my "Besties" aspect           # features/step_definitions/user_steps.rb:129
    And I go to the home page                                  # features/step_definitions/web_steps.rb:26
    Then I should have 0 contacts in "Besties"                 # features/step_definitions/user_steps.rb:125
    When I sign out                                            # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                       # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                           # features/step_definitions/web_steps.rb:22
    Then I should not see "is sharing with you."               # features/step_definitions/web_steps.rb:113

  Scenario: stop following someone while on the contacts page # features/desktop/stops_following_users.feature:27
    When I go to the contacts page                            # features/step_definitions/web_steps.rb:26
    And I follow "Besties"                                    # features/step_definitions/web_steps.rb:36
DEPRECATED: #parent is deprecated in favor of #query_scope - Note: #parent was not the elements parent in the document so it's most likely not what you wanted anyway
    And I remove the first person from the aspect             # features/step_definitions/aspects_steps.rb:76
    And I follow "My contacts"                                # features/step_definitions/web_steps.rb:36
    Then I should have 0 contacts in "Besties"                # features/step_definitions/user_steps.rb:125
    When I sign out                                           # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice"                      # features/step_definitions/session_steps.rb:18
    And I am on "bob@bob.bob"'s page                          # features/step_definitions/web_steps.rb:22
    Then I should not see "is sharing with you."              # features/step_definitions/web_steps.rb:113

@javascript
Feature: managing authorized applications

  Background:                                                                 # features/desktop/user_applications.feature:3
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username | email              |
      | Augier   | augier@example.org |
    And a client with a provided picture exists for user "augier@example.org" # features/step_definitions/oidc_common_steps.rb:1
    And a client exists for user "augier@example.org"                         # features/step_definitions/oidc_common_steps.rb:7

  Scenario: displaying authorizations                                 # features/desktop/user_applications.feature:10
    When I sign in as "augier@example.org"                            # features/step_definitions/session_steps.rb:18
    And I go to the user applications page                            # features/step_definitions/web_steps.rb:26
    Then I should see 2 authorized applications                       # features/step_definitions/user_applications_steps.rb:1
    And I should see 1 authorized applications with no provided image # features/step_definitions/user_applications_steps.rb:6
    And I should see 1 authorized applications with an image          # features/step_definitions/user_applications_steps.rb:10

  Scenario: revoke an authorization             # features/desktop/user_applications.feature:17
    When I sign in as "augier@example.org"      # features/step_definitions/session_steps.rb:18
    And I go to the user applications page      # features/step_definitions/web_steps.rb:26
    And I revoke the first authorization        # features/step_definitions/user_applications_steps.rb:14
    Then I should see 1 authorized applications # features/step_definitions/user_applications_steps.rb:1
    And I revoke the first authorization        # features/step_definitions/user_applications_steps.rb:14
    Then I should see 0 authorized applications # features/step_definitions/user_applications_steps.rb:1

@javascript @mobile
Feature: Viewing my activity on the stream mobile page
  In order to navigate Diaspora*
  As a mobile user
  I want to view my activity stream

  Background:                                                                  # features/mobile/activity_stream.feature:7
    Given following users exist:                                               # features/step_definitions/user_steps.rb:29
      | username |
      | alice    |
      | bob      |
    And a user with username "bob" is connected with "alice"                   # features/step_definitions/user_steps.rb:88
    And "alice@alice.alice" has a public post with text "Hello! I am #newhere" # features/step_definitions/posts_steps.rb:43

  Scenario: Show my activity empty                        # features/mobile/activity_stream.feature:15
    When I sign in as "bob@bob.bob" on the mobile website # features/step_definitions/session_steps.rb:18
    When I go to the activity stream page                 # features/step_definitions/web_steps.rb:26
    Then I should see "My activity" within "#main"        # features/step_definitions/web_steps.rb:98
    And I should not see "Hello! I am #newhere"           # features/step_definitions/web_steps.rb:113

  Scenario: Show liked post on my activity                # features/mobile/activity_stream.feature:21
    When I sign in as "bob@bob.bob" on the mobile website # features/step_definitions/session_steps.rb:18
    When I click on selector "a.like-action.inactive"     # features/step_definitions/custom_web_steps.rb:131
    And I go to the activity stream page                  # features/step_definitions/web_steps.rb:26
    Then I should see "My activity" within "#main"        # features/step_definitions/web_steps.rb:98
    And I should see "Hello! I am #newhere" within ".ltr" # features/step_definitions/web_steps.rb:98

  Scenario: Show own post on my activity                        # features/mobile/activity_stream.feature:28
    When I sign in as "alice@alice.alice" on the mobile website # features/step_definitions/session_steps.rb:18
    And I go to the activity stream page                        # features/step_definitions/web_steps.rb:26
    Then I should see "My activity" within "#main"              # features/step_definitions/web_steps.rb:98
    And I should see "Hello! I am #newhere" within ".ltr"       # features/step_definitions/web_steps.rb:98

@javascript @mobile
Feature: Change password
  As a mobile user
  I want to Change my password

  Scenario: Change my password                                                              # features/mobile/change_password.feature:7
    Given I am signed in on the mobile website                                              # features/step_definitions/session_steps.rb:1
    When I go to the edit user page                                                         # features/step_definitions/web_steps.rb:26
    And I fill out change password section with my password and "newsecret" and "newsecret" # features/step_definitions/session_steps.rb:35
    And I press "Change password"                                                           # features/step_definitions/web_steps.rb:30
    Then I should see "Password changed"                                                    # features/step_definitions/web_steps.rb:98
    And I should be on the new user session page                                            # features/step_definitions/web_steps.rb:174
    When I sign in with password "newsecret" on the mobile website                          # features/step_definitions/session_steps.rb:25
    Then I should be on the stream page                                                     # features/step_definitions/web_steps.rb:174

  Scenario: Attempt to change my password with invalid input                      # features/mobile/change_password.feature:17
    Given I am signed in on the mobile website                                    # features/step_definitions/session_steps.rb:1
    When I go to the edit user page                                               # features/step_definitions/web_steps.rb:26
    And I fill out change password section with my password and "too" and "short" # features/step_definitions/session_steps.rb:35
    And I press "Change password"                                                 # features/step_definitions/web_steps.rb:30
    Then I should see "Password is too short"                                     # features/step_definitions/web_steps.rb:98
    And I should see "Password confirmation doesn't match"                        # features/step_definitions/web_steps.rb:98

  Scenario: Reset my password                                                                     # features/mobile/change_password.feature:25
    Given a user named "Georges Abitbol" with email "forgetful@users.net"                         # features/step_definitions/user_steps.rb:17
    And I am on forgot password page                                                              # features/step_definitions/web_steps.rb:22
    When I fill out forgot password form with "forgetful@users.net"                               # features/step_definitions/session_steps.rb:39
    And I submit forgot password form                                                             # features/step_definitions/session_steps.rb:43
    Then I should see "You will receive an email with instructions"                               # features/step_definitions/web_steps.rb:98
    When I follow the "Change my password" link from the last sent email                          # features/step_definitions/user_steps.rb:143
    And I fill out the password reset form with "supersecret" and "supersecret"                   # features/step_definitions/session_steps.rb:47
    And I submit the password reset form                                                          # features/step_definitions/session_steps.rb:51
    Then I should be on the stream page                                                           # features/step_definitions/web_steps.rb:174
    When I sign out                                                                               # features/step_definitions/session_steps.rb:55
    And I go to the login page                                                                    # features/step_definitions/web_steps.rb:26
    And I sign in manually as "georges_abitbol" with password "supersecret" on the mobile website # features/step_definitions/session_steps.rb:10
    Then I should be on the stream page                                                           # features/step_definitions/web_steps.rb:174

  Scenario: Attempt to reset password with invalid password               # features/mobile/change_password.feature:40
    Given a user named "Georges Abitbol" with email "forgetful@users.net" # features/step_definitions/user_steps.rb:17
    And I am on forgot password page                                      # features/step_definitions/web_steps.rb:22
    When I fill out forgot password form with "forgetful@users.net"       # features/step_definitions/session_steps.rb:39
    And I submit forgot password form                                     # features/step_definitions/session_steps.rb:43
    And I follow the "Change my password" link from the last sent email   # features/step_definitions/user_steps.rb:143
    And I fill out the password reset form with "too" and "short"         # features/step_definitions/session_steps.rb:47
    And I press "Change my password"                                      # features/step_definitions/web_steps.rb:30
    Then I should be on the user password page                            # features/step_definitions/web_steps.rb:174
    And I should see "Password is too short"                              # features/step_definitions/web_steps.rb:98
    And I should see "Password confirmation doesn't match"                # features/step_definitions/web_steps.rb:98

  Scenario: Attempt to reset password with invalid email   # features/mobile/change_password.feature:52
    Given I am on forgot password page                     # features/step_definitions/web_steps.rb:22
    When I fill out forgot password form with "notanemail" # features/step_definitions/session_steps.rb:39
    And I submit forgot password form                      # features/step_definitions/session_steps.rb:43
    Then I should see "No account with this email exists"  # features/step_definitions/web_steps.rb:98

@javascript @mobile
Feature: Close account
 In order to close an existing account
 As a user
 I want to sign in, close my account and try to log in again

  Scenario: user closes account                                          # features/mobile/closes_account.feature:7
    Given I am signed in on the mobile website                           # features/step_definitions/session_steps.rb:1
    When I go to the edit user page                                      # features/step_definitions/web_steps.rb:26
    And I click on selector "#close_account"                             # features/step_definitions/custom_web_steps.rb:131
    Then I should see a modal                                            # features/step_definitions/modal_steps.rb:1
    And I should see "Hey, please don’t go!" within "#closeAccountModal" # features/step_definitions/web_steps.rb:98
    When I put in my password in the close account modal                 # features/step_definitions/modal_steps.rb:9
    And I confirm the alert after I press "Close account" in the modal   # features/step_definitions/custom_web_steps.rb:139
    Then I should be on the mobile new user session page                 # features/step_definitions/web_steps.rb:174
    When I try to sign in manually                                       # features/step_definitions/session_steps.rb:6
    Then I should be on the new user session page                        # features/step_definitions/web_steps.rb:174
    And I should see a flash message with a warning                      # features/step_definitions/custom_web_steps.rb:255

@javascript @mobile
Feature: private conversations mobile
    In order to be talkative
    As a mobile user
    I want to converse with people

  Background:                                                        # features/mobile/conversations.feature:7
    Given a user with username "bob"                                 # features/step_definitions/user_steps.rb:13
    And a user named "Alice Awesome" with email "alice@alice.alice"  # features/step_definitions/user_steps.rb:17
    And a user with username "bob" is connected with "alice_awesome" # features/step_definitions/user_steps.rb:88
    And I sign in as "bob@bob.bob" on the mobile website             # features/step_definitions/session_steps.rb:18

  Scenario: send and delete a mobile message                                                           # features/mobile/conversations.feature:13
    Given I send a mobile message with subject "Greetings" and text "hello, alice!" to "Alice Awesome" # features/step_definitions/conversations_steps.rb:51
    Then I should see "Greetings" within ".conversation h3"                                            # features/step_definitions/web_steps.rb:98
    And "Alice Awesome" should be part of active conversation                                          # features/step_definitions/conversations_steps.rb:1
    And I should see "hello, alice!" within ".stream-element"                                          # features/step_definitions/web_steps.rb:98
    When I sign in as "alice@alice.alice" on the mobile website                                        # features/step_definitions/session_steps.rb:18
    And I reply with "hey, how you doing?"                                                             # features/step_definitions/conversations_steps.rb:37
    And I press the first ".ltr" within ".conversation"                                                # features/step_definitions/custom_web_steps.rb:165
    Then I should see "hey, how you doing?"                                                            # features/step_definitions/web_steps.rb:98
    When I confirm the alert after I click on selector "a.remove"                                      # features/step_definitions/custom_web_steps.rb:139
    Then I should not see "hey, how you doing"                                                         # features/step_definitions/web_steps.rb:113

@javascript @mobile
Feature: Navigate between pages using the header menu and the drawer
  As a user
  I want to be able navigate between the pages of the mobile version

  Background:                                                                 # features/mobile/drawer.feature:6
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And I sign in as "alice@alice.alice" on the mobile website                # features/step_definitions/session_steps.rb:18

  Scenario: navigate to the stream page     # features/mobile/drawer.feature:15
    When I go to the activity stream page   # features/step_definitions/web_steps.rb:26
    And I click on selector "#header-title" # features/step_definitions/custom_web_steps.rb:131
    Then I should be on the stream page     # features/step_definitions/web_steps.rb:174

  Scenario: navigate to the notification page      # features/mobile/drawer.feature:20
    When I click on selector "#notification-badge" # features/step_definitions/custom_web_steps.rb:131
    Then I should be on the notifications page     # features/step_definitions/web_steps.rb:174

  Scenario: navigate to the conversation page       # features/mobile/drawer.feature:24
    When I click on selector "#conversations-badge" # features/step_definitions/custom_web_steps.rb:131
    Then I should be on the conversations page      # features/step_definitions/web_steps.rb:174

  Scenario: navigate to the publisher page          # features/mobile/drawer.feature:28
    When I click on selector "#compose-badge"       # features/step_definitions/custom_web_steps.rb:131
    Then I should be on the new status message page # features/step_definitions/web_steps.rb:174

  Scenario: search a user                                         # features/mobile/drawer.feature:32
    When I open the drawer                                        # features/step_definitions/mobile_steps.rb:13
    Then I should see a "#q" within "#drawer"                     # features/step_definitions/custom_web_steps.rb:177
    When I search for "Bob"                                       # features/step_definitions/search_steps.rb:15
    Then I should see "Users matching Bob" within "#search_title" # features/step_definitions/web_steps.rb:98

  Scenario: search for a tag                   # features/mobile/drawer.feature:38
    When I open the drawer                     # features/step_definitions/mobile_steps.rb:13
    Then I should see a "#q" within "#drawer"  # features/step_definitions/custom_web_steps.rb:177
    When I search for "#bob"                   # features/step_definitions/search_steps.rb:15
    Then I should be on the tag page for "bob" # features/step_definitions/web_steps.rb:174

  Scenario: navigate to the stream page   # features/mobile/drawer.feature:44
    When I open the drawer                # features/step_definitions/mobile_steps.rb:13
    And I click on "Stream" in the drawer # features/step_definitions/drawer_steps.rb:1
    Then I should be on the stream page   # features/step_definitions/web_steps.rb:174

  Scenario: navigate to my activity page         # features/mobile/drawer.feature:49
    When I open the drawer                       # features/step_definitions/mobile_steps.rb:13
    And I click on "My activity" in the drawer   # features/step_definitions/drawer_steps.rb:1
    Then I should be on the activity stream page # features/step_definitions/web_steps.rb:174

  Scenario: navigate to my mentions page          # features/mobile/drawer.feature:54
    When I open the drawer                        # features/step_definitions/mobile_steps.rb:13
    And I click on "@Mentions" in the drawer      # features/step_definitions/drawer_steps.rb:1
    Then I should be on the mentioned stream page # features/step_definitions/web_steps.rb:174

  Scenario: navigate to aspects pages                                       # features/mobile/drawer.feature:59
    Given "bob@bob.bob" has a public post with text "bob's text"            # features/step_definitions/posts_steps.rb:43
    Given I have a limited post with text "Hi you!" in the aspect "Besties" # features/step_definitions/posts_steps.rb:39
    When I open the drawer                                                  # features/step_definitions/mobile_steps.rb:13
    And I click on "My aspects" in the drawer                               # features/step_definitions/drawer_steps.rb:1
    And I click on "All aspects" in the drawer                              # features/step_definitions/drawer_steps.rb:1
    Then I should be on the aspects page                                    # features/step_definitions/web_steps.rb:174
    And I should see "Hi you!" within "#main_stream"                        # features/step_definitions/web_steps.rb:98
    When I open the drawer                                                  # features/step_definitions/mobile_steps.rb:13
    And I click on "My aspects" in the drawer                               # features/step_definitions/drawer_steps.rb:1
    And I click on "Unicorns" in the drawer                                 # features/step_definitions/drawer_steps.rb:1
    And I should not see "Hi you!" within "#main_stream"                    # features/step_definitions/web_steps.rb:113

  Scenario: navigate to the followed tags page        # features/mobile/drawer.feature:72
    When I follow the "boss" tag                      # features/step_definitions/tag_steps.rb:11
    And I go to the stream page                       # features/step_definitions/web_steps.rb:26
    And I open the drawer                             # features/step_definitions/mobile_steps.rb:13
    And I click on "#Followed tags" in the drawer     # features/step_definitions/drawer_steps.rb:1
    And I click on "All tags" in the drawer           # features/step_definitions/drawer_steps.rb:1
    Then I should be on the followed tags stream page # features/step_definitions/web_steps.rb:174

  Scenario: navigate to the boss tag page               # features/mobile/drawer.feature:80
    When I follow the "boss" tag                        # features/step_definitions/tag_steps.rb:11
    And I go to the stream page                         # features/step_definitions/web_steps.rb:26
    And I open the drawer                               # features/step_definitions/mobile_steps.rb:13
    And I click on "#Followed tags" in the drawer       # features/step_definitions/drawer_steps.rb:1
    And I click on "#boss" in the drawer                # features/step_definitions/drawer_steps.rb:1
    Then I should be on the tag page for "boss"         # features/step_definitions/web_steps.rb:174
    When I open the drawer                              # features/step_definitions/mobile_steps.rb:13
    And I click on "#Followed tags" in the drawer       # features/step_definitions/drawer_steps.rb:1
    And I click on "Manage followed tags" in the drawer # features/step_definitions/drawer_steps.rb:1
    Then I should be on the manage tag followings page  # features/step_definitions/web_steps.rb:174

  Scenario: navigate to the public stream page     # features/mobile/drawer.feature:93
    When I open the drawer                         # features/step_definitions/mobile_steps.rb:13
    And I click on "Public activity" in the drawer # features/step_definitions/drawer_steps.rb:1
    Then I should be on the public stream page     # features/step_definitions/web_steps.rb:174

  Scenario: navigate to my profile page    # features/mobile/drawer.feature:98
    When I open the drawer                 # features/step_definitions/mobile_steps.rb:13
    And I click on "Profile" in the drawer # features/step_definitions/drawer_steps.rb:1
    Then I should be on my profile page    # features/step_definitions/web_steps.rb:174

  Scenario: navigate to my contacts page    # features/mobile/drawer.feature:103
    When I open the drawer                  # features/step_definitions/mobile_steps.rb:13
    And I click on "Contacts" in the drawer # features/step_definitions/drawer_steps.rb:1
    Then I should be on the contacts page   # features/step_definitions/web_steps.rb:174

  Scenario: navigate to my settings page         # features/mobile/drawer.feature:108
    When I open the drawer                       # features/step_definitions/mobile_steps.rb:13
    And I click on "Settings" in the drawer      # features/step_definitions/drawer_steps.rb:1
    Then I should be on my account settings page # features/step_definitions/web_steps.rb:174

@javascript @mobile
Feature: editing the profile in the mobile view

  Scenario: editing profile fields                                                                                  # features/mobile/edits_profile.feature:3
    Given I am signed in on the mobile website                                                                      # features/step_definitions/session_steps.rb:1
    And I go to the edit profile page                                                                               # features/step_definitions/web_steps.rb:26
    When I fill in the following:                                                                                   # features/step_definitions/web_steps.rb:59
      | profile_gender     | Fearless      |
      | profile_first_name | Boba          |
      | profile_last_name  | Fett          |
      | profile_bio        | This is a bio |
      | profile_location   | Kamino        |
    And I select "1986" from "profile_date_year"                                                                    # features/step_definitions/web_steps.rb:67
    And I select "30" from "profile_date_day"                                                                       # features/step_definitions/web_steps.rb:67
    And I select "November" from "profile_date_month"                                                               # features/step_definitions/web_steps.rb:67
    And I fill in "profile[tag_string]" with "#starwars"                                                            # features/step_definitions/web_steps.rb:42
    And I press the first ".as-result-item" within ".as-results"                                                    # features/step_definitions/custom_web_steps.rb:165
    And I press "Update profile"                                                                                    # features/step_definitions/web_steps.rb:30
    Then I should be on my edit profile page                                                                        # features/step_definitions/web_steps.rb:174
    And I should see "Profile updated"                                                                              # features/step_definitions/web_steps.rb:98
    And the "profile_gender" field should contain "Fearless"                                                        # features/step_definitions/web_steps.rb:128
    And the "profile_first_name" field should contain "Boba"                                                        # features/step_definitions/web_steps.rb:128
    And the "profile_last_name" field should contain "Fett"                                                         # features/step_definitions/web_steps.rb:128
    And the "profile_bio" field should contain "This is a bio"                                                      # features/step_definitions/web_steps.rb:128
    And the "profile_date_year" field should be filled with "1986"                                                  # features/step_definitions/custom_web_steps.rb:197
    And the "profile_date_month" field should be filled with "11"                                                   # features/step_definitions/custom_web_steps.rb:197
    And the "profile_date_day" field should be filled with "30"                                                     # features/step_definitions/custom_web_steps.rb:197
    And the "profile_location" field should be filled with "Kamino"                                                 # features/step_definitions/custom_web_steps.rb:197
    And I should see "#starwars" within "ul#as-selections-tags"                                                     # features/step_definitions/web_steps.rb:98
    When I fill in "profile[tag_string]" with "#kamino"                                                             # features/step_definitions/web_steps.rb:42
    And I press the first ".as-result-item" within ".as-results"                                                    # features/step_definitions/custom_web_steps.rb:165
    And I press "Update profile"                                                                                    # features/step_definitions/web_steps.rb:30
    Then I should see "#kamino" within "ul#as-selections-tags"                                                      # features/step_definitions/web_steps.rb:98
    And I should see "#starwars" within "ul#as-selections-tags"                                                     # features/step_definitions/web_steps.rb:98
    When I confirm the alert after I attach the file "spec/fixtures/bad_urls.txt" to "qqfile" within "#file-upload" # features/step_definitions/custom_web_steps.rb:139
    And I attach the file "spec/fixtures/button.png" to hidden "qqfile" within "#file-upload"                       # features/step_definitions/web_steps.rb:91
    Then I should see "button.png completed"                                                                        # features/step_definitions/web_steps.rb:98
    And I should see a "img" within "#profile_photo_upload"                                                         # features/step_definitions/custom_web_steps.rb:177
    When I go to my edit profile page                                                                               # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within "#profile_photo_upload"                                                        # features/step_definitions/custom_web_steps.rb:177

@javascript @mobile
Feature: editing the getting started in the mobile view

  Background:                                        # features/mobile/getting_started.feature:4
    Given I am on the login page                     # features/step_definitions/web_steps.rb:22
    When I follow "Create account" within ".navbar"  # features/step_definitions/web_steps.rb:36
    And I fill in the new user form                  # features/step_definitions/user_steps.rb:218
    And I submit the form                            # features/step_definitions/custom_web_steps.rb:59
    Then I should be on the getting started page     # features/step_definitions/web_steps.rb:174
    Then I should see the 'getting started' contents # features/step_definitions/session_steps.rb:72

  Scenario: new user does not add any tags in setup wizard # features/mobile/getting_started.feature:12
    When I fill in the following:                          # features/step_definitions/web_steps.rb:59
      | profile_first_name | some name |
    And I follow "awesome_button"                          # features/step_definitions/web_steps.rb:36
    Then I should be on the stream page                    # features/step_definitions/web_steps.rb:174
    And I should not see "awesome_button"                  # features/step_definitions/web_steps.rb:113

  Scenario: new user adds a profile photo and tags                                                                  # features/mobile/getting_started.feature:19
    When I confirm the alert after I attach the file "spec/fixtures/bad_urls.txt" to "qqfile" within "#file-upload" # features/step_definitions/custom_web_steps.rb:139
    And I attach the file "spec/fixtures/button.png" to hidden "qqfile" within "#file-upload"                       # features/step_definitions/web_steps.rb:91
    Then I should see a "img" within "#profile_photo_upload"                                                        # features/step_definitions/custom_web_steps.rb:177
    When I fill in "follow_tags" with "#men"                                                                        # features/step_definitions/web_steps.rb:42
    And I press the first ".as-result-item" within ".as-results"                                                    # features/step_definitions/custom_web_steps.rb:165
    Then I should see "#men" within "ul#as-selections-tags"                                                         # features/step_definitions/web_steps.rb:98

  Scenario: new user skips the setup wizard # features/mobile/getting_started.feature:28
    When I follow "awesome_button"          # features/step_definitions/web_steps.rb:36
    Then I should be on the stream page     # features/step_definitions/web_steps.rb:174
    And I should not see "awesome_button"   # features/step_definitions/web_steps.rb:113

  Scenario: new user completes getting started and signs in again later           # features/mobile/getting_started.feature:33
    When I sign out                                                               # features/step_definitions/session_steps.rb:55
    And I go to the login page                                                    # features/step_definitions/web_steps.rb:26
    And I sign in manually as "ohai" with password "secret" on the mobile website # features/step_definitions/session_steps.rb:10
    Then I should be on the getting started page                                  # features/step_definitions/web_steps.rb:174
    When I follow "awesome_button"                                                # features/step_definitions/web_steps.rb:36
    Then I should be on the stream page                                           # features/step_definitions/web_steps.rb:174
    When I sign out                                                               # features/step_definitions/session_steps.rb:55
    And I go to the login page                                                    # features/step_definitions/web_steps.rb:26
    And I sign in manually as "ohai" with password "secret" on the mobile website # features/step_definitions/session_steps.rb:10
    Then I should be on the stream page                                           # features/step_definitions/web_steps.rb:174

@javascript @mobile
Feature: Visit the landing page of the pod
  In order to find out more about the pod
  As a user
  I want to see the landing page

  Scenario: Visit the home page         # features/mobile/home.feature:7
    When I am on the root page          # features/step_definitions/web_steps.rb:22
    Then I should see "LOG IN"          # features/step_definitions/web_steps.rb:98
    When I toggle the mobile view       # features/step_definitions/mobile_steps.rb:1
    And I go to the root page           # features/step_definitions/web_steps.rb:26
    Then I should see "Welcome, friend" # features/step_definitions/web_steps.rb:98
    When I am on the root page          # features/step_definitions/web_steps.rb:22
    Then I should see "Welcome, friend" # features/step_definitions/web_steps.rb:98
    When I go to the mobile path        # features/step_definitions/web_steps.rb:26
    Then I should see "LOG IN"          # features/step_definitions/web_steps.rb:98

@javascript @mobile
Feature: Invitations

  Background:                    # features/mobile/invitations.feature:3
    Given following users exist: # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Alice Smith | alice@alice.alice |

  Scenario: Accepting an invitation                                           # features/mobile/invitations.feature:8
    Given I have been invited by "alice@alice.alice"                          # features/step_definitions/user_steps.rb:49
    And I am on my acceptance form page                                       # features/step_definitions/web_steps.rb:22
    When I fill in the new user form                                          # features/step_definitions/user_steps.rb:218
    And I press "Create account"                                              # features/step_definitions/web_steps.rb:30
    Then I should see the "welcome to diaspora" message                       # features/step_definitions/message_steps.rb:1
    And I should be able to friend "alice@alice.alice"                        # features/step_definitions/user_steps.rb:222
    When I select "Family" from "user_aspects" within "#hello-there"          # features/step_definitions/web_steps.rb:67
    Then the aspect dropdown within "#hello-there" should be labeled "Family" # features/step_definitions/mobile_steps.rb:18

@javascript @mobile
Feature: Browsing Diaspora as a logged out user mobile
  In order to view public diaspora content
  as a random internet user
  I want to view public post and comments

  Background:                                                    # features/mobile/logged_out_browsing.feature:7
    Given a user named "Bob Jones" with email "bob@bob.bob"      # features/step_definitions/user_steps.rb:17
    And "bob@bob.bob" has a public post with text "public stuff" # features/step_definitions/posts_steps.rb:43
    And I sign in as "bob@bob.bob" on the mobile website         # features/step_definitions/session_steps.rb:18
    And I click on selector "a.comment-action.inactive"          # features/step_definitions/custom_web_steps.rb:131
    And I fill in the following:                                 # features/step_definitions/web_steps.rb:59
      | text | this also |
    And I press "Comment"                                        # features/step_definitions/web_steps.rb:30
    And I log out                                                # features/step_definitions/session_steps.rb:55

  Scenario: Visiting a profile page                # features/mobile/logged_out_browsing.feature:17
    When I am on "bob@bob.bob"'s page              # features/step_definitions/web_steps.rb:22
    Then I should see "public stuff" within ".ltr" # features/step_definitions/web_steps.rb:98
    And I click on selector "a.show-comments"      # features/step_definitions/custom_web_steps.rb:131
    And I should see "this also" within ".comment" # features/step_definitions/web_steps.rb:98

@javascript @mobile
Feature: using the more button on mobile stream
  As a mobile user
  I want to navigate the stream
  And I want to test the text of the more-button in different environments

  Background:                                            # features/mobile/more-button.feature:7
    Given a user with username "bob"                     # features/step_definitions/user_steps.rb:13
    And I sign in as "bob@bob.bob" on the mobile website # features/step_definitions/session_steps.rb:18

  Scenario: There are no posts                  # features/mobile/more-button.feature:11
    Given I am on the home page                 # features/step_definitions/web_steps.rb:22
    When I go to the stream page                # features/step_definitions/web_steps.rb:26
    Then I should see "There are no posts yet." # features/step_definitions/web_steps.rb:98

  Scenario: There are <15 posts                                 # features/mobile/more-button.feature:17
    Given I am on the home page                                 # features/step_definitions/web_steps.rb:22
    And "bob@bob.bob" has a public post with text "post 1"      # features/step_definitions/posts_steps.rb:43
    When I go to the stream page                                # features/step_definitions/web_steps.rb:26
    Then I should see "You have reached the end of the stream." # features/step_definitions/web_steps.rb:98

  Scenario: There are 15 posts                                  # features/mobile/more-button.feature:24
    Given I am on the home page                                 # features/step_definitions/web_steps.rb:22
    Given there are 15 public posts from "bob@bob.bob"          # features/step_definitions/posts_steps.rb:66
    And "bob@bob.bob" has a public post with text "post 1"      # features/step_definitions/posts_steps.rb:43
    When I go to the stream page                                # features/step_definitions/web_steps.rb:26
    Then I should see "More"                                    # features/step_definitions/web_steps.rb:98
    When I click on selector ".more-link"                       # features/step_definitions/custom_web_steps.rb:131
    Then I should see "You have reached the end of the stream." # features/step_definitions/web_steps.rb:98

  Scenario: There are 15 +1 posts                               # features/mobile/more-button.feature:35
    Given I am on the home page                                 # features/step_definitions/web_steps.rb:22
    Given there are 16 public posts from "bob@bob.bob"          # features/step_definitions/posts_steps.rb:66
    When I go to the stream page                                # features/step_definitions/web_steps.rb:26
    Then I should see "More"                                    # features/step_definitions/web_steps.rb:98
    When I click on selector ".more-link"                       # features/step_definitions/custom_web_steps.rb:131
    Then I should see "You have reached the end of the stream." # features/step_definitions/web_steps.rb:98

@javascript @mobile
Feature: viewing photos on the mobile main page
  In order to navigate Diaspora*
  As a mobile user
  I want to view some photos

  Background:                                            # features/mobile/multiphoto.feature:7
    Given a user with username "bob"                     # features/step_definitions/user_steps.rb:13
    And I sign in as "bob@bob.bob" on the mobile website # features/step_definitions/session_steps.rb:18

  Scenario: view full size image                                                                         # features/mobile/multiphoto.feature:11
    Given I visit the mobile publisher page                                                              # features/step_definitions/mobile_steps.rb:5
    When I attach the file "spec/fixtures/button.png" to hidden "qqfile" within "#file-upload-publisher" # features/step_definitions/web_steps.rb:91
    Then I should see "button.png completed"                                                             # features/step_definitions/web_steps.rb:98
    And I should see an uploaded image within the photo drop zone                                        # features/step_definitions/posts_steps.rb:9
    When I press "Share"                                                                                 # features/step_definitions/web_steps.rb:30
    And I go to the stream page                                                                          # features/step_definitions/web_steps.rb:26
    And I click on selector "img.stream-photo"                                                           # features/step_definitions/custom_web_steps.rb:131
    Then I should see a "img" within ".photos"                                                           # features/step_definitions/custom_web_steps.rb:177
    And I should not see a "#arrow-right" within "#main"                                                 # features/step_definitions/custom_web_steps.rb:183
    And I should not see a "#arrow-left" within "#main"                                                  # features/step_definitions/custom_web_steps.rb:183

  Scenario: view multiphoto post                                                                         # features/mobile/multiphoto.feature:24
    Given I visit the mobile publisher page                                                              # features/step_definitions/mobile_steps.rb:5
    When I attach the file "spec/fixtures/button.png" to hidden "qqfile" within "#file-upload-publisher" # features/step_definitions/web_steps.rb:91
    Then I should see "button.png completed"                                                             # features/step_definitions/web_steps.rb:98
    When I attach the file "spec/fixtures/button.gif" to hidden "qqfile" within "#file-upload-publisher" # features/step_definitions/web_steps.rb:91
    Then I should see "button.gif completed"                                                             # features/step_definitions/web_steps.rb:98
    When I press "Share"                                                                                 # features/step_definitions/web_steps.rb:30
    And I go to the stream page                                                                          # features/step_definitions/web_steps.rb:26
    Then I should see "+ 1" within ".additional_photo_count"                                             # features/step_definitions/web_steps.rb:98
    When I click on selector "img.stream-photo"                                                          # features/step_definitions/custom_web_steps.rb:131
    Then I should see a "#arrow-right" within "#main"                                                    # features/step_definitions/custom_web_steps.rb:177
    And I should not see a "#arrow-left" within "#main"                                                  # features/step_definitions/custom_web_steps.rb:183
    When I click on selector "#arrow-right"                                                              # features/step_definitions/custom_web_steps.rb:131
    Then I should see a "#arrow-left" within "#main"                                                     # features/step_definitions/custom_web_steps.rb:177
    And I should not see a "#arrow-right" within "#main"                                                 # features/step_definitions/custom_web_steps.rb:183

@javascript @mobile
Feature: Not safe for work

  Background:                                                                                   # features/mobile/not_safe_for_work.feature:3
    Given a nsfw user with email "tommy@nsfw.example.com"                                       # features/step_definitions/user_steps.rb:23
    And a user with email "laura@office.example.com"                                            # features/step_definitions/user_steps.rb:9
    And a user with email "laura@office.example.com" is connected with "tommy@nsfw.example.com" # features/step_definitions/user_steps.rb:82

  Scenario: Setting not safe for work                                # features/mobile/not_safe_for_work.feature:8
    When I sign in as "tommy@nsfw.example.com" on the mobile website # features/step_definitions/session_steps.rb:18
    And I go to the edit profile page                                # features/step_definitions/web_steps.rb:26
    And I mark myself as not safe for work                           # features/step_definitions/profile_steps.rb:1
    And I submit the form                                            # features/step_definitions/custom_web_steps.rb:59
    Then I should be on the edit profile page                        # features/step_definitions/web_steps.rb:174
    And the "profile[nsfw]" checkbox should be checked               # features/step_definitions/web_steps.rb:144
    When I go to the edit profile page                               # features/step_definitions/web_steps.rb:26
    And I mark myself as safe for work                               # features/step_definitions/profile_steps.rb:5
    And I submit the form                                            # features/step_definitions/custom_web_steps.rb:59
    Then I should be on the edit profile page                        # features/step_definitions/web_steps.rb:174
    And the "profile[nsfw]" checkbox should not be checked           # features/step_definitions/web_steps.rb:150

  Scenario: Toggling nsfw state                                                                             # features/mobile/not_safe_for_work.feature:22
      #Nsfw users posts are marked nsfw
    Given "tommy@nsfw.example.com" has a public post with text "I love 0bj3ction4bl3 c0nt3nt!" and a poll   # features/step_definitions/posts_steps.rb:48
    And "tommy@nsfw.example.com" has a public post with text "I love 0bj3ction4bl3 c0nt3nt!" and a location # features/step_definitions/posts_steps.rb:54
    And "tommy@nsfw.example.com" has a public post with text "I love 0bj3ction4bl3 c0nt3nt!" and a picture  # features/step_definitions/posts_steps.rb:60
      #toggling nsfw state
    When I sign in as "laura@office.example.com" on the mobile website                                      # features/step_definitions/session_steps.rb:18
    Then I should not see "I love 0bj3ction4bl3 c0nt3nt!"                                                   # features/step_definitions/web_steps.rb:113
    And I should not see "What do you think about 1 ninjas?"                                                # features/step_definitions/web_steps.rb:113
    And I should not see "Posted from:"                                                                     # features/step_definitions/web_steps.rb:113
    And I should not see any picture in my stream                                                           # features/step_definitions/posts_steps.rb:23
    When I toggle all nsfw posts                                                                            # features/step_definitions/stream_steps.rb:17
    Then I should see "I love 0bj3ction4bl3 c0nt3nt!"                                                       # features/step_definitions/web_steps.rb:98
    And I should see "What do you think about 1 ninjas?"                                                    # features/step_definitions/web_steps.rb:98
    And I should see "Posted from:"                                                                         # features/step_definitions/web_steps.rb:98
    And I should see 1 pictures in my stream                                                                # features/step_definitions/posts_steps.rb:27

  Scenario: Resharing a nsfw post with a poll                                                        # features/mobile/not_safe_for_work.feature:41
    Given "tommy@nsfw.example.com" has a public post with text "Sexy Senators Gone Wild!" and a poll # features/step_definitions/posts_steps.rb:48
    When I sign in as "laura@office.example.com" on the mobile website                               # features/step_definitions/session_steps.rb:18
    And I toggle all nsfw posts                                                                      # features/step_definitions/stream_steps.rb:17
    And I confirm the alert after I follow "Reshare"                                                 # features/step_definitions/custom_web_steps.rb:139
    Then I should see a "a.reshare-action.active"                                                    # features/step_definitions/custom_web_steps.rb:177
    When I go to the home page                                                                       # features/step_definitions/web_steps.rb:26
    Then I should not see "Sexy Senators Gone Wild!"                                                 # features/step_definitions/web_steps.rb:113
    And I should not see "What do you think about 1 ninjas?"                                         # features/step_definitions/web_steps.rb:113
    And I should have 2 nsfw posts                                                                   # features/step_definitions/stream_steps.rb:21

  Scenario: Resharing a nsfw post with a location                                                        # features/mobile/not_safe_for_work.feature:54
    Given "tommy@nsfw.example.com" has a public post with text "Sexy Senators Gone Wild!" and a location # features/step_definitions/posts_steps.rb:54
    When I sign in as "laura@office.example.com" on the mobile website                                   # features/step_definitions/session_steps.rb:18
    And I toggle all nsfw posts                                                                          # features/step_definitions/stream_steps.rb:17
    And I confirm the alert after I follow "Reshare"                                                     # features/step_definitions/custom_web_steps.rb:139
    Then I should see a "a.reshare-action.active"                                                        # features/step_definitions/custom_web_steps.rb:177
    When I go to the home page                                                                           # features/step_definitions/web_steps.rb:26
    Then I should not see "Sexy Senators Gone Wild!"                                                     # features/step_definitions/web_steps.rb:113
    And I should not see "Posted from:"                                                                  # features/step_definitions/web_steps.rb:113
    And I should have 2 nsfw posts                                                                       # features/step_definitions/stream_steps.rb:21

  Scenario: Resharing a nsfw post with a picture                                                        # features/mobile/not_safe_for_work.feature:67
    Given "tommy@nsfw.example.com" has a public post with text "Sexy Senators Gone Wild!" and a picture # features/step_definitions/posts_steps.rb:60
    When I sign in as "laura@office.example.com" on the mobile website                                  # features/step_definitions/session_steps.rb:18
    And I toggle all nsfw posts                                                                         # features/step_definitions/stream_steps.rb:17
    And I confirm the alert after I follow "Reshare"                                                    # features/step_definitions/custom_web_steps.rb:139
    Then I should see a "a.reshare-action.active"                                                       # features/step_definitions/custom_web_steps.rb:177
    When I go to the home page                                                                          # features/step_definitions/web_steps.rb:26
    Then I should not see "Sexy Senators Gone Wild!"                                                    # features/step_definitions/web_steps.rb:113
    And I should not see any picture in my stream                                                       # features/step_definitions/posts_steps.rb:23
    And I should have 2 nsfw posts                                                                      # features/step_definitions/stream_steps.rb:21

@javascript @mobile
Feature: adding and removing people from aspects
  In order to add people to my contacts
  As a mobile user
  I want to add and remove people from my contacts

  Background:                                            # features/mobile/people_aspects.feature:7
    Given following users exist:                         # features/step_definitions/user_steps.rb:29
      | username |
      | bob      |
      | alice    |
    And I sign in as "bob@bob.bob" on the mobile website # features/step_definitions/session_steps.rb:18

  Scenario: verify different states of the cover button                             # features/mobile/people_aspects.feature:14
    When I am on "alice@alice.alice"'s page                                         # features/step_definitions/web_steps.rb:22
    Then the aspect dropdown within "#author_info" should be labeled "Add contact"  # features/step_definitions/mobile_steps.rb:18
    When I select "Unicorns" from "user_aspects" within "#author_info"              # features/step_definitions/web_steps.rb:67
    Then the aspect dropdown within "#author_info" should be labeled "Unicorns"     # features/step_definitions/mobile_steps.rb:18
    When I select "Besties" from "user_aspects" within "#author_info"               # features/step_definitions/web_steps.rb:67
    Then the aspect dropdown within "#author_info" should be labeled "In 2 aspects" # features/step_definitions/mobile_steps.rb:18

  Scenario: add contact to aspect                                               # features/mobile/people_aspects.feature:24
    When I am on "alice@alice.alice"'s page                                     # features/step_definitions/web_steps.rb:22
    And I select "Unicorns" from "user_aspects" within "#author_info"           # features/step_definitions/web_steps.rb:67
    Then the aspect dropdown within "#author_info" should be labeled "Unicorns" # features/step_definitions/mobile_steps.rb:18
    Then I should have 1 contacts in "Unicorns"                                 # features/step_definitions/user_steps.rb:125

  Scenario: remove contact to aspect                                                # features/mobile/people_aspects.feature:30
    When I am on "alice@alice.alice"'s page                                         # features/step_definitions/web_steps.rb:22
    And I select "Unicorns" from "user_aspects" within "#author_info"               # features/step_definitions/web_steps.rb:67
    Then the aspect dropdown within "#author_info" should be labeled "Unicorns"     # features/step_definitions/mobile_steps.rb:18
    And I select "Besties" from "user_aspects" within "#author_info"                # features/step_definitions/web_steps.rb:67
    Then the aspect dropdown within "#author_info" should be labeled "In 2 aspects" # features/step_definitions/mobile_steps.rb:18
    Then I should have 1 contacts in "Unicorns"                                     # features/step_definitions/user_steps.rb:125
    When I am on "alice@alice.alice"'s page                                         # features/step_definitions/web_steps.rb:22
    And I select "Unicorns" from "user_aspects" within "#author_info"               # features/step_definitions/web_steps.rb:67
    Then the aspect dropdown within "#author_info" should be labeled "Besties"      # features/step_definitions/mobile_steps.rb:18
    Then I should have 0 contacts in "Unicorns"                                     # features/step_definitions/user_steps.rb:125

@javascript @mobile
Feature: posting from the mobile main page
  In order to navigate Diaspora*
  As a mobile user
  I want to tell the world I am eating a yogurt

  Background:                                                                        # features/mobile/posts_from_main_page.feature:7
    Given following users exist:                                                     # features/step_definitions/user_steps.rb:29
      | username |
      | bob      |
      | alice    |
    And I am on the home page                                                        # features/step_definitions/web_steps.rb:22
    And I sign in as "bob@bob.bob" on the mobile website                             # features/step_definitions/session_steps.rb:18
    And a user with username "bob" is connected with "alice"                         # features/step_definitions/user_steps.rb:88
    Given I have following aspects:                                                  # features/step_definitions/user_steps.rb:70
      | PostingTo            |
      | NotPostingThingsHere |
    And I have user with username "alice" in an aspect called "PostingTo"            # features/step_definitions/user_steps.rb:76
    And I have user with username "alice" in an aspect called "NotPostingThingsHere" # features/step_definitions/user_steps.rb:76

  Scenario: post and delete some text                             # features/mobile/posts_from_main_page.feature:21
    Given I visit the mobile publisher page                       # features/step_definitions/mobile_steps.rb:5
    And I append "I am eating yogurt" to the publisher            # features/step_definitions/posts_steps.rb:117
    And I select "Unicorns" from "aspect_ids_"                    # features/step_definitions/web_steps.rb:67
    And I press "Share"                                           # features/step_definitions/web_steps.rb:30
    When I go to the stream page                                  # features/step_definitions/web_steps.rb:26
    Then I should see "I am eating yogurt"                        # features/step_definitions/web_steps.rb:98
    When I confirm the alert after I click on selector "a.remove" # features/step_definitions/custom_web_steps.rb:139
    Then I should not see "I am eating yogurt"                    # features/step_definitions/web_steps.rb:113

  Scenario: post a photo without text                                                                    # features/mobile/posts_from_main_page.feature:31
    Given I visit the mobile publisher page                                                              # features/step_definitions/mobile_steps.rb:5
    When I attach the file "spec/fixtures/button.png" to hidden "qqfile" within "#file-upload-publisher" # features/step_definitions/web_steps.rb:91
    Then I should see "button.png completed"                                                             # features/step_definitions/web_steps.rb:98
    And I should see an uploaded image within the photo drop zone                                        # features/step_definitions/posts_steps.rb:9
    When I press "Share"                                                                                 # features/step_definitions/web_steps.rb:30
    When I go to the stream page                                                                         # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within ".stream-element div.photo_attachments"                             # features/step_definitions/custom_web_steps.rb:177
    When I log out                                                                                       # features/step_definitions/session_steps.rb:55
    And I sign in as "alice@alice.alice" on the mobile website                                           # features/step_definitions/session_steps.rb:18
    When I go to the stream page                                                                         # features/step_definitions/web_steps.rb:26
    Then I should see a "img" within ".stream-element div.photo_attachments"                             # features/step_definitions/custom_web_steps.rb:177

  Scenario: back out of posting a photo-only post                                                                             # features/mobile/posts_from_main_page.feature:44
    Given I visit the mobile publisher page                                                                                   # features/step_definitions/mobile_steps.rb:5
    When I confirm the alert after I attach the file "spec/fixtures/bad_urls.txt" to "qqfile" within "#file-upload-publisher" # features/step_definitions/custom_web_steps.rb:139
    Then I should not see an uploaded image within the photo drop zone                                                        # features/step_definitions/posts_steps.rb:13
    When I attach the file "spec/fixtures/button.png" to hidden "qqfile" within "#file-upload-publisher"                      # features/step_definitions/web_steps.rb:91
    And I should see "button.png completed"                                                                                   # features/step_definitions/web_steps.rb:98
    And I click to delete the first uploaded photo                                                                            # features/step_definitions/custom_web_steps.rb:126
    Then I should not see an uploaded image within the photo drop zone                                                        # features/step_definitions/posts_steps.rb:13

  Scenario: back out of uploading a picture when another has been attached                              # features/mobile/posts_from_main_page.feature:53
    Given I visit the mobile publisher page                                                             # features/step_definitions/mobile_steps.rb:5
    And I append "I am eating yogurt" to the publisher                                                  # features/step_definitions/posts_steps.rb:117
    And I attach the file "spec/fixtures/button.gif" to hidden "qqfile" within "#file-upload-publisher" # features/step_definitions/web_steps.rb:91
    And I attach the file "spec/fixtures/button.png" to hidden "qqfile" within "#file-upload-publisher" # features/step_definitions/web_steps.rb:91
    And I click to delete the first uploaded photo                                                      # features/step_definitions/custom_web_steps.rb:126
    Then I should see an uploaded image within the photo drop zone                                      # features/step_definitions/posts_steps.rb:9
    And the text area wrapper mobile should be with attachments                                         # features/step_definitions/custom_web_steps.rb:75

@javascript @mobile
Feature: reactions mobile post
  In order to navigate Diaspora*
  As a mobile user
  I want to react to posts

  Background:                                                                 # features/mobile/reactions.feature:7
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    When "alice@alice.alice" has posted a status message with a photo         # features/step_definitions/user_steps.rb:169
    And I sign in as "bob@bob.bob" on the mobile website                      # features/step_definitions/session_steps.rb:18

  Scenario: like on a mobile post                     # features/mobile/reactions.feature:16
    When I click on selector "a.like-action.inactive" # features/step_definitions/custom_web_steps.rb:131
    Then I should see a "a.like-action.active"        # features/step_definitions/custom_web_steps.rb:177
    And I should see "1" within ".like-count"         # features/step_definitions/web_steps.rb:98
    When I go to the stream page                      # features/step_definitions/web_steps.rb:26
    Then I should see a "a.like-action.active"        # features/step_definitions/custom_web_steps.rb:177
    And I should see "1" within ".like-count"         # features/step_definitions/web_steps.rb:98

  Scenario: liking from the profile view             # features/mobile/reactions.feature:24
    When I am on "alice@alice.alice"'s page          # features/step_definitions/web_steps.rb:22
    And I click on selector "a.like-action.inactive" # features/step_definitions/custom_web_steps.rb:131
    Then I should see a "a.like-action.active"       # features/step_definitions/custom_web_steps.rb:177
    And I should see "1" within ".like-count"        # features/step_definitions/web_steps.rb:98
    When I go to the stream page                     # features/step_definitions/web_steps.rb:26
    Then I should see a "a.like-action.active"       # features/step_definitions/custom_web_steps.rb:177
    And I should see "1" within ".like-count"        # features/step_definitions/web_steps.rb:98

  Scenario: comment and delete a mobile post                          # features/mobile/reactions.feature:33
    When I click on selector "a.comment-action.inactive"              # features/step_definitions/custom_web_steps.rb:131
    And I fill in the following:                                      # features/step_definitions/web_steps.rb:59
      | text | is that a poodle? |
    And I press "Comment"                                             # features/step_definitions/web_steps.rb:30
    Then I should see "is that a poodle?" within ".comment-container" # features/step_definitions/web_steps.rb:98
    When I go to the stream page                                      # features/step_definitions/web_steps.rb:26
    And I should see "1 comment" within ".show-comments"              # features/step_definitions/web_steps.rb:98
    And I should see "1" within ".comment-count"                      # features/step_definitions/web_steps.rb:98
    When I click on selector "a.show-comments"                        # features/step_definitions/custom_web_steps.rb:131
    And I click on selector "a.comment-action"                        # features/step_definitions/custom_web_steps.rb:131
    And I confirm the alert after I click on selector "a.remove"      # features/step_definitions/custom_web_steps.rb:139
    Then I should see "0 comments" within ".show-comments"            # features/step_definitions/web_steps.rb:98

@javascript @mobile
Feature: resharing from the mobile
  In order to make Diaspora more viral
  As a mobile user
  I want to reshare my friend's post

  Background:                                                                 # features/mobile/reshare.feature:7
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username    | email             |
      | Bob Jones   | bob@bob.bob       |
      | Alice Smith | alice@alice.alice |
      | Eve Doe     | eve@eve.eve       |
    And a user with email "bob@bob.bob" is connected with "alice@alice.alice" # features/step_definitions/user_steps.rb:82
    And a user with email "eve@eve.eve" is connected with "bob@bob.bob"       # features/step_definitions/user_steps.rb:82
    Given "bob@bob.bob" has a public post with text "reshare this!"           # features/step_definitions/posts_steps.rb:43
    And I sign in as "alice@alice.alice" on the mobile website                # features/step_definitions/session_steps.rb:18

  Scenario: Resharing a post from a single post page                             # features/mobile/reshare.feature:18
    And I confirm the alert after I click on selector ".reshare-action.inactive" # features/step_definitions/custom_web_steps.rb:139
    Then I should see a ".reshare-action.active"                                 # features/step_definitions/custom_web_steps.rb:177
    When I go to the stream page                                                 # features/step_definitions/web_steps.rb:26
    Then I should see "Reshared via" within ".reshare_via"                       # features/step_definitions/web_steps.rb:98

  Scenario: Resharing a post from a single post page that is reshared                      # features/mobile/reshare.feature:24
    Given the post with text "reshare this!" is reshared by "eve@eve.eve"                  # features/step_definitions/posts_steps.rb:78
    And a user with email "alice@alice.alice" is connected with "eve@eve.eve"              # features/step_definitions/user_steps.rb:82
    And I confirm the alert after I click on the first selector ".reshare-action.inactive" # features/step_definitions/custom_web_steps.rb:139
    Then I should see a ".reshare-action.active"                                           # features/step_definitions/custom_web_steps.rb:177
    When I go to the stream page                                                           # features/step_definitions/web_steps.rb:26
    Then I should see "Reshared via" within ".reshare_via"                                 # features/step_definitions/web_steps.rb:98

  Scenario: Delete original reshared post                                       # features/mobile/reshare.feature:32
    Given "alice@alice.alice" has a public post with text "Don't reshare this!" # features/step_definitions/posts_steps.rb:43
    And the post with text "Don't reshare this!" is reshared by "bob@bob.bob"   # features/step_definitions/posts_steps.rb:78
    When I toggle the mobile view                                               # features/step_definitions/mobile_steps.rb:1
    And I am on "alice@alice.alice"'s page                                      # features/step_definitions/web_steps.rb:22
    And I click to delete the first post                                        # features/step_definitions/custom_web_steps.rb:108
    And I log out                                                               # features/step_definitions/session_steps.rb:55
    And I sign in as "bob@bob.bob" on the mobile website                        # features/step_definitions/session_steps.rb:18
    Then I should see "Original post deleted by author" within ".reshare"       # features/step_definitions/web_steps.rb:98
    And I log out                                                               # features/step_definitions/session_steps.rb:55
    And I sign in as "eve@eve.eve" on the mobile website                        # features/step_definitions/session_steps.rb:18
    And I toggle the mobile view                                                # features/step_definitions/mobile_steps.rb:1
    Then I should see "Original post deleted by author" within ".reshare"       # features/step_definitions/web_steps.rb:98

  Scenario: Not resharing own post                                             # features/mobile/reshare.feature:46
    Given I sign in as "bob@bob.bob" on the mobile website                     # features/step_definitions/session_steps.rb:18
    Then I should see a ".reshare-action.disabled"                             # features/step_definitions/custom_web_steps.rb:177
    And I should not see any alert after I click on selector ".reshare-action" # features/step_definitions/custom_web_steps.rb:151
    And I should not see a ".reshare-action.active"                            # features/step_definitions/custom_web_steps.rb:183
    When I go to the stream page                                               # features/step_definitions/web_steps.rb:26
    Then I should not see a ".reshare_via"                                     # features/step_definitions/custom_web_steps.rb:183

@javascript @mobile
Feature: New user registration
  In order to use Diaspora*
  As a mobile user
  I want to register an account

  Background:                                        # features/mobile/signs_up.feature:7
    Given I am on the login page                     # features/step_definitions/web_steps.rb:22
    And I follow "Create account" within "#main-nav" # features/step_definitions/web_steps.rb:36

  Scenario: user signs up and goes to getting started # features/mobile/signs_up.feature:11
    When I fill in the new user form                  # features/step_definitions/user_steps.rb:218
    And I press "Create account"                      # features/step_definitions/web_steps.rb:30
    Then I should be on the getting started page      # features/step_definitions/web_steps.rb:174
    And I should see the 'getting started' contents   # features/step_definitions/session_steps.rb:72

  Scenario: user fills in bogus data - client side validation                           # features/mobile/signs_up.feature:17
    When I fill in the following:                                                       # features/step_definitions/web_steps.rb:59
      | user_username | $%&(/&%$&/=)(/ |
    And I press "Create account"                                                        # features/step_definitions/web_steps.rb:30
    Then I should not be able to sign up                                                # features/step_definitions/session_steps.rb:68
    And I should have a validation error on "user_username, user_password, user_email"  # features/step_definitions/custom_web_steps.rb:304
    When I fill in the following:                                                       # features/step_definitions/web_steps.rb:59
      | user_username | valid_user                        |
      | user_email    | this is not a valid email $%&/()( |
    And I press "Create account"                                                        # features/step_definitions/web_steps.rb:30
    Then I should not be able to sign up                                                # features/step_definitions/session_steps.rb:68
    And I should have a validation error on "user_password, user_email"                 # features/step_definitions/custom_web_steps.rb:304
    When I fill in the following:                                                       # features/step_definitions/web_steps.rb:59
      | user_email    | valid@email.com |
      | user_password | 1               |
    And I press "Create account"                                                        # features/step_definitions/web_steps.rb:30
    Then I should not be able to sign up                                                # features/step_definitions/session_steps.rb:68
    And I should have a validation error on "user_password, user_password_confirmation" # features/step_definitions/custom_web_steps.rb:304

@javascript @mobile
Feature: Viewing the main stream mobile page

  Background:                                                                  # features/mobile/stream.feature:4
    Given following users exist:                                               # features/step_definitions/user_steps.rb:29
      | username |
      | alice    |
      | bob      |
    And a user with username "bob" is connected with "alice"                   # features/step_definitions/user_steps.rb:88
    And "alice@alice.alice" has a public post with text "Hello! I am #newhere" # features/step_definitions/posts_steps.rb:43

  Scenario: Show post with correct timestamp                        # features/mobile/stream.feature:12
    When I sign in as "bob@bob.bob" on the mobile website           # features/step_definitions/session_steps.rb:18
    And I go to the stream page                                     # features/step_definitions/web_steps.rb:26
    Then I should see "Hello! I am #newhere" within ".ltr"          # features/step_definitions/web_steps.rb:98
    And I should see "less than a minute ago" within "#main_stream" # features/step_definitions/web_steps.rb:98

@javascript @mobile
Feature: Interacting with tags

  Background:                                                                  # features/mobile/tags.feature:4
    Given following users exist:                                               # features/step_definitions/user_steps.rb:29
      | username |
      | bob      |
      | alice    |
    And "alice@alice.alice" has a public post with text "Hello! I am #newhere" # features/step_definitions/posts_steps.rb:43
    When I sign in as "bob@bob.bob" on the mobile website                      # features/step_definitions/session_steps.rb:18
    And I visit the mobile search page                                         # features/step_definitions/mobile_steps.rb:9
    And I fill in the following within "#main":                                # features/step_definitions/web_steps.rb:59
      | q | #newhere |
    And I press "Search"                                                       # features/step_definitions/web_steps.rb:30
    Then I should see "Follow #newhere" within ".tag_following_action"         # features/step_definitions/web_steps.rb:98

  Scenario: Start and stop following a tag                                     # features/mobile/tags.feature:17
    When I click on selector ".tag_following_action"                           # features/step_definitions/custom_web_steps.rb:131
    Then I should see "Stop following #newhere" within ".tag_following_action" # features/step_definitions/web_steps.rb:98
    When I am on the home page                                                 # features/step_definitions/web_steps.rb:22
    Then I should see "Hello! I am #newhere"                                   # features/step_definitions/web_steps.rb:98
    When I visit the mobile search page                                        # features/step_definitions/mobile_steps.rb:9
    And I fill in the following within "#main":                                # features/step_definitions/web_steps.rb:59
      | q | #newhere |
    And I press "Search"                                                       # features/step_definitions/web_steps.rb:30
    Then I should see "Stop following #newhere" within ".tag_following_action" # features/step_definitions/web_steps.rb:98
    When I click on selector ".tag_following_action"                           # features/step_definitions/custom_web_steps.rb:131
    Then I should see "Follow #newhere" within ".tag_following_action"         # features/step_definitions/web_steps.rb:98
    When I am on the home page                                                 # features/step_definitions/web_steps.rb:22
    Then I should not see "Hello! I am #newhere"                               # features/step_definitions/web_steps.rb:113

  Scenario: Manage tags                                                                    # features/mobile/tags.feature:34
    When I click on selector ".tag_following_action"                                       # features/step_definitions/custom_web_steps.rb:131
    Then I should see "Stop following #newhere" within ".tag_following_action"             # features/step_definitions/web_steps.rb:98
    When I am on the manage tag followings page                                            # features/step_definitions/web_steps.rb:22
    Then I should see "#newhere" within "ul.followed_tags"                                 # features/step_definitions/web_steps.rb:98
    When I confirm the alert after I click on selector ".tag_following_action.only-delete" # features/step_definitions/custom_web_steps.rb:139
    Then I should see "You aren't following any tags."                                     # features/step_definitions/web_steps.rb:98
    When I am on the home page                                                             # features/step_definitions/web_steps.rb:22
    Then I should not see "Hello! I am #newhere"                                           # features/step_definitions/web_steps.rb:113

@javascript @mobile
Feature: managing authorized applications

  Background:                                                                 # features/mobile/user_applications.feature:3
    Given following users exist:                                              # features/step_definitions/user_steps.rb:29
      | username | email              |
      | Augier   | augier@example.org |
    And a client with a provided picture exists for user "augier@example.org" # features/step_definitions/oidc_common_steps.rb:1
    And a client exists for user "augier@example.org"                         # features/step_definitions/oidc_common_steps.rb:7

  Scenario: displaying authorizations                                 # features/mobile/user_applications.feature:10
    When I sign in as "augier@example.org" on the mobile website      # features/step_definitions/session_steps.rb:18
    And I go to the user applications page                            # features/step_definitions/web_steps.rb:26
    Then I should see 2 authorized applications                       # features/step_definitions/user_applications_steps.rb:1
    And I should see 1 authorized applications with no provided image # features/step_definitions/user_applications_steps.rb:6
    And I should see 1 authorized applications with an image          # features/step_definitions/user_applications_steps.rb:10

  Scenario: revoke an authorization                              # features/mobile/user_applications.feature:17
    When I sign in as "augier@example.org" on the mobile website # features/step_definitions/session_steps.rb:18
    And I go to the user applications page                       # features/step_definitions/web_steps.rb:26
    And I revoke the first authorization                         # features/step_definitions/user_applications_steps.rb:14
    Then I should see 1 authorized applications                  # features/step_definitions/user_applications_steps.rb:1
    And I revoke the first authorization                         # features/step_definitions/user_applications_steps.rb:14
    Then I should see 0 authorized applications                  # features/step_definitions/user_applications_steps.rb:1

258 scenarios (258 passed)
2730 steps (2730 passed)
13m35.678s
[Coveralls] Submitting to https://coveralls.io/api/v1
[Coveralls] Job #11248.5
[Coveralls] https://coveralls.io/jobs/26099517
Coverage is at 63.9%.
Coverage report sent to Coveralls.
** Execute cucumber
** Execute ci:travis:cucumber

travis_time:end:02b8b496:start=1495674453704989047,finish=1495675308261673313,duration=854556684266
The command "./script/ci/build.sh" exited with 0.
travis_fold:start:cache.2store build cache
$ bundle clean
travis_time:start:00bcc8e0
travis_time:end:00bcc8e0:start=1495675309013266059,finish=1495675309017692997,duration=4426938travis_time:start:0be50744nothing changed, not updating cache

travis_time:end:0be50744:start=1495675309022716796,finish=1495675334129214057,duration=25106497261travis_fold:end:cache.2
Done. Your build exited with 0.
